"use strict";(self.webpackChunkmind_mash=self.webpackChunkmind_mash||[]).push([[3626],{33281:(s,e,a)=>{a.r(e),a.d(e,{assets:()=>c,contentTitle:()=>t,default:()=>d,frontMatter:()=>l,metadata:()=>r,toc:()=>h});var n=a(74848),i=a(28453);const l={id:"google-2-unit-3",title:"\ud83d\udcd6 Classification"},t=void 0,r={id:"notes/Information Technology/Artificial Intelligence/\ud83d\udc68\ud83c\udffb\u200d\ud83c\udfeb Google - 02 - ML/google-2-unit-3",title:"\ud83d\udcd6 Classification",description:"\u27a1\ufe0f Useful Materials",source:"@site/docs/notes/Information Technology/Artificial Intelligence/\ud83d\udc68\ud83c\udffb\u200d\ud83c\udfeb Google - 02 - ML/04_unit_classification.md",sourceDirName:"notes/Information Technology/Artificial Intelligence/\ud83d\udc68\ud83c\udffb\u200d\ud83c\udfeb Google - 02 - ML",slug:"/notes/Information Technology/Artificial Intelligence/\ud83d\udc68\ud83c\udffb\u200d\ud83c\udfeb Google - 02 - ML/google-2-unit-3",permalink:"/MindMash/docs/notes/Information Technology/Artificial Intelligence/\ud83d\udc68\ud83c\udffb\u200d\ud83c\udfeb Google - 02 - ML/google-2-unit-3",draft:!1,unlisted:!1,tags:[],version:"current",sidebarPosition:4,frontMatter:{id:"google-2-unit-3",title:"\ud83d\udcd6 Classification"},sidebar:"notesSidebar",previous:{title:"\ud83d\udcd6 Logistic Regression",permalink:"/MindMash/docs/notes/Information Technology/Artificial Intelligence/\ud83d\udc68\ud83c\udffb\u200d\ud83c\udfeb Google - 02 - ML/google-2-unit-2"},next:{title:"\ud83d\udcd6 Numerical Data",permalink:"/MindMash/docs/notes/Information Technology/Artificial Intelligence/\ud83d\udc68\ud83c\udffb\u200d\ud83c\udfeb Google - 02 - ML/google-2-unit-4"}},c={},h=[{value:"\u27a1\ufe0f <strong>Useful Materials</strong>",id:"\ufe0f-useful-materials",level:2},{value:"Original Source",id:"original-source",level:3},{value:"1\ufe0f\u20e3 <strong>Introduction</strong>",id:"1\ufe0f\u20e3-introduction",level:2},{value:"2\ufe0f\u20e3 <strong>Thresholds and the Confusion Matrix</strong>",id:"2\ufe0f\u20e3-thresholds-and-the-confusion-matrix",level:2},{value:"Confusion Matrix",id:"confusion-matrix",level:3},{value:"\u27bd Imbalanced Datasets",id:"-imbalanced-datasets",level:4},{value:"\u27bd Why This Matters",id:"-why-this-matters",level:4},{value:"3\ufe0f\u20e3 <strong>Accuracy, recall, precision, and related metrics</strong>",id:"3\ufe0f\u20e3-accuracy-recall-precision-and-related-metrics",level:2},{value:"Accuracy",id:"accuracy",level:3},{value:"\u27bd Limitations",id:"-limitations",level:4},{value:"\u27bd When to use?",id:"-when-to-use",level:4},{value:"Recall (True Positive Rate)",id:"recall-true-positive-rate",level:3},{value:"\u27bd Limitations",id:"-limitations-1",level:4},{value:"\u27bd When to use?",id:"-when-to-use-1",level:4},{value:"False Positive Rate",id:"false-positive-rate",level:3},{value:"\u27bd Limitations",id:"-limitations-2",level:4},{value:"\u27bd When to use?",id:"-when-to-use-2",level:4},{value:"Precision",id:"precision",level:3},{value:"\u27bd Limitations",id:"-limitations-3",level:4},{value:"\u27bd When to use?",id:"-when-to-use-3",level:4},{value:"Trade-offs and Threshold Tuning",id:"trade-offs-and-threshold-tuning",level:3},{value:"\u27bd Precision-Recall Trade-off",id:"-precision-recall-trade-off",level:4},{value:"F1-Score: Balancing Precision and Recall",id:"f1-score-balancing-precision-and-recall",level:3},{value:"\u27bd Limitations",id:"-limitations-4",level:4},{value:"\u27bd When to use?",id:"-when-to-use-4",level:4},{value:"4\ufe0f\u20e3 <strong>ROC and AUC</strong>",id:"4\ufe0f\u20e3-roc-and-auc",level:2},{value:"Receiver-operating characteristic curve (ROC)",id:"receiver-operating-characteristic-curve-roc",level:3},{value:"Area under the curve (AUC)",id:"area-under-the-curve-auc",level:3},{value:"\u27bd When to use?",id:"-when-to-use-5",level:4},{value:"\u27bd Limitations",id:"-limitations-5",level:4},{value:"AUC and ROC for choosing model and threshold",id:"auc-and-roc-for-choosing-model-and-threshold",level:3},{value:"\u27bd Example",id:"-example",level:4},{value:"5\ufe0f\u20e3 <strong>Prediction bias</strong>",id:"5\ufe0f\u20e3-prediction-bias",level:2},{value:"Introduction",id:"introduction",level:3},{value:"Significance of Prediction Bias",id:"significance-of-prediction-bias",level:3},{value:"Common Causes of Prediction Bias",id:"common-causes-of-prediction-bias",level:3},{value:"\u27bd Data Issues",id:"-data-issues",level:4},{value:"\u27bd Model Issues",id:"-model-issues",level:4},{value:"\u27bd Feature Issues",id:"-feature-issues",level:4},{value:"\u27bd Pipeline Issues",id:"-pipeline-issues",level:4},{value:"6\ufe0f\u20e3 <strong>Multi-class classification</strong>",id:"6\ufe0f\u20e3-multi-class-classification",level:2},{value:"\ud83d\udcbb <strong>Coding Time!</strong>",id:"-coding-time",level:2},{value:"Logistic Regression in Keras",id:"logistic-regression-in-keras",level:3}];function m(s){const e={a:"a",admonition:"admonition",annotation:"annotation",br:"br",code:"code",em:"em",h2:"h2",h3:"h3",h4:"h4",img:"img",li:"li",math:"math",mfrac:"mfrac",mi:"mi",mn:"mn",mo:"mo",mrow:"mrow",mtext:"mtext",ol:"ol",p:"p",pre:"pre",semantics:"semantics",span:"span",strong:"strong",ul:"ul",...(0,i.R)(),...s.components};return(0,n.jsxs)(n.Fragment,{children:[(0,n.jsxs)(e.h2,{id:"\ufe0f-useful-materials",children:["\u27a1\ufe0f ",(0,n.jsx)(e.strong,{children:"Useful Materials"})]}),"\n",(0,n.jsx)(e.h3,{id:"original-source",children:"Original Source"}),"\n",(0,n.jsxs)(e.p,{children:["You can find here the original course: ",(0,n.jsx)(e.a,{href:"https://developers.google.com/machine-learning/crash-course/classification",children:(0,n.jsx)(e.strong,{children:"Classification"})})]}),"\n",(0,n.jsxs)(e.h2,{id:"1\ufe0f\u20e3-introduction",children:["1\ufe0f\u20e3 ",(0,n.jsx)(e.strong,{children:"Introduction"})]}),"\n",(0,n.jsx)(e.admonition,{title:"Definition",type:"info",children:(0,n.jsx)(e.p,{children:"Classification is the task of predicting which of a set of classes (categories) an example belongs to."})}),"\n",(0,n.jsxs)(e.h2,{id:"2\ufe0f\u20e3-thresholds-and-the-confusion-matrix",children:["2\ufe0f\u20e3 ",(0,n.jsx)(e.strong,{children:"Thresholds and the Confusion Matrix"})]}),"\n",(0,n.jsxs)(e.p,{children:["In logistic regression models (e.g., spam detection), predictions are probabilities between ",(0,n.jsxs)(e.span,{className:"katex",children:[(0,n.jsx)(e.span,{className:"katex-mathml",children:(0,n.jsx)(e.math,{xmlns:"http://www.w3.org/1998/Math/MathML",children:(0,n.jsxs)(e.semantics,{children:[(0,n.jsx)(e.mrow,{children:(0,n.jsx)(e.mn,{children:"0"})}),(0,n.jsx)(e.annotation,{encoding:"application/x-tex",children:"0"})]})})}),(0,n.jsx)(e.span,{className:"katex-html","aria-hidden":"true",children:(0,n.jsxs)(e.span,{className:"base",children:[(0,n.jsx)(e.span,{className:"strut",style:{height:"0.6444em"}}),(0,n.jsx)(e.span,{className:"mord",children:"0"})]})})]})," and ",(0,n.jsxs)(e.span,{className:"katex",children:[(0,n.jsx)(e.span,{className:"katex-mathml",children:(0,n.jsx)(e.math,{xmlns:"http://www.w3.org/1998/Math/MathML",children:(0,n.jsxs)(e.semantics,{children:[(0,n.jsx)(e.mrow,{children:(0,n.jsx)(e.mn,{children:"1"})}),(0,n.jsx)(e.annotation,{encoding:"application/x-tex",children:"1"})]})})}),(0,n.jsx)(e.span,{className:"katex-html","aria-hidden":"true",children:(0,n.jsxs)(e.span,{className:"base",children:[(0,n.jsx)(e.span,{className:"strut",style:{height:"0.6444em"}}),(0,n.jsx)(e.span,{className:"mord",children:"1"})]})})]}),'. To convert these probabilities into discrete classes (e.g., "spam" or "not spam"), a ',(0,n.jsx)(e.strong,{children:"classification threshold"})," is applied:"]}),"\n",(0,n.jsxs)(e.ul,{children:["\n",(0,n.jsxs)(e.li,{children:["\n",(0,n.jsxs)(e.p,{children:[(0,n.jsx)(e.strong,{children:"Above the threshold"}),(0,n.jsx)(e.br,{}),"\n","Assigned to the ",(0,n.jsx)(e.em,{children:"positive class"})," (e.g., spam)"]}),"\n"]}),"\n",(0,n.jsxs)(e.li,{children:["\n",(0,n.jsxs)(e.p,{children:[(0,n.jsx)(e.strong,{children:"Below or equal to the threshold"}),(0,n.jsx)(e.br,{}),"\n","Assigned to the ",(0,n.jsx)(e.em,{children:"negative class"})," (e.g., not spam)"]}),"\n"]}),"\n"]}),"\n",(0,n.jsx)(e.admonition,{title:"Examples",type:"tip",children:(0,n.jsxs)(e.ul,{children:["\n",(0,n.jsxs)(e.li,{children:["Prediction = ",(0,n.jsxs)(e.span,{className:"katex",children:[(0,n.jsx)(e.span,{className:"katex-mathml",children:(0,n.jsx)(e.math,{xmlns:"http://www.w3.org/1998/Math/MathML",children:(0,n.jsxs)(e.semantics,{children:[(0,n.jsx)(e.mrow,{children:(0,n.jsx)(e.mn,{children:"0.99"})}),(0,n.jsx)(e.annotation,{encoding:"application/x-tex",children:"0.99"})]})})}),(0,n.jsx)(e.span,{className:"katex-html","aria-hidden":"true",children:(0,n.jsxs)(e.span,{className:"base",children:[(0,n.jsx)(e.span,{className:"strut",style:{height:"0.6444em"}}),(0,n.jsx)(e.span,{className:"mord",children:"0.99"})]})})]})," \u2192 Classified as ",(0,n.jsx)(e.em,{children:"spam"})," (threshold = ",(0,n.jsxs)(e.span,{className:"katex",children:[(0,n.jsx)(e.span,{className:"katex-mathml",children:(0,n.jsx)(e.math,{xmlns:"http://www.w3.org/1998/Math/MathML",children:(0,n.jsxs)(e.semantics,{children:[(0,n.jsx)(e.mrow,{children:(0,n.jsx)(e.mn,{children:"0.5"})}),(0,n.jsx)(e.annotation,{encoding:"application/x-tex",children:"0.5"})]})})}),(0,n.jsx)(e.span,{className:"katex-html","aria-hidden":"true",children:(0,n.jsxs)(e.span,{className:"base",children:[(0,n.jsx)(e.span,{className:"strut",style:{height:"0.6444em"}}),(0,n.jsx)(e.span,{className:"mord",children:"0.5"})]})})]}),")"]}),"\n",(0,n.jsxs)(e.li,{children:["Prediction = ",(0,n.jsxs)(e.span,{className:"katex",children:[(0,n.jsx)(e.span,{className:"katex-mathml",children:(0,n.jsx)(e.math,{xmlns:"http://www.w3.org/1998/Math/MathML",children:(0,n.jsxs)(e.semantics,{children:[(0,n.jsx)(e.mrow,{children:(0,n.jsx)(e.mn,{children:"0.51"})}),(0,n.jsx)(e.annotation,{encoding:"application/x-tex",children:"0.51"})]})})}),(0,n.jsx)(e.span,{className:"katex-html","aria-hidden":"true",children:(0,n.jsxs)(e.span,{className:"base",children:[(0,n.jsx)(e.span,{className:"strut",style:{height:"0.6444em"}}),(0,n.jsx)(e.span,{className:"mord",children:"0.51"})]})})]})," \u2192 Classified as ",(0,n.jsx)(e.em,{children:"spam"})," (threshold = ",(0,n.jsxs)(e.span,{className:"katex",children:[(0,n.jsx)(e.span,{className:"katex-mathml",children:(0,n.jsx)(e.math,{xmlns:"http://www.w3.org/1998/Math/MathML",children:(0,n.jsxs)(e.semantics,{children:[(0,n.jsx)(e.mrow,{children:(0,n.jsx)(e.mn,{children:"0.5"})}),(0,n.jsx)(e.annotation,{encoding:"application/x-tex",children:"0.5"})]})})}),(0,n.jsx)(e.span,{className:"katex-html","aria-hidden":"true",children:(0,n.jsxs)(e.span,{className:"base",children:[(0,n.jsx)(e.span,{className:"strut",style:{height:"0.6444em"}}),(0,n.jsx)(e.span,{className:"mord",children:"0.5"})]})})]}),")"]}),"\n",(0,n.jsxs)(e.li,{children:["Prediction = ",(0,n.jsxs)(e.span,{className:"katex",children:[(0,n.jsx)(e.span,{className:"katex-mathml",children:(0,n.jsx)(e.math,{xmlns:"http://www.w3.org/1998/Math/MathML",children:(0,n.jsxs)(e.semantics,{children:[(0,n.jsx)(e.mrow,{children:(0,n.jsx)(e.mn,{children:"0.51"})}),(0,n.jsx)(e.annotation,{encoding:"application/x-tex",children:"0.51"})]})})}),(0,n.jsx)(e.span,{className:"katex-html","aria-hidden":"true",children:(0,n.jsxs)(e.span,{className:"base",children:[(0,n.jsx)(e.span,{className:"strut",style:{height:"0.6444em"}}),(0,n.jsx)(e.span,{className:"mord",children:"0.51"})]})})]})," \u2192 Classified as ",(0,n.jsx)(e.em,{children:"not spam"})," (threshold = ",(0,n.jsxs)(e.span,{className:"katex",children:[(0,n.jsx)(e.span,{className:"katex-mathml",children:(0,n.jsx)(e.math,{xmlns:"http://www.w3.org/1998/Math/MathML",children:(0,n.jsxs)(e.semantics,{children:[(0,n.jsx)(e.mrow,{children:(0,n.jsx)(e.mn,{children:"0.95"})}),(0,n.jsx)(e.annotation,{encoding:"application/x-tex",children:"0.95"})]})})}),(0,n.jsx)(e.span,{className:"katex-html","aria-hidden":"true",children:(0,n.jsxs)(e.span,{className:"base",children:[(0,n.jsx)(e.span,{className:"strut",style:{height:"0.6444em"}}),(0,n.jsx)(e.span,{className:"mord",children:"0.95"})]})})]}),")"]}),"\n"]})}),"\n",(0,n.jsx)(e.h3,{id:"confusion-matrix",children:"Confusion Matrix"}),"\n",(0,n.jsxs)(e.p,{children:["A confusion matrix evaluates a classifier\u2019s performance by comparing its predictions to the ",(0,n.jsx)(e.strong,{children:"ground truth"}),". For a binary problem like spam detection, the matrix organizes outcomes into four categories:"]}),"\n",(0,n.jsxs)(e.ol,{children:["\n",(0,n.jsxs)(e.li,{children:[(0,n.jsx)(e.strong,{children:"True Positives (TP)"}),": Emails correctly classified as spam."]}),"\n",(0,n.jsxs)(e.li,{children:[(0,n.jsx)(e.strong,{children:"False Positives (FP)"}),": Legitimate emails incorrectly marked as spam."]}),"\n",(0,n.jsxs)(e.li,{children:[(0,n.jsx)(e.strong,{children:"True Negatives (TN)"}),": Legitimate emails correctly left in the inbox."]}),"\n",(0,n.jsxs)(e.li,{children:[(0,n.jsx)(e.strong,{children:"False Negatives (FN)"}),": Spam emails mistakenly allowed into the inbox."]}),"\n"]}),"\n",(0,n.jsx)(e.p,{children:(0,n.jsx)(e.img,{alt:"My Image",src:a(95755).A+"",width:"1743",height:"324"})}),"\n",(0,n.jsx)(e.p,{children:"The matrix\u2019s rows represent predictions (spam vs. not spam), and its columns reflect reality. For example:"}),"\n",(0,n.jsxs)(e.ul,{children:["\n",(0,n.jsxs)(e.li,{children:[(0,n.jsx)(e.strong,{children:"Row totals"})," show how many emails the model labeled as spam (",(0,n.jsxs)(e.span,{className:"katex",children:[(0,n.jsx)(e.span,{className:"katex-mathml",children:(0,n.jsx)(e.math,{xmlns:"http://www.w3.org/1998/Math/MathML",children:(0,n.jsxs)(e.semantics,{children:[(0,n.jsxs)(e.mrow,{children:[(0,n.jsx)(e.mi,{children:"T"}),(0,n.jsx)(e.mi,{children:"P"}),(0,n.jsx)(e.mo,{children:"+"}),(0,n.jsx)(e.mi,{children:"F"}),(0,n.jsx)(e.mi,{children:"P"})]}),(0,n.jsx)(e.annotation,{encoding:"application/x-tex",children:"TP + FP"})]})})}),(0,n.jsxs)(e.span,{className:"katex-html","aria-hidden":"true",children:[(0,n.jsxs)(e.span,{className:"base",children:[(0,n.jsx)(e.span,{className:"strut",style:{height:"0.7667em",verticalAlign:"-0.0833em"}}),(0,n.jsx)(e.span,{className:"mord mathnormal",style:{marginRight:"0.13889em"},children:"TP"}),(0,n.jsx)(e.span,{className:"mspace",style:{marginRight:"0.2222em"}}),(0,n.jsx)(e.span,{className:"mbin",children:"+"}),(0,n.jsx)(e.span,{className:"mspace",style:{marginRight:"0.2222em"}})]}),(0,n.jsxs)(e.span,{className:"base",children:[(0,n.jsx)(e.span,{className:"strut",style:{height:"0.6833em"}}),(0,n.jsx)(e.span,{className:"mord mathnormal",style:{marginRight:"0.13889em"},children:"FP"})]})]})]}),") or not spam (",(0,n.jsxs)(e.span,{className:"katex",children:[(0,n.jsx)(e.span,{className:"katex-mathml",children:(0,n.jsx)(e.math,{xmlns:"http://www.w3.org/1998/Math/MathML",children:(0,n.jsxs)(e.semantics,{children:[(0,n.jsxs)(e.mrow,{children:[(0,n.jsx)(e.mi,{children:"F"}),(0,n.jsx)(e.mi,{children:"N"}),(0,n.jsx)(e.mo,{children:"+"}),(0,n.jsx)(e.mi,{children:"T"}),(0,n.jsx)(e.mi,{children:"N"})]}),(0,n.jsx)(e.annotation,{encoding:"application/x-tex",children:"FN + TN"})]})})}),(0,n.jsxs)(e.span,{className:"katex-html","aria-hidden":"true",children:[(0,n.jsxs)(e.span,{className:"base",children:[(0,n.jsx)(e.span,{className:"strut",style:{height:"0.7667em",verticalAlign:"-0.0833em"}}),(0,n.jsx)(e.span,{className:"mord mathnormal",style:{marginRight:"0.10903em"},children:"FN"}),(0,n.jsx)(e.span,{className:"mspace",style:{marginRight:"0.2222em"}}),(0,n.jsx)(e.span,{className:"mbin",children:"+"}),(0,n.jsx)(e.span,{className:"mspace",style:{marginRight:"0.2222em"}})]}),(0,n.jsxs)(e.span,{className:"base",children:[(0,n.jsx)(e.span,{className:"strut",style:{height:"0.6833em"}}),(0,n.jsx)(e.span,{className:"mord mathnormal",style:{marginRight:"0.10903em"},children:"TN"})]})]})]}),")."]}),"\n",(0,n.jsxs)(e.li,{children:[(0,n.jsx)(e.strong,{children:"Column totals"})," reveal the actual number of spam (",(0,n.jsxs)(e.span,{className:"katex",children:[(0,n.jsx)(e.span,{className:"katex-mathml",children:(0,n.jsx)(e.math,{xmlns:"http://www.w3.org/1998/Math/MathML",children:(0,n.jsxs)(e.semantics,{children:[(0,n.jsxs)(e.mrow,{children:[(0,n.jsx)(e.mi,{children:"T"}),(0,n.jsx)(e.mi,{children:"P"}),(0,n.jsx)(e.mo,{children:"+"}),(0,n.jsx)(e.mi,{children:"F"}),(0,n.jsx)(e.mi,{children:"N"})]}),(0,n.jsx)(e.annotation,{encoding:"application/x-tex",children:"TP + FN"})]})})}),(0,n.jsxs)(e.span,{className:"katex-html","aria-hidden":"true",children:[(0,n.jsxs)(e.span,{className:"base",children:[(0,n.jsx)(e.span,{className:"strut",style:{height:"0.7667em",verticalAlign:"-0.0833em"}}),(0,n.jsx)(e.span,{className:"mord mathnormal",style:{marginRight:"0.13889em"},children:"TP"}),(0,n.jsx)(e.span,{className:"mspace",style:{marginRight:"0.2222em"}}),(0,n.jsx)(e.span,{className:"mbin",children:"+"}),(0,n.jsx)(e.span,{className:"mspace",style:{marginRight:"0.2222em"}})]}),(0,n.jsxs)(e.span,{className:"base",children:[(0,n.jsx)(e.span,{className:"strut",style:{height:"0.6833em"}}),(0,n.jsx)(e.span,{className:"mord mathnormal",style:{marginRight:"0.10903em"},children:"FN"})]})]})]}),") and non-spam (",(0,n.jsxs)(e.span,{className:"katex",children:[(0,n.jsx)(e.span,{className:"katex-mathml",children:(0,n.jsx)(e.math,{xmlns:"http://www.w3.org/1998/Math/MathML",children:(0,n.jsxs)(e.semantics,{children:[(0,n.jsxs)(e.mrow,{children:[(0,n.jsx)(e.mi,{children:"F"}),(0,n.jsx)(e.mi,{children:"P"}),(0,n.jsx)(e.mo,{children:"+"}),(0,n.jsx)(e.mi,{children:"T"}),(0,n.jsx)(e.mi,{children:"N"})]}),(0,n.jsx)(e.annotation,{encoding:"application/x-tex",children:"FP + TN"})]})})}),(0,n.jsxs)(e.span,{className:"katex-html","aria-hidden":"true",children:[(0,n.jsxs)(e.span,{className:"base",children:[(0,n.jsx)(e.span,{className:"strut",style:{height:"0.7667em",verticalAlign:"-0.0833em"}}),(0,n.jsx)(e.span,{className:"mord mathnormal",style:{marginRight:"0.13889em"},children:"FP"}),(0,n.jsx)(e.span,{className:"mspace",style:{marginRight:"0.2222em"}}),(0,n.jsx)(e.span,{className:"mbin",children:"+"}),(0,n.jsx)(e.span,{className:"mspace",style:{marginRight:"0.2222em"}})]}),(0,n.jsxs)(e.span,{className:"base",children:[(0,n.jsx)(e.span,{className:"strut",style:{height:"0.6833em"}}),(0,n.jsx)(e.span,{className:"mord mathnormal",style:{marginRight:"0.10903em"},children:"TN"})]})]})]}),") emails."]}),"\n"]}),"\n",(0,n.jsx)(e.h4,{id:"-imbalanced-datasets",children:"\u27bd Imbalanced Datasets"}),"\n",(0,n.jsxs)(e.p,{children:["When the actual positives (e.g., spam) are vastly outnumbered by negatives (e.g., legitimate emails), the dataset is ",(0,n.jsx)(e.strong,{children:"imbalanced"}),". Consider a dataset of cloud photos where the rare \u201cvolutus\u201d cloud type appears only a few times. Here, even a high-accuracy model could fail to detect volutus clouds because it optimizes for the majority class. The confusion matrix highlights this imbalance: a model that always predicts \u201cnot volutus\u201d would have high accuracy but zero true positives."]}),"\n",(0,n.jsx)(e.h4,{id:"-why-this-matters",children:"\u27bd Why This Matters"}),"\n",(0,n.jsx)(e.p,{children:"The confusion matrix quantifies trade-offs inherent in threshold selection:"}),"\n",(0,n.jsxs)(e.ul,{children:["\n",(0,n.jsxs)(e.li,{children:["A ",(0,n.jsx)(e.strong,{children:"high threshold"})," (e.g., ",(0,n.jsxs)(e.span,{className:"katex",children:[(0,n.jsx)(e.span,{className:"katex-mathml",children:(0,n.jsx)(e.math,{xmlns:"http://www.w3.org/1998/Math/MathML",children:(0,n.jsxs)(e.semantics,{children:[(0,n.jsx)(e.mrow,{children:(0,n.jsx)(e.mn,{children:"0.95"})}),(0,n.jsx)(e.annotation,{encoding:"application/x-tex",children:"0.95"})]})})}),(0,n.jsx)(e.span,{className:"katex-html","aria-hidden":"true",children:(0,n.jsxs)(e.span,{className:"base",children:[(0,n.jsx)(e.span,{className:"strut",style:{height:"0.6444em"}}),(0,n.jsx)(e.span,{className:"mord",children:"0.95"})]})})]}),") reduces false positives but risks missing true positives."]}),"\n",(0,n.jsxs)(e.li,{children:["A ",(0,n.jsx)(e.strong,{children:"low threshold"})," (e.g., ",(0,n.jsxs)(e.span,{className:"katex",children:[(0,n.jsx)(e.span,{className:"katex-mathml",children:(0,n.jsx)(e.math,{xmlns:"http://www.w3.org/1998/Math/MathML",children:(0,n.jsxs)(e.semantics,{children:[(0,n.jsx)(e.mrow,{children:(0,n.jsx)(e.mn,{children:"0.1"})}),(0,n.jsx)(e.annotation,{encoding:"application/x-tex",children:"0.1"})]})})}),(0,n.jsx)(e.span,{className:"katex-html","aria-hidden":"true",children:(0,n.jsxs)(e.span,{className:"base",children:[(0,n.jsx)(e.span,{className:"strut",style:{height:"0.6444em"}}),(0,n.jsx)(e.span,{className:"mord",children:"0.1"})]})})]}),") catches more true positives but increases false alarms."]}),"\n"]}),"\n",(0,n.jsx)(e.p,{children:"By analyzing the matrix, practitioners can align thresholds with real-world priorities, whether minimizing false alarms in legal document review or ensuring rare diseases are not missed in medical testing."}),"\n",(0,n.jsx)("iframe",{src:"https://www.youtube.com/embed/QM0sYbEQSkM",title:"Machine Learning Crash Course: Classification",frameBorder:"0",allow:"accelerometer; autoplay; clipboard-write; encrypted-media; gyroscope; picture-in-picture",allowFullScreen:!0,className:"video-holidays"}),"\n",(0,n.jsxs)(e.h2,{id:"3\ufe0f\u20e3-accuracy-recall-precision-and-related-metrics",children:["3\ufe0f\u20e3 ",(0,n.jsx)(e.strong,{children:"Accuracy, recall, precision, and related metrics"})]}),"\n",(0,n.jsxs)(e.p,{children:["True and false positives and negatives are used to calculate several useful ",(0,n.jsx)(e.strong,{children:"metrics"})," for evaluating models. Which evaluation metrics are most meaningful depends on the specific model and the specific task, the cost of different misclassifications, and whether the dataset is balanced or imbalanced."]}),"\n",(0,n.jsx)(e.p,{children:"All of the metrics in this section are calculated at a single fixed threshold, and change when the threshold changes. Very often, the user tunes the threshold to optimize one of these metrics."}),"\n",(0,n.jsx)(e.h3,{id:"accuracy",children:"Accuracy"}),"\n",(0,n.jsx)(e.admonition,{title:"Definition",type:"info",children:(0,n.jsx)(e.p,{children:"Accuracy is the proportion of all classifications that were correct, whether positive or negative."})}),"\n",(0,n.jsx)(e.p,{children:"It is mathematically defined as:"}),"\n",(0,n.jsx)(e.span,{className:"katex-display",children:(0,n.jsxs)(e.span,{className:"katex",children:[(0,n.jsx)(e.span,{className:"katex-mathml",children:(0,n.jsx)(e.math,{xmlns:"http://www.w3.org/1998/Math/MathML",display:"block",children:(0,n.jsxs)(e.semantics,{children:[(0,n.jsxs)(e.mrow,{children:[(0,n.jsx)(e.mtext,{children:"Accuracy"}),(0,n.jsx)(e.mo,{children:"="}),(0,n.jsxs)(e.mfrac,{children:[(0,n.jsx)(e.mtext,{children:"correct\xa0classifications"}),(0,n.jsx)(e.mtext,{children:"total\xa0classifications"})]}),(0,n.jsx)(e.mo,{children:"="}),(0,n.jsxs)(e.mfrac,{children:[(0,n.jsxs)(e.mrow,{children:[(0,n.jsx)(e.mi,{children:"T"}),(0,n.jsx)(e.mi,{children:"P"}),(0,n.jsx)(e.mo,{children:"+"}),(0,n.jsx)(e.mi,{children:"T"}),(0,n.jsx)(e.mi,{children:"N"})]}),(0,n.jsxs)(e.mrow,{children:[(0,n.jsx)(e.mi,{children:"T"}),(0,n.jsx)(e.mi,{children:"P"}),(0,n.jsx)(e.mo,{children:"+"}),(0,n.jsx)(e.mi,{children:"T"}),(0,n.jsx)(e.mi,{children:"N"}),(0,n.jsx)(e.mo,{children:"+"}),(0,n.jsx)(e.mi,{children:"F"}),(0,n.jsx)(e.mi,{children:"P"}),(0,n.jsx)(e.mo,{children:"+"}),(0,n.jsx)(e.mi,{children:"F"}),(0,n.jsx)(e.mi,{children:"N"})]})]})]}),(0,n.jsx)(e.annotation,{encoding:"application/x-tex",children:"\\text{Accuracy} =\n\\frac{\\text{correct classifications}}{\\text{total classifications}}\n= \\frac{TP+TN}{TP+TN+FP+FN}"})]})})}),(0,n.jsxs)(e.span,{className:"katex-html","aria-hidden":"true",children:[(0,n.jsxs)(e.span,{className:"base",children:[(0,n.jsx)(e.span,{className:"strut",style:{height:"0.8778em",verticalAlign:"-0.1944em"}}),(0,n.jsx)(e.span,{className:"mord text",children:(0,n.jsx)(e.span,{className:"mord",children:"Accuracy"})}),(0,n.jsx)(e.span,{className:"mspace",style:{marginRight:"0.2778em"}}),(0,n.jsx)(e.span,{className:"mrel",children:"="}),(0,n.jsx)(e.span,{className:"mspace",style:{marginRight:"0.2778em"}})]}),(0,n.jsxs)(e.span,{className:"base",children:[(0,n.jsx)(e.span,{className:"strut",style:{height:"2.0574em",verticalAlign:"-0.686em"}}),(0,n.jsxs)(e.span,{className:"mord",children:[(0,n.jsx)(e.span,{className:"mopen nulldelimiter"}),(0,n.jsx)(e.span,{className:"mfrac",children:(0,n.jsxs)(e.span,{className:"vlist-t vlist-t2",children:[(0,n.jsxs)(e.span,{className:"vlist-r",children:[(0,n.jsxs)(e.span,{className:"vlist",style:{height:"1.3714em"},children:[(0,n.jsxs)(e.span,{style:{top:"-2.314em"},children:[(0,n.jsx)(e.span,{className:"pstrut",style:{height:"3em"}}),(0,n.jsx)(e.span,{className:"mord",children:(0,n.jsx)(e.span,{className:"mord text",children:(0,n.jsx)(e.span,{className:"mord",children:"total\xa0classifications"})})})]}),(0,n.jsxs)(e.span,{style:{top:"-3.23em"},children:[(0,n.jsx)(e.span,{className:"pstrut",style:{height:"3em"}}),(0,n.jsx)(e.span,{className:"frac-line",style:{borderBottomWidth:"0.04em"}})]}),(0,n.jsxs)(e.span,{style:{top:"-3.677em"},children:[(0,n.jsx)(e.span,{className:"pstrut",style:{height:"3em"}}),(0,n.jsx)(e.span,{className:"mord",children:(0,n.jsx)(e.span,{className:"mord text",children:(0,n.jsx)(e.span,{className:"mord",children:"correct\xa0classifications"})})})]})]}),(0,n.jsx)(e.span,{className:"vlist-s",children:"\u200b"})]}),(0,n.jsx)(e.span,{className:"vlist-r",children:(0,n.jsx)(e.span,{className:"vlist",style:{height:"0.686em"},children:(0,n.jsx)(e.span,{})})})]})}),(0,n.jsx)(e.span,{className:"mclose nulldelimiter"})]}),(0,n.jsx)(e.span,{className:"mspace",style:{marginRight:"0.2778em"}}),(0,n.jsx)(e.span,{className:"mrel",children:"="}),(0,n.jsx)(e.span,{className:"mspace",style:{marginRight:"0.2778em"}})]}),(0,n.jsxs)(e.span,{className:"base",children:[(0,n.jsx)(e.span,{className:"strut",style:{height:"2.1297em",verticalAlign:"-0.7693em"}}),(0,n.jsxs)(e.span,{className:"mord",children:[(0,n.jsx)(e.span,{className:"mopen nulldelimiter"}),(0,n.jsx)(e.span,{className:"mfrac",children:(0,n.jsxs)(e.span,{className:"vlist-t vlist-t2",children:[(0,n.jsxs)(e.span,{className:"vlist-r",children:[(0,n.jsxs)(e.span,{className:"vlist",style:{height:"1.3603em"},children:[(0,n.jsxs)(e.span,{style:{top:"-2.314em"},children:[(0,n.jsx)(e.span,{className:"pstrut",style:{height:"3em"}}),(0,n.jsxs)(e.span,{className:"mord",children:[(0,n.jsx)(e.span,{className:"mord mathnormal",style:{marginRight:"0.13889em"},children:"TP"}),(0,n.jsx)(e.span,{className:"mspace",style:{marginRight:"0.2222em"}}),(0,n.jsx)(e.span,{className:"mbin",children:"+"}),(0,n.jsx)(e.span,{className:"mspace",style:{marginRight:"0.2222em"}}),(0,n.jsx)(e.span,{className:"mord mathnormal",style:{marginRight:"0.10903em"},children:"TN"}),(0,n.jsx)(e.span,{className:"mspace",style:{marginRight:"0.2222em"}}),(0,n.jsx)(e.span,{className:"mbin",children:"+"}),(0,n.jsx)(e.span,{className:"mspace",style:{marginRight:"0.2222em"}}),(0,n.jsx)(e.span,{className:"mord mathnormal",style:{marginRight:"0.13889em"},children:"FP"}),(0,n.jsx)(e.span,{className:"mspace",style:{marginRight:"0.2222em"}}),(0,n.jsx)(e.span,{className:"mbin",children:"+"}),(0,n.jsx)(e.span,{className:"mspace",style:{marginRight:"0.2222em"}}),(0,n.jsx)(e.span,{className:"mord mathnormal",style:{marginRight:"0.10903em"},children:"FN"})]})]}),(0,n.jsxs)(e.span,{style:{top:"-3.23em"},children:[(0,n.jsx)(e.span,{className:"pstrut",style:{height:"3em"}}),(0,n.jsx)(e.span,{className:"frac-line",style:{borderBottomWidth:"0.04em"}})]}),(0,n.jsxs)(e.span,{style:{top:"-3.677em"},children:[(0,n.jsx)(e.span,{className:"pstrut",style:{height:"3em"}}),(0,n.jsxs)(e.span,{className:"mord",children:[(0,n.jsx)(e.span,{className:"mord mathnormal",style:{marginRight:"0.13889em"},children:"TP"}),(0,n.jsx)(e.span,{className:"mspace",style:{marginRight:"0.2222em"}}),(0,n.jsx)(e.span,{className:"mbin",children:"+"}),(0,n.jsx)(e.span,{className:"mspace",style:{marginRight:"0.2222em"}}),(0,n.jsx)(e.span,{className:"mord mathnormal",style:{marginRight:"0.10903em"},children:"TN"})]})]})]}),(0,n.jsx)(e.span,{className:"vlist-s",children:"\u200b"})]}),(0,n.jsx)(e.span,{className:"vlist-r",children:(0,n.jsx)(e.span,{className:"vlist",style:{height:"0.7693em"},children:(0,n.jsx)(e.span,{})})})]})}),(0,n.jsx)(e.span,{className:"mclose nulldelimiter"})]})]})]})]})}),"\n",(0,n.jsx)(e.p,{children:"In the spam classification example, accuracy measures the fraction of all emails correctly classified."}),"\n",(0,n.jsx)(e.h4,{id:"-limitations",children:"\u27bd Limitations"}),"\n",(0,n.jsx)(e.p,{children:"Accuracy can be misleading for imbalanced datasets."}),"\n",(0,n.jsxs)(e.p,{children:["For instance, a model predicting \u201cnot spam\u201d 100% of the time would achieve ",(0,n.jsx)(e.strong,{children:"99% accuracy"})," if only 1% of emails are spam, despite failing to detect any spam."]}),"\n",(0,n.jsx)(e.h4,{id:"-when-to-use",children:"\u27bd When to use?"}),"\n",(0,n.jsx)(e.p,{children:"As a baseline metric for generic tasks with balanced classes."}),"\n",(0,n.jsx)(e.h3,{id:"recall-true-positive-rate",children:"Recall (True Positive Rate)"}),"\n",(0,n.jsxs)(e.p,{children:["The ",(0,n.jsx)(e.strong,{children:"true positive rate (TPR)"}),", or the proportion of all actual positives that were classified correctly as positives, is also known as ",(0,n.jsx)(e.strong,{children:"recall"}),"."]}),"\n",(0,n.jsx)(e.p,{children:"Recall is mathematically defined as:"}),"\n",(0,n.jsx)(e.span,{className:"katex-display",children:(0,n.jsxs)(e.span,{className:"katex",children:[(0,n.jsx)(e.span,{className:"katex-mathml",children:(0,n.jsx)(e.math,{xmlns:"http://www.w3.org/1998/Math/MathML",display:"block",children:(0,n.jsxs)(e.semantics,{children:[(0,n.jsxs)(e.mrow,{children:[(0,n.jsx)(e.mtext,{children:"Recall\xa0(or\xa0TPR)"}),(0,n.jsx)(e.mo,{children:"="}),(0,n.jsxs)(e.mfrac,{children:[(0,n.jsx)(e.mtext,{children:"correctly\xa0classified\xa0actual\xa0positives"}),(0,n.jsx)(e.mtext,{children:"all\xa0actual\xa0positives"})]}),(0,n.jsx)(e.mo,{children:"="}),(0,n.jsxs)(e.mfrac,{children:[(0,n.jsxs)(e.mrow,{children:[(0,n.jsx)(e.mi,{children:"T"}),(0,n.jsx)(e.mi,{children:"P"})]}),(0,n.jsxs)(e.mrow,{children:[(0,n.jsx)(e.mi,{children:"T"}),(0,n.jsx)(e.mi,{children:"P"}),(0,n.jsx)(e.mo,{children:"+"}),(0,n.jsx)(e.mi,{children:"F"}),(0,n.jsx)(e.mi,{children:"N"})]})]})]}),(0,n.jsx)(e.annotation,{encoding:"application/x-tex",children:"\\text{Recall (or TPR)} =\n\\frac{\\text{correctly classified actual positives}}{\\text{all actual positives}}\n= \\frac{TP}{TP+FN}"})]})})}),(0,n.jsxs)(e.span,{className:"katex-html","aria-hidden":"true",children:[(0,n.jsxs)(e.span,{className:"base",children:[(0,n.jsx)(e.span,{className:"strut",style:{height:"1em",verticalAlign:"-0.25em"}}),(0,n.jsx)(e.span,{className:"mord text",children:(0,n.jsx)(e.span,{className:"mord",children:"Recall\xa0(or\xa0TPR)"})}),(0,n.jsx)(e.span,{className:"mspace",style:{marginRight:"0.2778em"}}),(0,n.jsx)(e.span,{className:"mrel",children:"="}),(0,n.jsx)(e.span,{className:"mspace",style:{marginRight:"0.2778em"}})]}),(0,n.jsxs)(e.span,{className:"base",children:[(0,n.jsx)(e.span,{className:"strut",style:{height:"2.2519em",verticalAlign:"-0.8804em"}}),(0,n.jsxs)(e.span,{className:"mord",children:[(0,n.jsx)(e.span,{className:"mopen nulldelimiter"}),(0,n.jsx)(e.span,{className:"mfrac",children:(0,n.jsxs)(e.span,{className:"vlist-t vlist-t2",children:[(0,n.jsxs)(e.span,{className:"vlist-r",children:[(0,n.jsxs)(e.span,{className:"vlist",style:{height:"1.3714em"},children:[(0,n.jsxs)(e.span,{style:{top:"-2.314em"},children:[(0,n.jsx)(e.span,{className:"pstrut",style:{height:"3em"}}),(0,n.jsx)(e.span,{className:"mord",children:(0,n.jsx)(e.span,{className:"mord text",children:(0,n.jsx)(e.span,{className:"mord",children:"all\xa0actual\xa0positives"})})})]}),(0,n.jsxs)(e.span,{style:{top:"-3.23em"},children:[(0,n.jsx)(e.span,{className:"pstrut",style:{height:"3em"}}),(0,n.jsx)(e.span,{className:"frac-line",style:{borderBottomWidth:"0.04em"}})]}),(0,n.jsxs)(e.span,{style:{top:"-3.677em"},children:[(0,n.jsx)(e.span,{className:"pstrut",style:{height:"3em"}}),(0,n.jsx)(e.span,{className:"mord",children:(0,n.jsx)(e.span,{className:"mord text",children:(0,n.jsx)(e.span,{className:"mord",children:"correctly\xa0classified\xa0actual\xa0positives"})})})]})]}),(0,n.jsx)(e.span,{className:"vlist-s",children:"\u200b"})]}),(0,n.jsx)(e.span,{className:"vlist-r",children:(0,n.jsx)(e.span,{className:"vlist",style:{height:"0.8804em"},children:(0,n.jsx)(e.span,{})})})]})}),(0,n.jsx)(e.span,{className:"mclose nulldelimiter"})]}),(0,n.jsx)(e.span,{className:"mspace",style:{marginRight:"0.2778em"}}),(0,n.jsx)(e.span,{className:"mrel",children:"="}),(0,n.jsx)(e.span,{className:"mspace",style:{marginRight:"0.2778em"}})]}),(0,n.jsxs)(e.span,{className:"base",children:[(0,n.jsx)(e.span,{className:"strut",style:{height:"2.1297em",verticalAlign:"-0.7693em"}}),(0,n.jsxs)(e.span,{className:"mord",children:[(0,n.jsx)(e.span,{className:"mopen nulldelimiter"}),(0,n.jsx)(e.span,{className:"mfrac",children:(0,n.jsxs)(e.span,{className:"vlist-t vlist-t2",children:[(0,n.jsxs)(e.span,{className:"vlist-r",children:[(0,n.jsxs)(e.span,{className:"vlist",style:{height:"1.3603em"},children:[(0,n.jsxs)(e.span,{style:{top:"-2.314em"},children:[(0,n.jsx)(e.span,{className:"pstrut",style:{height:"3em"}}),(0,n.jsxs)(e.span,{className:"mord",children:[(0,n.jsx)(e.span,{className:"mord mathnormal",style:{marginRight:"0.13889em"},children:"TP"}),(0,n.jsx)(e.span,{className:"mspace",style:{marginRight:"0.2222em"}}),(0,n.jsx)(e.span,{className:"mbin",children:"+"}),(0,n.jsx)(e.span,{className:"mspace",style:{marginRight:"0.2222em"}}),(0,n.jsx)(e.span,{className:"mord mathnormal",style:{marginRight:"0.10903em"},children:"FN"})]})]}),(0,n.jsxs)(e.span,{style:{top:"-3.23em"},children:[(0,n.jsx)(e.span,{className:"pstrut",style:{height:"3em"}}),(0,n.jsx)(e.span,{className:"frac-line",style:{borderBottomWidth:"0.04em"}})]}),(0,n.jsxs)(e.span,{style:{top:"-3.677em"},children:[(0,n.jsx)(e.span,{className:"pstrut",style:{height:"3em"}}),(0,n.jsx)(e.span,{className:"mord",children:(0,n.jsx)(e.span,{className:"mord mathnormal",style:{marginRight:"0.13889em"},children:"TP"})})]})]}),(0,n.jsx)(e.span,{className:"vlist-s",children:"\u200b"})]}),(0,n.jsx)(e.span,{className:"vlist-r",children:(0,n.jsx)(e.span,{className:"vlist",style:{height:"0.7693em"},children:(0,n.jsx)(e.span,{})})})]})}),(0,n.jsx)(e.span,{className:"mclose nulldelimiter"})]})]})]})]})}),"\n",(0,n.jsxs)(e.p,{children:[(0,n.jsx)(e.strong,{children:"False negatives"})," are ",(0,n.jsx)(e.strong,{children:"actual positives"})," that were ",(0,n.jsx)(e.strong,{children:"misclassified"})," as negatives, which is why they appear in the denominator."]}),"\n",(0,n.jsxs)(e.p,{children:["In the spam classification example, recall measures the fraction of spam emails that were correctly classified as spam. This is why another name for recall is ",(0,n.jsx)(e.strong,{children:"probability of detection"}),": it answers the question ",(0,n.jsx)(e.em,{children:'"What fraction of spam emails are detected by this model?"'})]}),"\n",(0,n.jsxs)(e.p,{children:["A hypothetical perfect model would have zero false negatives and therefore a recall (TPR) of ",(0,n.jsxs)(e.span,{className:"katex",children:[(0,n.jsx)(e.span,{className:"katex-mathml",children:(0,n.jsx)(e.math,{xmlns:"http://www.w3.org/1998/Math/MathML",children:(0,n.jsxs)(e.semantics,{children:[(0,n.jsx)(e.mrow,{children:(0,n.jsx)(e.mn,{children:"1.0"})}),(0,n.jsx)(e.annotation,{encoding:"application/x-tex",children:"1.0"})]})})}),(0,n.jsx)(e.span,{className:"katex-html","aria-hidden":"true",children:(0,n.jsxs)(e.span,{className:"base",children:[(0,n.jsx)(e.span,{className:"strut",style:{height:"0.6444em"}}),(0,n.jsx)(e.span,{className:"mord",children:"1.0"})]})})]}),", which is to say, a 100% detection rate."]}),"\n",(0,n.jsx)(e.h4,{id:"-limitations-1",children:"\u27bd Limitations"}),"\n",(0,n.jsx)(e.p,{children:"Does not account for false positives. A model with high recall may overflag legitimate emails as spam."}),"\n",(0,n.jsx)(e.h4,{id:"-when-to-use-1",children:"\u27bd When to use?"}),"\n",(0,n.jsxs)(e.p,{children:["Imbalanced datasets where the ",(0,n.jsx)(e.strong,{children:"positive class is rare but critical"})," (e.g., fraud detection, medical diagnosis). For applications like these, correctly identifying the positive cases is crucial. A false negative typically has more serious consequences than a false positive."]}),"\n",(0,n.jsx)(e.h3,{id:"false-positive-rate",children:"False Positive Rate"}),"\n",(0,n.jsxs)(e.p,{children:["The ",(0,n.jsx)(e.strong,{children:"false Positive Rate (FPR)"})," is the proportion of all actual negatives that were classified incorrectly as positives, also known as the ",(0,n.jsx)(e.strong,{children:"probability of false alarm"}),". It is mathematically defined as:"]}),"\n",(0,n.jsx)(e.span,{className:"katex-display",children:(0,n.jsxs)(e.span,{className:"katex",children:[(0,n.jsx)(e.span,{className:"katex-mathml",children:(0,n.jsx)(e.math,{xmlns:"http://www.w3.org/1998/Math/MathML",display:"block",children:(0,n.jsxs)(e.semantics,{children:[(0,n.jsxs)(e.mrow,{children:[(0,n.jsx)(e.mtext,{children:"FPR"}),(0,n.jsx)(e.mo,{children:"="}),(0,n.jsxs)(e.mfrac,{children:[(0,n.jsx)(e.mtext,{children:"incorrectly\xa0classified\xa0actual\xa0negatives"}),(0,n.jsx)(e.mtext,{children:"all\xa0actual\xa0negatives"})]}),(0,n.jsx)(e.mo,{children:"="}),(0,n.jsxs)(e.mfrac,{children:[(0,n.jsxs)(e.mrow,{children:[(0,n.jsx)(e.mi,{children:"F"}),(0,n.jsx)(e.mi,{children:"P"})]}),(0,n.jsxs)(e.mrow,{children:[(0,n.jsx)(e.mi,{children:"F"}),(0,n.jsx)(e.mi,{children:"P"}),(0,n.jsx)(e.mo,{children:"+"}),(0,n.jsx)(e.mi,{children:"T"}),(0,n.jsx)(e.mi,{children:"N"})]})]})]}),(0,n.jsx)(e.annotation,{encoding:"application/x-tex",children:"\\text{FPR} =\n\\frac{\\text{incorrectly classified actual negatives}}\n{\\text{all actual negatives}}\n= \\frac{FP}{FP+TN}"})]})})}),(0,n.jsxs)(e.span,{className:"katex-html","aria-hidden":"true",children:[(0,n.jsxs)(e.span,{className:"base",children:[(0,n.jsx)(e.span,{className:"strut",style:{height:"0.6833em"}}),(0,n.jsx)(e.span,{className:"mord text",children:(0,n.jsx)(e.span,{className:"mord",children:"FPR"})}),(0,n.jsx)(e.span,{className:"mspace",style:{marginRight:"0.2778em"}}),(0,n.jsx)(e.span,{className:"mrel",children:"="}),(0,n.jsx)(e.span,{className:"mspace",style:{marginRight:"0.2778em"}})]}),(0,n.jsxs)(e.span,{className:"base",children:[(0,n.jsx)(e.span,{className:"strut",style:{height:"2.2519em",verticalAlign:"-0.8804em"}}),(0,n.jsxs)(e.span,{className:"mord",children:[(0,n.jsx)(e.span,{className:"mopen nulldelimiter"}),(0,n.jsx)(e.span,{className:"mfrac",children:(0,n.jsxs)(e.span,{className:"vlist-t vlist-t2",children:[(0,n.jsxs)(e.span,{className:"vlist-r",children:[(0,n.jsxs)(e.span,{className:"vlist",style:{height:"1.3714em"},children:[(0,n.jsxs)(e.span,{style:{top:"-2.314em"},children:[(0,n.jsx)(e.span,{className:"pstrut",style:{height:"3em"}}),(0,n.jsx)(e.span,{className:"mord",children:(0,n.jsx)(e.span,{className:"mord text",children:(0,n.jsx)(e.span,{className:"mord",children:"all\xa0actual\xa0negatives"})})})]}),(0,n.jsxs)(e.span,{style:{top:"-3.23em"},children:[(0,n.jsx)(e.span,{className:"pstrut",style:{height:"3em"}}),(0,n.jsx)(e.span,{className:"frac-line",style:{borderBottomWidth:"0.04em"}})]}),(0,n.jsxs)(e.span,{style:{top:"-3.677em"},children:[(0,n.jsx)(e.span,{className:"pstrut",style:{height:"3em"}}),(0,n.jsx)(e.span,{className:"mord",children:(0,n.jsx)(e.span,{className:"mord text",children:(0,n.jsx)(e.span,{className:"mord",children:"incorrectly\xa0classified\xa0actual\xa0negatives"})})})]})]}),(0,n.jsx)(e.span,{className:"vlist-s",children:"\u200b"})]}),(0,n.jsx)(e.span,{className:"vlist-r",children:(0,n.jsx)(e.span,{className:"vlist",style:{height:"0.8804em"},children:(0,n.jsx)(e.span,{})})})]})}),(0,n.jsx)(e.span,{className:"mclose nulldelimiter"})]}),(0,n.jsx)(e.span,{className:"mspace",style:{marginRight:"0.2778em"}}),(0,n.jsx)(e.span,{className:"mrel",children:"="}),(0,n.jsx)(e.span,{className:"mspace",style:{marginRight:"0.2778em"}})]}),(0,n.jsxs)(e.span,{className:"base",children:[(0,n.jsx)(e.span,{className:"strut",style:{height:"2.1297em",verticalAlign:"-0.7693em"}}),(0,n.jsxs)(e.span,{className:"mord",children:[(0,n.jsx)(e.span,{className:"mopen nulldelimiter"}),(0,n.jsx)(e.span,{className:"mfrac",children:(0,n.jsxs)(e.span,{className:"vlist-t vlist-t2",children:[(0,n.jsxs)(e.span,{className:"vlist-r",children:[(0,n.jsxs)(e.span,{className:"vlist",style:{height:"1.3603em"},children:[(0,n.jsxs)(e.span,{style:{top:"-2.314em"},children:[(0,n.jsx)(e.span,{className:"pstrut",style:{height:"3em"}}),(0,n.jsxs)(e.span,{className:"mord",children:[(0,n.jsx)(e.span,{className:"mord mathnormal",style:{marginRight:"0.13889em"},children:"FP"}),(0,n.jsx)(e.span,{className:"mspace",style:{marginRight:"0.2222em"}}),(0,n.jsx)(e.span,{className:"mbin",children:"+"}),(0,n.jsx)(e.span,{className:"mspace",style:{marginRight:"0.2222em"}}),(0,n.jsx)(e.span,{className:"mord mathnormal",style:{marginRight:"0.10903em"},children:"TN"})]})]}),(0,n.jsxs)(e.span,{style:{top:"-3.23em"},children:[(0,n.jsx)(e.span,{className:"pstrut",style:{height:"3em"}}),(0,n.jsx)(e.span,{className:"frac-line",style:{borderBottomWidth:"0.04em"}})]}),(0,n.jsxs)(e.span,{style:{top:"-3.677em"},children:[(0,n.jsx)(e.span,{className:"pstrut",style:{height:"3em"}}),(0,n.jsx)(e.span,{className:"mord",children:(0,n.jsx)(e.span,{className:"mord mathnormal",style:{marginRight:"0.13889em"},children:"FP"})})]})]}),(0,n.jsx)(e.span,{className:"vlist-s",children:"\u200b"})]}),(0,n.jsx)(e.span,{className:"vlist-r",children:(0,n.jsx)(e.span,{className:"vlist",style:{height:"0.7693em"},children:(0,n.jsx)(e.span,{})})})]})}),(0,n.jsx)(e.span,{className:"mclose nulldelimiter"})]})]})]})]})}),"\n",(0,n.jsxs)(e.p,{children:[(0,n.jsx)(e.strong,{children:"False positives"})," are ",(0,n.jsx)(e.strong,{children:"actual negatives"})," that were ",(0,n.jsx)(e.strong,{children:"misclassified"}),", which is why they appear in the denominator."]}),"\n",(0,n.jsx)(e.p,{children:"In the spam classification example, FPR measures the fraction of legitimate emails that were incorrectly classified as spam, or the model's rate of false alarms."}),"\n",(0,n.jsxs)(e.p,{children:["A perfect model would have zero false positives and therefore a FPR of ",(0,n.jsxs)(e.span,{className:"katex",children:[(0,n.jsx)(e.span,{className:"katex-mathml",children:(0,n.jsx)(e.math,{xmlns:"http://www.w3.org/1998/Math/MathML",children:(0,n.jsxs)(e.semantics,{children:[(0,n.jsx)(e.mrow,{children:(0,n.jsx)(e.mn,{children:"0.0"})}),(0,n.jsx)(e.annotation,{encoding:"application/x-tex",children:"0.0"})]})})}),(0,n.jsx)(e.span,{className:"katex-html","aria-hidden":"true",children:(0,n.jsxs)(e.span,{className:"base",children:[(0,n.jsx)(e.span,{className:"strut",style:{height:"0.6444em"}}),(0,n.jsx)(e.span,{className:"mord",children:"0.0"})]})})]}),", which is to say, a 0% false alarm rate."]}),"\n",(0,n.jsx)(e.h4,{id:"-limitations-2",children:"\u27bd Limitations"}),"\n",(0,n.jsx)(e.p,{children:"Less meaningful when actual negatives are extremely rare (e.g., only 1\u20132 negatives in the dataset)."}),"\n",(0,n.jsx)(e.h4,{id:"-when-to-use-2",children:"\u27bd When to use?"}),"\n",(0,n.jsx)(e.p,{children:"Applications prioritizing minimal false alarms (e.g., security systems)."}),"\n",(0,n.jsx)(e.h3,{id:"precision",children:"Precision"}),"\n",(0,n.jsxs)(e.p,{children:[(0,n.jsx)(e.strong,{children:"Precision"})," is the proportion of all the model's positive classifications that are actually positive. It is mathematically defined as:"]}),"\n",(0,n.jsx)(e.span,{className:"katex-display",children:(0,n.jsxs)(e.span,{className:"katex",children:[(0,n.jsx)(e.span,{className:"katex-mathml",children:(0,n.jsx)(e.math,{xmlns:"http://www.w3.org/1998/Math/MathML",display:"block",children:(0,n.jsxs)(e.semantics,{children:[(0,n.jsxs)(e.mrow,{children:[(0,n.jsx)(e.mtext,{children:"Precision"}),(0,n.jsx)(e.mo,{children:"="}),(0,n.jsxs)(e.mfrac,{children:[(0,n.jsx)(e.mtext,{children:"correctly\xa0classified\xa0actual\xa0positives"}),(0,n.jsx)(e.mtext,{children:"everything\xa0classified\xa0as\xa0positive"})]}),(0,n.jsx)(e.mo,{children:"="}),(0,n.jsxs)(e.mfrac,{children:[(0,n.jsxs)(e.mrow,{children:[(0,n.jsx)(e.mi,{children:"T"}),(0,n.jsx)(e.mi,{children:"P"})]}),(0,n.jsxs)(e.mrow,{children:[(0,n.jsx)(e.mi,{children:"T"}),(0,n.jsx)(e.mi,{children:"P"}),(0,n.jsx)(e.mo,{children:"+"}),(0,n.jsx)(e.mi,{children:"F"}),(0,n.jsx)(e.mi,{children:"P"})]})]})]}),(0,n.jsx)(e.annotation,{encoding:"application/x-tex",children:"\\text{Precision} =\n\\frac{\\text{correctly classified actual positives}}\n{\\text{everything classified as positive}}\n= \\frac{TP}{TP+FP}"})]})})}),(0,n.jsxs)(e.span,{className:"katex-html","aria-hidden":"true",children:[(0,n.jsxs)(e.span,{className:"base",children:[(0,n.jsx)(e.span,{className:"strut",style:{height:"0.6833em"}}),(0,n.jsx)(e.span,{className:"mord text",children:(0,n.jsx)(e.span,{className:"mord",children:"Precision"})}),(0,n.jsx)(e.span,{className:"mspace",style:{marginRight:"0.2778em"}}),(0,n.jsx)(e.span,{className:"mrel",children:"="}),(0,n.jsx)(e.span,{className:"mspace",style:{marginRight:"0.2778em"}})]}),(0,n.jsxs)(e.span,{className:"base",children:[(0,n.jsx)(e.span,{className:"strut",style:{height:"2.2519em",verticalAlign:"-0.8804em"}}),(0,n.jsxs)(e.span,{className:"mord",children:[(0,n.jsx)(e.span,{className:"mopen nulldelimiter"}),(0,n.jsx)(e.span,{className:"mfrac",children:(0,n.jsxs)(e.span,{className:"vlist-t vlist-t2",children:[(0,n.jsxs)(e.span,{className:"vlist-r",children:[(0,n.jsxs)(e.span,{className:"vlist",style:{height:"1.3714em"},children:[(0,n.jsxs)(e.span,{style:{top:"-2.314em"},children:[(0,n.jsx)(e.span,{className:"pstrut",style:{height:"3em"}}),(0,n.jsx)(e.span,{className:"mord",children:(0,n.jsx)(e.span,{className:"mord text",children:(0,n.jsx)(e.span,{className:"mord",children:"everything\xa0classified\xa0as\xa0positive"})})})]}),(0,n.jsxs)(e.span,{style:{top:"-3.23em"},children:[(0,n.jsx)(e.span,{className:"pstrut",style:{height:"3em"}}),(0,n.jsx)(e.span,{className:"frac-line",style:{borderBottomWidth:"0.04em"}})]}),(0,n.jsxs)(e.span,{style:{top:"-3.677em"},children:[(0,n.jsx)(e.span,{className:"pstrut",style:{height:"3em"}}),(0,n.jsx)(e.span,{className:"mord",children:(0,n.jsx)(e.span,{className:"mord text",children:(0,n.jsx)(e.span,{className:"mord",children:"correctly\xa0classified\xa0actual\xa0positives"})})})]})]}),(0,n.jsx)(e.span,{className:"vlist-s",children:"\u200b"})]}),(0,n.jsx)(e.span,{className:"vlist-r",children:(0,n.jsx)(e.span,{className:"vlist",style:{height:"0.8804em"},children:(0,n.jsx)(e.span,{})})})]})}),(0,n.jsx)(e.span,{className:"mclose nulldelimiter"})]}),(0,n.jsx)(e.span,{className:"mspace",style:{marginRight:"0.2778em"}}),(0,n.jsx)(e.span,{className:"mrel",children:"="}),(0,n.jsx)(e.span,{className:"mspace",style:{marginRight:"0.2778em"}})]}),(0,n.jsxs)(e.span,{className:"base",children:[(0,n.jsx)(e.span,{className:"strut",style:{height:"2.1297em",verticalAlign:"-0.7693em"}}),(0,n.jsxs)(e.span,{className:"mord",children:[(0,n.jsx)(e.span,{className:"mopen nulldelimiter"}),(0,n.jsx)(e.span,{className:"mfrac",children:(0,n.jsxs)(e.span,{className:"vlist-t vlist-t2",children:[(0,n.jsxs)(e.span,{className:"vlist-r",children:[(0,n.jsxs)(e.span,{className:"vlist",style:{height:"1.3603em"},children:[(0,n.jsxs)(e.span,{style:{top:"-2.314em"},children:[(0,n.jsx)(e.span,{className:"pstrut",style:{height:"3em"}}),(0,n.jsxs)(e.span,{className:"mord",children:[(0,n.jsx)(e.span,{className:"mord mathnormal",style:{marginRight:"0.13889em"},children:"TP"}),(0,n.jsx)(e.span,{className:"mspace",style:{marginRight:"0.2222em"}}),(0,n.jsx)(e.span,{className:"mbin",children:"+"}),(0,n.jsx)(e.span,{className:"mspace",style:{marginRight:"0.2222em"}}),(0,n.jsx)(e.span,{className:"mord mathnormal",style:{marginRight:"0.13889em"},children:"FP"})]})]}),(0,n.jsxs)(e.span,{style:{top:"-3.23em"},children:[(0,n.jsx)(e.span,{className:"pstrut",style:{height:"3em"}}),(0,n.jsx)(e.span,{className:"frac-line",style:{borderBottomWidth:"0.04em"}})]}),(0,n.jsxs)(e.span,{style:{top:"-3.677em"},children:[(0,n.jsx)(e.span,{className:"pstrut",style:{height:"3em"}}),(0,n.jsx)(e.span,{className:"mord",children:(0,n.jsx)(e.span,{className:"mord mathnormal",style:{marginRight:"0.13889em"},children:"TP"})})]})]}),(0,n.jsx)(e.span,{className:"vlist-s",children:"\u200b"})]}),(0,n.jsx)(e.span,{className:"vlist-r",children:(0,n.jsx)(e.span,{className:"vlist",style:{height:"0.7693em"},children:(0,n.jsx)(e.span,{})})})]})}),(0,n.jsx)(e.span,{className:"mclose nulldelimiter"})]})]})]})]})}),"\n",(0,n.jsx)(e.p,{children:"In the spam classification example, precision measures the fraction of emails classified as spam that were actually spam."}),"\n",(0,n.jsxs)(e.p,{children:["A hypothetical perfect model would have zero false positives and therefore a precision of ",(0,n.jsxs)(e.span,{className:"katex",children:[(0,n.jsx)(e.span,{className:"katex-mathml",children:(0,n.jsx)(e.math,{xmlns:"http://www.w3.org/1998/Math/MathML",children:(0,n.jsxs)(e.semantics,{children:[(0,n.jsx)(e.mrow,{children:(0,n.jsx)(e.mn,{children:"1.0"})}),(0,n.jsx)(e.annotation,{encoding:"application/x-tex",children:"1.0"})]})})}),(0,n.jsx)(e.span,{className:"katex-html","aria-hidden":"true",children:(0,n.jsxs)(e.span,{className:"base",children:[(0,n.jsx)(e.span,{className:"strut",style:{height:"0.6444em"}}),(0,n.jsx)(e.span,{className:"mord",children:"1.0"})]})})]}),"."]}),"\n",(0,n.jsx)(e.h4,{id:"-limitations-3",children:"\u27bd Limitations"}),"\n",(0,n.jsx)(e.p,{children:"In an imbalanced dataset where the number of actual positives is very, very low, say 1-2 examples in total, precision is less meaningful and less useful as a metric."}),"\n",(0,n.jsx)(e.p,{children:"Moreover, it does not penalize false negatives. A high-precision model might miss many true positives."}),"\n",(0,n.jsx)(e.h4,{id:"-when-to-use-3",children:"\u27bd When to use?"}),"\n",(0,n.jsx)(e.p,{children:"Tasks requiring high confidence in positive predictions (e.g., product recommendations)."}),"\n",(0,n.jsx)(e.h3,{id:"trade-offs-and-threshold-tuning",children:"Trade-offs and Threshold Tuning"}),"\n",(0,n.jsx)(e.h4,{id:"-precision-recall-trade-off",children:"\u27bd Precision-Recall Trade-off"}),"\n",(0,n.jsxs)(e.p,{children:["Precision improves as false positives decrease, while recall improves when false negatives decrease. But as seen in the previous section, increasing the classification threshold tends to decrease the number of false positives and increase the number of false negatives, while decreasing the threshold has the opposite effects. As a result, ",(0,n.jsx)(e.strong,{children:"precision and recall often show an inverse relationship"}),", where improving one of them worsens the other."]}),"\n",(0,n.jsxs)(e.ul,{children:["\n",(0,n.jsxs)(e.li,{children:[(0,n.jsx)(e.strong,{children:"Increasing the threshold"})," raises precision (fewer FP) but lowers recall (more FN)."]}),"\n",(0,n.jsxs)(e.li,{children:[(0,n.jsx)(e.strong,{children:"Decreasing the threshold"})," raises recall (fewer FN) but lowers precision (more FP)."]}),"\n"]}),"\n",(0,n.jsx)(e.h3,{id:"f1-score-balancing-precision-and-recall",children:"F1-Score: Balancing Precision and Recall"}),"\n",(0,n.jsxs)(e.p,{children:["The F1-score harmonizes precision and recall into a single metric, calculated as the ",(0,n.jsx)(e.strong,{children:"harmonic mean"})," of the two:"]}),"\n",(0,n.jsx)(e.span,{className:"katex-display",children:(0,n.jsxs)(e.span,{className:"katex",children:[(0,n.jsx)(e.span,{className:"katex-mathml",children:(0,n.jsx)(e.math,{xmlns:"http://www.w3.org/1998/Math/MathML",display:"block",children:(0,n.jsxs)(e.semantics,{children:[(0,n.jsxs)(e.mrow,{children:[(0,n.jsx)(e.mtext,{children:"F1-Score"}),(0,n.jsx)(e.mo,{children:"="}),(0,n.jsxs)(e.mfrac,{children:[(0,n.jsxs)(e.mrow,{children:[(0,n.jsx)(e.mn,{children:"2"}),(0,n.jsx)(e.mo,{children:"\u22c5"}),(0,n.jsx)(e.mtext,{children:"Precision"}),(0,n.jsx)(e.mo,{children:"\u22c5"}),(0,n.jsx)(e.mtext,{children:"Recall"})]}),(0,n.jsxs)(e.mrow,{children:[(0,n.jsx)(e.mtext,{children:"Precision"}),(0,n.jsx)(e.mo,{children:"+"}),(0,n.jsx)(e.mtext,{children:"Recall"})]})]})]}),(0,n.jsx)(e.annotation,{encoding:"application/x-tex",children:"\\text{F1-Score} = \\frac{2 \\cdot \\text{Precision} \\cdot \\text{Recall}}{\\text{Precision} + \\text{Recall}}"})]})})}),(0,n.jsxs)(e.span,{className:"katex-html","aria-hidden":"true",children:[(0,n.jsxs)(e.span,{className:"base",children:[(0,n.jsx)(e.span,{className:"strut",style:{height:"0.6833em"}}),(0,n.jsx)(e.span,{className:"mord text",children:(0,n.jsx)(e.span,{className:"mord",children:"F1-Score"})}),(0,n.jsx)(e.span,{className:"mspace",style:{marginRight:"0.2778em"}}),(0,n.jsx)(e.span,{className:"mrel",children:"="}),(0,n.jsx)(e.span,{className:"mspace",style:{marginRight:"0.2778em"}})]}),(0,n.jsxs)(e.span,{className:"base",children:[(0,n.jsx)(e.span,{className:"strut",style:{height:"2.1408em",verticalAlign:"-0.7693em"}}),(0,n.jsxs)(e.span,{className:"mord",children:[(0,n.jsx)(e.span,{className:"mopen nulldelimiter"}),(0,n.jsx)(e.span,{className:"mfrac",children:(0,n.jsxs)(e.span,{className:"vlist-t vlist-t2",children:[(0,n.jsxs)(e.span,{className:"vlist-r",children:[(0,n.jsxs)(e.span,{className:"vlist",style:{height:"1.3714em"},children:[(0,n.jsxs)(e.span,{style:{top:"-2.314em"},children:[(0,n.jsx)(e.span,{className:"pstrut",style:{height:"3em"}}),(0,n.jsxs)(e.span,{className:"mord",children:[(0,n.jsx)(e.span,{className:"mord text",children:(0,n.jsx)(e.span,{className:"mord",children:"Precision"})}),(0,n.jsx)(e.span,{className:"mspace",style:{marginRight:"0.2222em"}}),(0,n.jsx)(e.span,{className:"mbin",children:"+"}),(0,n.jsx)(e.span,{className:"mspace",style:{marginRight:"0.2222em"}}),(0,n.jsx)(e.span,{className:"mord text",children:(0,n.jsx)(e.span,{className:"mord",children:"Recall"})})]})]}),(0,n.jsxs)(e.span,{style:{top:"-3.23em"},children:[(0,n.jsx)(e.span,{className:"pstrut",style:{height:"3em"}}),(0,n.jsx)(e.span,{className:"frac-line",style:{borderBottomWidth:"0.04em"}})]}),(0,n.jsxs)(e.span,{style:{top:"-3.677em"},children:[(0,n.jsx)(e.span,{className:"pstrut",style:{height:"3em"}}),(0,n.jsxs)(e.span,{className:"mord",children:[(0,n.jsx)(e.span,{className:"mord",children:"2"}),(0,n.jsx)(e.span,{className:"mspace",style:{marginRight:"0.2222em"}}),(0,n.jsx)(e.span,{className:"mbin",children:"\u22c5"}),(0,n.jsx)(e.span,{className:"mspace",style:{marginRight:"0.2222em"}}),(0,n.jsx)(e.span,{className:"mord text",children:(0,n.jsx)(e.span,{className:"mord",children:"Precision"})}),(0,n.jsx)(e.span,{className:"mspace",style:{marginRight:"0.2222em"}}),(0,n.jsx)(e.span,{className:"mbin",children:"\u22c5"}),(0,n.jsx)(e.span,{className:"mspace",style:{marginRight:"0.2222em"}}),(0,n.jsx)(e.span,{className:"mord text",children:(0,n.jsx)(e.span,{className:"mord",children:"Recall"})})]})]})]}),(0,n.jsx)(e.span,{className:"vlist-s",children:"\u200b"})]}),(0,n.jsx)(e.span,{className:"vlist-r",children:(0,n.jsx)(e.span,{className:"vlist",style:{height:"0.7693em"},children:(0,n.jsx)(e.span,{})})})]})}),(0,n.jsx)(e.span,{className:"mclose nulldelimiter"})]})]})]})]})}),"\n",(0,n.jsxs)(e.p,{children:["Unlike the arithmetic mean, the harmonic mean penalizes extreme imbalances between precision and recall. For example, a model with precision=",(0,n.jsxs)(e.span,{className:"katex",children:[(0,n.jsx)(e.span,{className:"katex-mathml",children:(0,n.jsx)(e.math,{xmlns:"http://www.w3.org/1998/Math/MathML",children:(0,n.jsxs)(e.semantics,{children:[(0,n.jsx)(e.mrow,{children:(0,n.jsx)(e.mn,{children:"1.0"})}),(0,n.jsx)(e.annotation,{encoding:"application/x-tex",children:"1.0"})]})})}),(0,n.jsx)(e.span,{className:"katex-html","aria-hidden":"true",children:(0,n.jsxs)(e.span,{className:"base",children:[(0,n.jsx)(e.span,{className:"strut",style:{height:"0.6444em"}}),(0,n.jsx)(e.span,{className:"mord",children:"1.0"})]})})]})," and recall=",(0,n.jsxs)(e.span,{className:"katex",children:[(0,n.jsx)(e.span,{className:"katex-mathml",children:(0,n.jsx)(e.math,{xmlns:"http://www.w3.org/1998/Math/MathML",children:(0,n.jsxs)(e.semantics,{children:[(0,n.jsx)(e.mrow,{children:(0,n.jsx)(e.mn,{children:"0.5"})}),(0,n.jsx)(e.annotation,{encoding:"application/x-tex",children:"0.5"})]})})}),(0,n.jsx)(e.span,{className:"katex-html","aria-hidden":"true",children:(0,n.jsxs)(e.span,{className:"base",children:[(0,n.jsx)(e.span,{className:"strut",style:{height:"0.6444em"}}),(0,n.jsx)(e.span,{className:"mord",children:"0.5"})]})})]})," would have an arithmetic mean of ",(0,n.jsxs)(e.span,{className:"katex",children:[(0,n.jsx)(e.span,{className:"katex-mathml",children:(0,n.jsx)(e.math,{xmlns:"http://www.w3.org/1998/Math/MathML",children:(0,n.jsxs)(e.semantics,{children:[(0,n.jsx)(e.mrow,{children:(0,n.jsx)(e.mn,{children:"0.75"})}),(0,n.jsx)(e.annotation,{encoding:"application/x-tex",children:"0.75"})]})})}),(0,n.jsx)(e.span,{className:"katex-html","aria-hidden":"true",children:(0,n.jsxs)(e.span,{className:"base",children:[(0,n.jsx)(e.span,{className:"strut",style:{height:"0.6444em"}}),(0,n.jsx)(e.span,{className:"mord",children:"0.75"})]})})]})," but an F1-score of ",(0,n.jsxs)(e.span,{className:"katex",children:[(0,n.jsx)(e.span,{className:"katex-mathml",children:(0,n.jsx)(e.math,{xmlns:"http://www.w3.org/1998/Math/MathML",children:(0,n.jsxs)(e.semantics,{children:[(0,n.jsx)(e.mrow,{children:(0,n.jsx)(e.mn,{children:"0.67"})}),(0,n.jsx)(e.annotation,{encoding:"application/x-tex",children:"0.67"})]})})}),(0,n.jsx)(e.span,{className:"katex-html","aria-hidden":"true",children:(0,n.jsxs)(e.span,{className:"base",children:[(0,n.jsx)(e.span,{className:"strut",style:{height:"0.6444em"}}),(0,n.jsx)(e.span,{className:"mord",children:"0.67"})]})})]}),". This makes the F1-score especially useful when both false positives and false negatives carry significant costs, such as in medical diagnosis or fraud detection."]}),"\n",(0,n.jsx)(e.h4,{id:"-limitations-4",children:"\u27bd Limitations"}),"\n",(0,n.jsxs)(e.ul,{children:["\n",(0,n.jsx)(e.li,{children:"Assumes equal importance of precision and recall, which may not align with domain-specific priorities."}),"\n",(0,n.jsx)(e.li,{children:"Less interpretable than precision or recall alone."}),"\n"]}),"\n",(0,n.jsx)(e.h4,{id:"-when-to-use-4",children:"\u27bd When to use?"}),"\n",(0,n.jsxs)(e.ul,{children:["\n",(0,n.jsx)(e.li,{children:"Imbalanced datasets where neither precision nor recall should dominate."}),"\n",(0,n.jsx)(e.li,{children:"Scenarios requiring a balanced view of model performance (e.g., quality control systems)."}),"\n"]}),"\n",(0,n.jsxs)(e.h2,{id:"4\ufe0f\u20e3-roc-and-auc",children:["4\ufe0f\u20e3 ",(0,n.jsx)(e.strong,{children:"ROC and AUC"})]}),"\n",(0,n.jsx)(e.h3,{id:"receiver-operating-characteristic-curve-roc",children:"Receiver-operating characteristic curve (ROC)"}),"\n",(0,n.jsxs)(e.p,{children:["The ROC curve is a visual representation of ",(0,n.jsx)(e.strong,{children:"model performance across all thresholds"}),"."]}),"\n",(0,n.jsx)(e.p,{children:"It is drawn by calculating the true positive rate (TPR) and false positive rate (FPR) at every possible threshold (in practice, at selected intervals), then graphing TPR over FPR."}),"\n",(0,n.jsxs)(e.p,{children:["A perfect model, which at some threshold has a TPR of ",(0,n.jsxs)(e.span,{className:"katex",children:[(0,n.jsx)(e.span,{className:"katex-mathml",children:(0,n.jsx)(e.math,{xmlns:"http://www.w3.org/1998/Math/MathML",children:(0,n.jsxs)(e.semantics,{children:[(0,n.jsx)(e.mrow,{children:(0,n.jsx)(e.mn,{children:"1.0"})}),(0,n.jsx)(e.annotation,{encoding:"application/x-tex",children:"1.0"})]})})}),(0,n.jsx)(e.span,{className:"katex-html","aria-hidden":"true",children:(0,n.jsxs)(e.span,{className:"base",children:[(0,n.jsx)(e.span,{className:"strut",style:{height:"0.6444em"}}),(0,n.jsx)(e.span,{className:"mord",children:"1.0"})]})})]})," and a FPR of ",(0,n.jsxs)(e.span,{className:"katex",children:[(0,n.jsx)(e.span,{className:"katex-mathml",children:(0,n.jsx)(e.math,{xmlns:"http://www.w3.org/1998/Math/MathML",children:(0,n.jsxs)(e.semantics,{children:[(0,n.jsx)(e.mrow,{children:(0,n.jsx)(e.mn,{children:"0.0"})}),(0,n.jsx)(e.annotation,{encoding:"application/x-tex",children:"0.0"})]})})}),(0,n.jsx)(e.span,{className:"katex-html","aria-hidden":"true",children:(0,n.jsxs)(e.span,{className:"base",children:[(0,n.jsx)(e.span,{className:"strut",style:{height:"0.6444em"}}),(0,n.jsx)(e.span,{className:"mord",children:"0.0"})]})})]}),", can be represented by either a point at ",(0,n.jsxs)(e.span,{className:"katex",children:[(0,n.jsx)(e.span,{className:"katex-mathml",children:(0,n.jsx)(e.math,{xmlns:"http://www.w3.org/1998/Math/MathML",children:(0,n.jsxs)(e.semantics,{children:[(0,n.jsxs)(e.mrow,{children:[(0,n.jsx)(e.mo,{stretchy:"false",children:"("}),(0,n.jsx)(e.mn,{children:"0"}),(0,n.jsx)(e.mo,{separator:"true",children:","}),(0,n.jsx)(e.mn,{children:"1"}),(0,n.jsx)(e.mo,{stretchy:"false",children:")"})]}),(0,n.jsx)(e.annotation,{encoding:"application/x-tex",children:"(0, 1)"})]})})}),(0,n.jsx)(e.span,{className:"katex-html","aria-hidden":"true",children:(0,n.jsxs)(e.span,{className:"base",children:[(0,n.jsx)(e.span,{className:"strut",style:{height:"1em",verticalAlign:"-0.25em"}}),(0,n.jsx)(e.span,{className:"mopen",children:"("}),(0,n.jsx)(e.span,{className:"mord",children:"0"}),(0,n.jsx)(e.span,{className:"mpunct",children:","}),(0,n.jsx)(e.span,{className:"mspace",style:{marginRight:"0.1667em"}}),(0,n.jsx)(e.span,{className:"mord",children:"1"}),(0,n.jsx)(e.span,{className:"mclose",children:")"})]})})]})," if all other thresholds are ignored, or by the following:"]}),"\n",(0,n.jsx)(e.p,{children:(0,n.jsx)(e.img,{alt:"My Image",src:a(81252).A+"",width:"2013",height:"627"})}),"\n",(0,n.jsx)(e.h3,{id:"area-under-the-curve-auc",children:"Area under the curve (AUC)"}),"\n",(0,n.jsxs)(e.p,{children:["The area under the ROC curve (AUC) represents the ",(0,n.jsx)(e.strong,{children:"probability"})," that the model, if given a randomly chosen positive and negative example, ",(0,n.jsx)(e.strong,{children:"will rank the positive higher than the negative"}),"."]}),"\n",(0,n.jsxs)(e.p,{children:["The perfect model above, containing a square with sides of length 1, has an area under the curve (AUC) of ",(0,n.jsxs)(e.span,{className:"katex",children:[(0,n.jsx)(e.span,{className:"katex-mathml",children:(0,n.jsx)(e.math,{xmlns:"http://www.w3.org/1998/Math/MathML",children:(0,n.jsxs)(e.semantics,{children:[(0,n.jsx)(e.mrow,{children:(0,n.jsx)(e.mn,{children:"1.0"})}),(0,n.jsx)(e.annotation,{encoding:"application/x-tex",children:"1.0"})]})})}),(0,n.jsx)(e.span,{className:"katex-html","aria-hidden":"true",children:(0,n.jsxs)(e.span,{className:"base",children:[(0,n.jsx)(e.span,{className:"strut",style:{height:"0.6444em"}}),(0,n.jsx)(e.span,{className:"mord",children:"1.0"})]})})]}),"."]}),"\n",(0,n.jsxs)(e.p,{children:["For a binary classifier, a model that does exactly as well as random guesses or coin flips has a ROC that is a diagonal line from ",(0,n.jsxs)(e.span,{className:"katex",children:[(0,n.jsx)(e.span,{className:"katex-mathml",children:(0,n.jsx)(e.math,{xmlns:"http://www.w3.org/1998/Math/MathML",children:(0,n.jsxs)(e.semantics,{children:[(0,n.jsxs)(e.mrow,{children:[(0,n.jsx)(e.mo,{stretchy:"false",children:"("}),(0,n.jsx)(e.mn,{children:"0"}),(0,n.jsx)(e.mo,{separator:"true",children:","}),(0,n.jsx)(e.mn,{children:"0"}),(0,n.jsx)(e.mo,{stretchy:"false",children:")"})]}),(0,n.jsx)(e.annotation,{encoding:"application/x-tex",children:"(0,0)"})]})})}),(0,n.jsx)(e.span,{className:"katex-html","aria-hidden":"true",children:(0,n.jsxs)(e.span,{className:"base",children:[(0,n.jsx)(e.span,{className:"strut",style:{height:"1em",verticalAlign:"-0.25em"}}),(0,n.jsx)(e.span,{className:"mopen",children:"("}),(0,n.jsx)(e.span,{className:"mord",children:"0"}),(0,n.jsx)(e.span,{className:"mpunct",children:","}),(0,n.jsx)(e.span,{className:"mspace",style:{marginRight:"0.1667em"}}),(0,n.jsx)(e.span,{className:"mord",children:"0"}),(0,n.jsx)(e.span,{className:"mclose",children:")"})]})})]})," to ",(0,n.jsxs)(e.span,{className:"katex",children:[(0,n.jsx)(e.span,{className:"katex-mathml",children:(0,n.jsx)(e.math,{xmlns:"http://www.w3.org/1998/Math/MathML",children:(0,n.jsxs)(e.semantics,{children:[(0,n.jsxs)(e.mrow,{children:[(0,n.jsx)(e.mo,{stretchy:"false",children:"("}),(0,n.jsx)(e.mn,{children:"1"}),(0,n.jsx)(e.mo,{separator:"true",children:","}),(0,n.jsx)(e.mn,{children:"1"}),(0,n.jsx)(e.mo,{stretchy:"false",children:")"})]}),(0,n.jsx)(e.annotation,{encoding:"application/x-tex",children:"(1,1)"})]})})}),(0,n.jsx)(e.span,{className:"katex-html","aria-hidden":"true",children:(0,n.jsxs)(e.span,{className:"base",children:[(0,n.jsx)(e.span,{className:"strut",style:{height:"1em",verticalAlign:"-0.25em"}}),(0,n.jsx)(e.span,{className:"mopen",children:"("}),(0,n.jsx)(e.span,{className:"mord",children:"1"}),(0,n.jsx)(e.span,{className:"mpunct",children:","}),(0,n.jsx)(e.span,{className:"mspace",style:{marginRight:"0.1667em"}}),(0,n.jsx)(e.span,{className:"mord",children:"1"}),(0,n.jsx)(e.span,{className:"mclose",children:")"})]})})]}),". The AUC is ",(0,n.jsxs)(e.span,{className:"katex",children:[(0,n.jsx)(e.span,{className:"katex-mathml",children:(0,n.jsx)(e.math,{xmlns:"http://www.w3.org/1998/Math/MathML",children:(0,n.jsxs)(e.semantics,{children:[(0,n.jsx)(e.mrow,{children:(0,n.jsx)(e.mn,{children:"0.5"})}),(0,n.jsx)(e.annotation,{encoding:"application/x-tex",children:"0.5"})]})})}),(0,n.jsx)(e.span,{className:"katex-html","aria-hidden":"true",children:(0,n.jsxs)(e.span,{className:"base",children:[(0,n.jsx)(e.span,{className:"strut",style:{height:"0.6444em"}}),(0,n.jsx)(e.span,{className:"mord",children:"0.5"})]})})]}),", representing a 50% probability of correctly ranking a random positive and negative example."]}),"\n",(0,n.jsx)(e.p,{children:(0,n.jsx)(e.img,{alt:"My Image",src:a(9732).A+"",width:"2301",height:"634"})}),"\n",(0,n.jsx)(e.h4,{id:"-when-to-use-5",children:"\u27bd When to use?"}),"\n",(0,n.jsx)(e.p,{children:"AUC and ROC work well for comparing models when the dataset is roughly balanced between classes."}),"\n",(0,n.jsx)(e.h4,{id:"-limitations-5",children:"\u27bd Limitations"}),"\n",(0,n.jsx)(e.p,{children:"When the dataset is imbalanced, precision-recall curves (PRCs) and the area under those curves may offer a better comparative visualization of model performance. Precision-recall curves are created by plotting precision on the y-axis and recall on the x-axis across all thresholds."}),"\n",(0,n.jsx)(e.p,{children:(0,n.jsx)(e.img,{alt:"My Image",src:a(95657).A+"",width:"2287",height:"632"})}),"\n",(0,n.jsx)(e.h3,{id:"auc-and-roc-for-choosing-model-and-threshold",children:"AUC and ROC for choosing model and threshold"}),"\n",(0,n.jsx)(e.p,{children:"As we said, AUC is a useful measure for comparing the performance of two different models, as long as the dataset is roughly balanced."}),"\n",(0,n.jsxs)(e.p,{children:["The model with ",(0,n.jsx)(e.strong,{children:"greater area under the curve"})," is generally the ",(0,n.jsx)(e.strong,{children:"better"})," one."]}),"\n",(0,n.jsx)(e.p,{children:(0,n.jsx)(e.img,{alt:"My Image",src:a(26466).A+"",width:"942",height:"337"})}),"\n",(0,n.jsxs)(e.p,{children:["The points on a ROC curve closest to ",(0,n.jsxs)(e.span,{className:"katex",children:[(0,n.jsx)(e.span,{className:"katex-mathml",children:(0,n.jsx)(e.math,{xmlns:"http://www.w3.org/1998/Math/MathML",children:(0,n.jsxs)(e.semantics,{children:[(0,n.jsxs)(e.mrow,{children:[(0,n.jsx)(e.mo,{stretchy:"false",children:"("}),(0,n.jsx)(e.mn,{children:"0"}),(0,n.jsx)(e.mo,{separator:"true",children:","}),(0,n.jsx)(e.mn,{children:"1"}),(0,n.jsx)(e.mo,{stretchy:"false",children:")"})]}),(0,n.jsx)(e.annotation,{encoding:"application/x-tex",children:"(0,1)"})]})})}),(0,n.jsx)(e.span,{className:"katex-html","aria-hidden":"true",children:(0,n.jsxs)(e.span,{className:"base",children:[(0,n.jsx)(e.span,{className:"strut",style:{height:"1em",verticalAlign:"-0.25em"}}),(0,n.jsx)(e.span,{className:"mopen",children:"("}),(0,n.jsx)(e.span,{className:"mord",children:"0"}),(0,n.jsx)(e.span,{className:"mpunct",children:","}),(0,n.jsx)(e.span,{className:"mspace",style:{marginRight:"0.1667em"}}),(0,n.jsx)(e.span,{className:"mord",children:"1"}),(0,n.jsx)(e.span,{className:"mclose",children:")"})]})})]})," represent a range of the best-performing thresholds for the given model. The threshold you choose depends on ",(0,n.jsx)(e.strong,{children:"which metric is most important to the specific use case"}),"."]}),"\n",(0,n.jsxs)(e.p,{children:["Consider the points ",(0,n.jsxs)(e.span,{className:"katex",children:[(0,n.jsx)(e.span,{className:"katex-mathml",children:(0,n.jsx)(e.math,{xmlns:"http://www.w3.org/1998/Math/MathML",children:(0,n.jsxs)(e.semantics,{children:[(0,n.jsx)(e.mrow,{children:(0,n.jsx)(e.mi,{children:"A"})}),(0,n.jsx)(e.annotation,{encoding:"application/x-tex",children:"A"})]})})}),(0,n.jsx)(e.span,{className:"katex-html","aria-hidden":"true",children:(0,n.jsxs)(e.span,{className:"base",children:[(0,n.jsx)(e.span,{className:"strut",style:{height:"0.6833em"}}),(0,n.jsx)(e.span,{className:"mord mathnormal",children:"A"})]})})]}),", ",(0,n.jsxs)(e.span,{className:"katex",children:[(0,n.jsx)(e.span,{className:"katex-mathml",children:(0,n.jsx)(e.math,{xmlns:"http://www.w3.org/1998/Math/MathML",children:(0,n.jsxs)(e.semantics,{children:[(0,n.jsx)(e.mrow,{children:(0,n.jsx)(e.mi,{children:"B"})}),(0,n.jsx)(e.annotation,{encoding:"application/x-tex",children:"B"})]})})}),(0,n.jsx)(e.span,{className:"katex-html","aria-hidden":"true",children:(0,n.jsxs)(e.span,{className:"base",children:[(0,n.jsx)(e.span,{className:"strut",style:{height:"0.6833em"}}),(0,n.jsx)(e.span,{className:"mord mathnormal",style:{marginRight:"0.05017em"},children:"B"})]})})]}),", and ",(0,n.jsxs)(e.span,{className:"katex",children:[(0,n.jsx)(e.span,{className:"katex-mathml",children:(0,n.jsx)(e.math,{xmlns:"http://www.w3.org/1998/Math/MathML",children:(0,n.jsxs)(e.semantics,{children:[(0,n.jsx)(e.mrow,{children:(0,n.jsx)(e.mi,{children:"C"})}),(0,n.jsx)(e.annotation,{encoding:"application/x-tex",children:"C"})]})})}),(0,n.jsx)(e.span,{className:"katex-html","aria-hidden":"true",children:(0,n.jsxs)(e.span,{className:"base",children:[(0,n.jsx)(e.span,{className:"strut",style:{height:"0.6833em"}}),(0,n.jsx)(e.span,{className:"mord mathnormal",style:{marginRight:"0.07153em"},children:"C"})]})})]})," in the following diagram, each representing a threshold:"]}),"\n",(0,n.jsx)(e.p,{children:(0,n.jsx)(e.img,{alt:"My Image",src:a(98286).A+"",width:"2320",height:"663"})}),"\n",(0,n.jsxs)(e.ul,{children:["\n",(0,n.jsxs)(e.li,{children:["\n",(0,n.jsxs)(e.p,{children:["If ",(0,n.jsx)(e.strong,{children:"false positives"})," (false alarms) are ",(0,n.jsx)(e.strong,{children:"highly costly"}),", it may make sense to choose a threshold that gives a lower FPR, like the one at point ",(0,n.jsxs)(e.span,{className:"katex",children:[(0,n.jsx)(e.span,{className:"katex-mathml",children:(0,n.jsx)(e.math,{xmlns:"http://www.w3.org/1998/Math/MathML",children:(0,n.jsxs)(e.semantics,{children:[(0,n.jsx)(e.mrow,{children:(0,n.jsx)(e.mi,{children:"A"})}),(0,n.jsx)(e.annotation,{encoding:"application/x-tex",children:"A"})]})})}),(0,n.jsx)(e.span,{className:"katex-html","aria-hidden":"true",children:(0,n.jsxs)(e.span,{className:"base",children:[(0,n.jsx)(e.span,{className:"strut",style:{height:"0.6833em"}}),(0,n.jsx)(e.span,{className:"mord mathnormal",children:"A"})]})})]}),", even if TPR is reduced."]}),"\n"]}),"\n",(0,n.jsxs)(e.li,{children:["\n",(0,n.jsxs)(e.p,{children:["If ",(0,n.jsx)(e.strong,{children:"false positives"})," are ",(0,n.jsx)(e.strong,{children:"cheap"})," and ",(0,n.jsx)(e.strong,{children:"false negatives"})," (missed true positives) ",(0,n.jsx)(e.strong,{children:"highly costly"}),", the threshold for point ",(0,n.jsxs)(e.span,{className:"katex",children:[(0,n.jsx)(e.span,{className:"katex-mathml",children:(0,n.jsx)(e.math,{xmlns:"http://www.w3.org/1998/Math/MathML",children:(0,n.jsxs)(e.semantics,{children:[(0,n.jsx)(e.mrow,{children:(0,n.jsx)(e.mi,{children:"C"})}),(0,n.jsx)(e.annotation,{encoding:"application/x-tex",children:"C"})]})})}),(0,n.jsx)(e.span,{className:"katex-html","aria-hidden":"true",children:(0,n.jsxs)(e.span,{className:"base",children:[(0,n.jsx)(e.span,{className:"strut",style:{height:"0.6833em"}}),(0,n.jsx)(e.span,{className:"mord mathnormal",style:{marginRight:"0.07153em"},children:"C"})]})})]}),", which maximizes TPR, may be preferable."]}),"\n"]}),"\n",(0,n.jsxs)(e.li,{children:["\n",(0,n.jsxs)(e.p,{children:["If the costs are roughly ",(0,n.jsx)(e.strong,{children:"equivalent"}),", point ",(0,n.jsxs)(e.span,{className:"katex",children:[(0,n.jsx)(e.span,{className:"katex-mathml",children:(0,n.jsx)(e.math,{xmlns:"http://www.w3.org/1998/Math/MathML",children:(0,n.jsxs)(e.semantics,{children:[(0,n.jsx)(e.mrow,{children:(0,n.jsx)(e.mi,{children:"B"})}),(0,n.jsx)(e.annotation,{encoding:"application/x-tex",children:"B"})]})})}),(0,n.jsx)(e.span,{className:"katex-html","aria-hidden":"true",children:(0,n.jsxs)(e.span,{className:"base",children:[(0,n.jsx)(e.span,{className:"strut",style:{height:"0.6833em"}}),(0,n.jsx)(e.span,{className:"mord mathnormal",style:{marginRight:"0.05017em"},children:"B"})]})})]})," may offer the best balance between TPR and FPR."]}),"\n"]}),"\n"]}),"\n",(0,n.jsx)(e.h4,{id:"-example",children:"\u27bd Example"}),"\n",(0,n.jsx)(e.p,{children:(0,n.jsx)(e.img,{alt:"My Image",src:a(10124).A+"",width:"858",height:"774"})}),"\n",(0,n.jsxs)(e.h2,{id:"5\ufe0f\u20e3-prediction-bias",children:["5\ufe0f\u20e3 ",(0,n.jsx)(e.strong,{children:"Prediction bias"})]}),"\n",(0,n.jsx)(e.h3,{id:"introduction",children:"Introduction"}),"\n",(0,n.jsxs)(e.p,{children:["Prediction bias is an important diagnostic metric for evaluating machine learning models. It represents the ",(0,n.jsx)(e.strong,{children:"difference"})," between the ",(0,n.jsx)(e.strong,{children:"average of a model's predictions"})," and the ",(0,n.jsx)(e.strong,{children:"average of the actual ground-truth labels"})," in the dataset."]}),"\n",(0,n.jsx)(e.p,{children:"Prediction bias occurs when a model's predictions systematically deviate from the actual values in the dataset. Mathematically, it is calculated as:"}),"\n",(0,n.jsx)(e.span,{className:"katex-display",children:(0,n.jsxs)(e.span,{className:"katex",children:[(0,n.jsx)(e.span,{className:"katex-mathml",children:(0,n.jsx)(e.math,{xmlns:"http://www.w3.org/1998/Math/MathML",display:"block",children:(0,n.jsxs)(e.semantics,{children:[(0,n.jsxs)(e.mrow,{children:[(0,n.jsx)(e.mtext,{children:"Prediction\xa0Bias"}),(0,n.jsx)(e.mo,{children:"="}),(0,n.jsx)(e.mi,{children:"A"}),(0,n.jsx)(e.mi,{children:"v"}),(0,n.jsx)(e.mi,{children:"e"}),(0,n.jsx)(e.mi,{children:"r"}),(0,n.jsx)(e.mi,{children:"a"}),(0,n.jsx)(e.mi,{children:"g"}),(0,n.jsx)(e.mi,{children:"e"}),(0,n.jsx)(e.mo,{stretchy:"false",children:"("}),(0,n.jsx)(e.mtext,{children:"Predictions"}),(0,n.jsx)(e.mo,{stretchy:"false",children:")"}),(0,n.jsx)(e.mo,{children:"\u2212"}),(0,n.jsx)(e.mi,{children:"A"}),(0,n.jsx)(e.mi,{children:"v"}),(0,n.jsx)(e.mi,{children:"e"}),(0,n.jsx)(e.mi,{children:"r"}),(0,n.jsx)(e.mi,{children:"a"}),(0,n.jsx)(e.mi,{children:"g"}),(0,n.jsx)(e.mi,{children:"e"}),(0,n.jsx)(e.mo,{stretchy:"false",children:"("}),(0,n.jsx)(e.mtext,{children:"Ground\xa0Truth\xa0Labels"}),(0,n.jsx)(e.mo,{stretchy:"false",children:")"})]}),(0,n.jsx)(e.annotation,{encoding:"application/x-tex",children:"\\text{Prediction Bias} = Average(\\text{Predictions}) - Average(\\text{Ground Truth Labels})"})]})})}),(0,n.jsxs)(e.span,{className:"katex-html","aria-hidden":"true",children:[(0,n.jsxs)(e.span,{className:"base",children:[(0,n.jsx)(e.span,{className:"strut",style:{height:"0.6944em"}}),(0,n.jsx)(e.span,{className:"mord text",children:(0,n.jsx)(e.span,{className:"mord",children:"Prediction\xa0Bias"})}),(0,n.jsx)(e.span,{className:"mspace",style:{marginRight:"0.2778em"}}),(0,n.jsx)(e.span,{className:"mrel",children:"="}),(0,n.jsx)(e.span,{className:"mspace",style:{marginRight:"0.2778em"}})]}),(0,n.jsxs)(e.span,{className:"base",children:[(0,n.jsx)(e.span,{className:"strut",style:{height:"1em",verticalAlign:"-0.25em"}}),(0,n.jsx)(e.span,{className:"mord mathnormal",children:"A"}),(0,n.jsx)(e.span,{className:"mord mathnormal",style:{marginRight:"0.03588em"},children:"v"}),(0,n.jsx)(e.span,{className:"mord mathnormal",style:{marginRight:"0.02778em"},children:"er"}),(0,n.jsx)(e.span,{className:"mord mathnormal",children:"a"}),(0,n.jsx)(e.span,{className:"mord mathnormal",style:{marginRight:"0.03588em"},children:"g"}),(0,n.jsx)(e.span,{className:"mord mathnormal",children:"e"}),(0,n.jsx)(e.span,{className:"mopen",children:"("}),(0,n.jsx)(e.span,{className:"mord text",children:(0,n.jsx)(e.span,{className:"mord",children:"Predictions"})}),(0,n.jsx)(e.span,{className:"mclose",children:")"}),(0,n.jsx)(e.span,{className:"mspace",style:{marginRight:"0.2222em"}}),(0,n.jsx)(e.span,{className:"mbin",children:"\u2212"}),(0,n.jsx)(e.span,{className:"mspace",style:{marginRight:"0.2222em"}})]}),(0,n.jsxs)(e.span,{className:"base",children:[(0,n.jsx)(e.span,{className:"strut",style:{height:"1em",verticalAlign:"-0.25em"}}),(0,n.jsx)(e.span,{className:"mord mathnormal",children:"A"}),(0,n.jsx)(e.span,{className:"mord mathnormal",style:{marginRight:"0.03588em"},children:"v"}),(0,n.jsx)(e.span,{className:"mord mathnormal",style:{marginRight:"0.02778em"},children:"er"}),(0,n.jsx)(e.span,{className:"mord mathnormal",children:"a"}),(0,n.jsx)(e.span,{className:"mord mathnormal",style:{marginRight:"0.03588em"},children:"g"}),(0,n.jsx)(e.span,{className:"mord mathnormal",children:"e"}),(0,n.jsx)(e.span,{className:"mopen",children:"("}),(0,n.jsx)(e.span,{className:"mord text",children:(0,n.jsx)(e.span,{className:"mord",children:"Ground\xa0Truth\xa0Labels"})}),(0,n.jsx)(e.span,{className:"mclose",children:")"})]})]})]})}),"\n",(0,n.jsx)(e.p,{children:"For example, if a dataset contains 5% spam emails, an unbiased model should predict, on average, that 5% of emails are spam. If the model instead predicts that 10% of emails are spam, it has a prediction bias of +5%."}),"\n",(0,n.jsx)(e.h3,{id:"significance-of-prediction-bias",children:"Significance of Prediction Bias"}),"\n",(0,n.jsx)(e.p,{children:"Prediction bias serves as an early warning system for model issues. A significant bias indicates that:"}),"\n",(0,n.jsxs)(e.ul,{children:["\n",(0,n.jsx)(e.li,{children:"The model is not accurately representing the underlying data distribution"}),"\n",(0,n.jsx)(e.li,{children:"There may be fundamental problems with the model architecture or training process"}),"\n",(0,n.jsx)(e.li,{children:"The model might perform poorly on new, unseen data"}),"\n"]}),"\n",(0,n.jsx)(e.p,{children:"It's important to note that even a model with zero prediction bias can still have other problems, such as poor precision or recall for specific classes."}),"\n",(0,n.jsx)(e.h3,{id:"common-causes-of-prediction-bias",children:"Common Causes of Prediction Bias"}),"\n",(0,n.jsx)(e.h4,{id:"-data-issues",children:"\u27bd Data Issues"}),"\n",(0,n.jsxs)(e.ul,{children:["\n",(0,n.jsxs)(e.li,{children:[(0,n.jsx)(e.strong,{children:"Biased sampling"}),(0,n.jsx)(e.br,{}),"\n","Training data that doesn't represent the true distribution of the target population"]}),"\n",(0,n.jsxs)(e.li,{children:[(0,n.jsx)(e.strong,{children:"Data noise"}),(0,n.jsx)(e.br,{}),"\n","Errors or inconsistencies in the ground truth labels"]}),"\n",(0,n.jsxs)(e.li,{children:[(0,n.jsx)(e.strong,{children:"Dataset shift"}),(0,n.jsx)(e.br,{}),"\n","Differences between training and evaluation datasets"]}),"\n"]}),"\n",(0,n.jsx)(e.h4,{id:"-model-issues",children:"\u27bd Model Issues"}),"\n",(0,n.jsxs)(e.ul,{children:["\n",(0,n.jsxs)(e.li,{children:[(0,n.jsx)(e.strong,{children:"Excessive regularization"}),(0,n.jsx)(e.br,{}),"\n","Over-constraining the model, causing it to lose necessary complexity"]}),"\n",(0,n.jsxs)(e.li,{children:[(0,n.jsx)(e.strong,{children:"Insufficient model capacity"}),(0,n.jsx)(e.br,{}),"\n","Model architecture that's too simple for the problem"]}),"\n",(0,n.jsxs)(e.li,{children:[(0,n.jsx)(e.strong,{children:"Inappropriate loss function"}),(0,n.jsx)(e.br,{}),"\n","Using a loss function that doesn't properly penalize bias"]}),"\n"]}),"\n",(0,n.jsx)(e.h4,{id:"-feature-issues",children:"\u27bd Feature Issues"}),"\n",(0,n.jsxs)(e.ul,{children:["\n",(0,n.jsxs)(e.li,{children:[(0,n.jsx)(e.strong,{children:"Insufficient features"}),(0,n.jsx)(e.br,{}),"\n","Missing important predictive variables"]}),"\n",(0,n.jsxs)(e.li,{children:[(0,n.jsx)(e.strong,{children:"Feature distribution issues"}),(0,n.jsx)(e.br,{}),"\n","Features that behave differently in training versus inference"]}),"\n"]}),"\n",(0,n.jsx)(e.h4,{id:"-pipeline-issues",children:"\u27bd Pipeline Issues"}),"\n",(0,n.jsxs)(e.ul,{children:["\n",(0,n.jsxs)(e.li,{children:[(0,n.jsx)(e.strong,{children:"Bugs in preprocessing"}),(0,n.jsx)(e.br,{}),"\n","Errors in how data is transformed before model training"]}),"\n",(0,n.jsxs)(e.li,{children:[(0,n.jsx)(e.strong,{children:"Incorrect evaluation"}),(0,n.jsx)(e.br,{}),"\n","Problems with how model performance is assessed"]}),"\n"]}),"\n",(0,n.jsxs)(e.h2,{id:"6\ufe0f\u20e3-multi-class-classification",children:["6\ufe0f\u20e3 ",(0,n.jsx)(e.strong,{children:"Multi-class classification"})]}),"\n",(0,n.jsx)(e.admonition,{title:"Definition",type:"info",children:(0,n.jsx)(e.p,{children:"Multi-class classification is a machine learning task where the goal is to categorize examples into one of three or more classes."})}),"\n",(0,n.jsxs)(e.p,{children:["It can be treated as an ",(0,n.jsx)(e.strong,{children:"extension"})," of binary classification to more than two classes. If each example can only be assigned to one class, then the classification problem can be handled as a binary classification problem, where one class contains one of the multiple classes, and the other class contains all the other classes put together. The process can then be repeated for each of the original classes."]}),"\n",(0,n.jsxs)(e.admonition,{title:"Digit Recognition",type:"tip",children:[(0,n.jsx)(e.p,{children:"A classic example of multi-class classification is handwritten digit recognition:"}),(0,n.jsxs)(e.ul,{children:["\n",(0,n.jsx)(e.li,{children:"Input: Image of a handwritten digit"}),"\n",(0,n.jsx)(e.li,{children:"Output: Classification into one of 10 classes (digits 0-9)"}),"\n",(0,n.jsx)(e.li,{children:"Each image belongs to exactly one class"}),"\n",(0,n.jsx)(e.li,{children:"Models must learn features that distinguish between all ten digits"}),"\n"]})]}),"\n",(0,n.jsx)(e.p,{children:(0,n.jsx)(e.em,{children:"Note: we will explore this topic in more depth in future modules."})}),"\n",(0,n.jsxs)(e.h2,{id:"-coding-time",children:["\ud83d\udcbb ",(0,n.jsx)(e.strong,{children:"Coding Time!"})]}),"\n",(0,n.jsxs)(e.p,{children:["Here's the link to the interactive ",(0,n.jsx)(e.a,{href:"https://colab.research.google.com/github/google/eng-edu/blob/main/ml/cc/exercises/binary_classification_rice.ipynb",children:"Google Colab notebook"}),"."]}),"\n",(0,n.jsx)(e.p,{children:"We just report here the most important insights."}),"\n",(0,n.jsx)(e.h3,{id:"logistic-regression-in-keras",children:"Logistic Regression in Keras"}),"\n",(0,n.jsx)(e.pre,{children:(0,n.jsx)(e.code,{className:"language-python",children:"import tensorflow as tf\nfrom tensorflow import keras\n\ndef create_logistic_regression_model(\n    input_features: list[str],\n    learning_rate: float,\n    metrics: list[keras.metrics.Metric]\n) -> keras.Model:\n    \"\"\"\n    Creates and compiles a simple single-layer neural network for binary \n    classification, equivalent to logistic regression.\n\n    Args:\n        input_features (list[str]): A list of feature names. Each feature\n            corresponds to one scalar input.\n        learning_rate (float): Learning rate for the optimizer.\n        metrics (list[keras.metrics.Metric]): List of metric instances to track.\n\n    Returns:\n        keras.Model: A compiled Keras model representing logistic regression.\n    \"\"\"\n\n    # --------------------------------------------------------------------------\n    # 1. Define the Inputs\n    # Here, we create one Keras Input for each feature. Each input is a scalar \n    # (shape=(1,)) because logistic regression expects numeric features that \n    # can be fed into a linear combination.\n    # --------------------------------------------------------------------------\n    model_inputs = [\n        keras.Input(name=feature, shape=(1,))\n        for feature in input_features\n    ]\n\n    # --------------------------------------------------------------------------\n    # 2. Concatenate the Inputs\n    # We merge all separate input tensors into a single tensor using the \n    # Concatenate layer. This single tensor will be fed into our Dense layer \n    # (the logistic regression layer).\n    # --------------------------------------------------------------------------\n    concatenated_inputs = keras.layers.Concatenate()(model_inputs)\n\n    # --------------------------------------------------------------------------\n    # 3. Single Dense Layer with Sigmoid Activation\n    # A logistic regression model can be viewed as:\n    #   y = sigmoid(W^T x + b)\n    # where x is the input (in this case, the concatenated features), and\n    # W and b are learnable parameters.\n    # \n    # In Keras:\n    #   - units=1: we only need a single output value (the probability of \n    #     belonging to the positive class).\n    #   - activation='sigmoid': applies the logistic function, transforming \n    #     the linear combination into a probability between 0 and 1.\n    # --------------------------------------------------------------------------\n    model_output = keras.layers.Dense(\n        units=1,\n        activation='sigmoid',  # logistic activation\n        name='logistic_regression_output'\n    )(concatenated_inputs)\n\n    # --------------------------------------------------------------------------\n    # 4. Create the Keras Model\n    # We define a Keras Model by specifying the inputs and the output. \n    # --------------------------------------------------------------------------\n    model = keras.Model(inputs=model_inputs, outputs=model_output)\n\n    # --------------------------------------------------------------------------\n    # 5. Compile the Model\n    # - We use BinaryCrossentropy as the loss function for binary classification.\n    # - RMSprop is the chosen optimizer here, although many optimizers \n    #   (e.g. Adam, SGD) could also be used.\n    # - We pass in any additional metrics we want to track.\n    # --------------------------------------------------------------------------\n    model.compile(\n        optimizer=keras.optimizers.RMSprop(learning_rate),\n        loss=keras.losses.BinaryCrossentropy(),\n        metrics=metrics,\n    )\n\n    return model\n"})})]})}function d(s={}){const{wrapper:e}={...(0,i.R)(),...s.components};return e?(0,n.jsx)(e,{...s,children:(0,n.jsx)(m,{...s})}):m(s)}},9732:(s,e,a)=>{a.d(e,{A:()=>n});const n=a.p+"assets/images/auc_0-5-1db15077265c794ffdda66696a805fbe.png"},26466:(s,e,a)=>{a.d(e,{A:()=>n});const n=a.p+"assets/images/auc_0-65-dcf9fc43817add4deb1f0199181ac2f8.png"},81252:(s,e,a)=>{a.d(e,{A:()=>n});const n=a.p+"assets/images/auc_1-0-62a6acbef20c71a427744b7fec9fbed9.png"},98286:(s,e,a)=>{a.d(e,{A:()=>n});const n=a.p+"assets/images/auc_abc-b80339cdcae18d475c57d5f5b1caab6a.png"},10124:(s,e,a)=>{a.d(e,{A:()=>n});const n=a.p+"assets/images/auc_example-dcd1b7e6dc33803a8f44eff0aa0887fd.png"},95755:(s,e,a)=>{a.d(e,{A:()=>n});const n=a.p+"assets/images/cf-00e3a6cc9aa1681343e5931f7eafaea0.png"},95657:(s,e,a)=>{a.d(e,{A:()=>n});const n=a.p+"assets/images/prauc-41775145ce3c1800ec4453e83234dd6b.png"},28453:(s,e,a)=>{a.d(e,{R:()=>t,x:()=>r});var n=a(96540);const i={},l=n.createContext(i);function t(s){const e=n.useContext(l);return n.useMemo((function(){return"function"==typeof s?s(e):{...e,...s}}),[e,s])}function r(s){let e;return e=s.disableParentContext?"function"==typeof s.components?s.components(i):s.components||i:t(s.components),n.createElement(l.Provider,{value:e},s.children)}}}]);