<!doctype html>
<html lang="en" dir="ltr" class="docs-wrapper plugin-docs plugin-id-default docs-version-current docs-doc-page docs-doc-id-notes/Information Technology/Artificial Intelligence/👨🏻‍🏫 Google - 02 - ML/google-2-unit-3" data-has-hydrated="false">
<head>
<meta charset="UTF-8">
<meta name="generator" content="Docusaurus v3.5.2">
<title data-rh="true">📖 Classification | MindMash</title><meta data-rh="true" name="viewport" content="width=device-width,initial-scale=1"><meta data-rh="true" name="twitter:card" content="summary_large_image"><meta data-rh="true" property="og:image" content="https://github.com/MindMash/img/docusaurus-social-card.jpg"><meta data-rh="true" name="twitter:image" content="https://github.com/MindMash/img/docusaurus-social-card.jpg"><meta data-rh="true" property="og:url" content="https://github.com/MindMash/docs/notes/Information Technology/Artificial Intelligence/👨🏻‍🏫 Google - 02 - ML/google-2-unit-3"><meta data-rh="true" property="og:locale" content="en"><meta data-rh="true" name="docusaurus_locale" content="en"><meta data-rh="true" name="docsearch:language" content="en"><meta data-rh="true" name="docusaurus_version" content="current"><meta data-rh="true" name="docusaurus_tag" content="docs-default-current"><meta data-rh="true" name="docsearch:version" content="current"><meta data-rh="true" name="docsearch:docusaurus_tag" content="docs-default-current"><meta data-rh="true" property="og:title" content="📖 Classification | MindMash"><meta data-rh="true" name="description" content="➡️ Useful Materials"><meta data-rh="true" property="og:description" content="➡️ Useful Materials"><link data-rh="true" rel="icon" href="/MindMash/img/planet-earth.png"><link data-rh="true" rel="canonical" href="https://github.com/MindMash/docs/notes/Information Technology/Artificial Intelligence/👨🏻‍🏫 Google - 02 - ML/google-2-unit-3"><link data-rh="true" rel="alternate" href="https://github.com/MindMash/docs/notes/Information Technology/Artificial Intelligence/👨🏻‍🏫 Google - 02 - ML/google-2-unit-3" hreflang="en"><link data-rh="true" rel="alternate" href="https://github.com/MindMash/docs/notes/Information Technology/Artificial Intelligence/👨🏻‍🏫 Google - 02 - ML/google-2-unit-3" hreflang="x-default"><link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/katex@0.13.24/dist/katex.min.css" integrity="sha384-odtC+0UGzzFL/6PNoE8rX/SPcQDXBJ+uRepguP4QkPCm2LBxH3FA3y+fKSiJ+AmM" crossorigin="anonymous"><link rel="stylesheet" href="/MindMash/assets/css/styles.840d84ac.css">
<script src="/MindMash/assets/js/runtime~main.dce65f8d.js" defer="defer"></script>
<script src="/MindMash/assets/js/main.1e46c6d1.js" defer="defer"></script>
</head>
<body class="navigation-with-keyboard">
<script>!function(){function t(t){document.documentElement.setAttribute("data-theme",t)}var e=function(){try{return new URLSearchParams(window.location.search).get("docusaurus-theme")}catch(t){}}()||function(){try{return window.localStorage.getItem("theme")}catch(t){}}();t(null!==e?e:"light")}(),function(){try{const n=new URLSearchParams(window.location.search).entries();for(var[t,e]of n)if(t.startsWith("docusaurus-data-")){var a=t.replace("docusaurus-data-","data-");document.documentElement.setAttribute(a,e)}}catch(t){}}()</script><div id="__docusaurus"><div role="region" aria-label="Skip to main content"><a class="skipToContent_fXgn" href="#__docusaurus_skipToContent_fallback">Skip to main content</a></div><nav aria-label="Main" class="navbar navbar--fixed-top"><div class="navbar__inner"><div class="navbar__items"><button aria-label="Toggle navigation bar" aria-expanded="false" class="navbar__toggle clean-btn" type="button"><svg width="30" height="30" viewBox="0 0 30 30" aria-hidden="true"><path stroke="currentColor" stroke-linecap="round" stroke-miterlimit="10" stroke-width="2" d="M4 7h22M4 15h22M4 23h22"></path></svg></button><a class="navbar__brand" href="/MindMash/"><div class="navbar__logo"><img src="/MindMash/img/logo.svg" alt="MindMash Logo" class="themedComponent_mlkZ themedComponent--light_NVdE"><img src="/MindMash/img/logo.svg" alt="MindMash Logo" class="themedComponent_mlkZ themedComponent--dark_xIcU"></div><b class="navbar__title text--truncate">MindMash</b></a><a aria-current="page" class="navbar__item navbar__link navbar__link--active" href="/MindMash/docs/notes/intro">Notes</a><a class="navbar__item navbar__link" href="/MindMash/docs/tracking/intro">Tracking</a><a class="navbar__item navbar__link" href="/MindMash/docs/private/intro-private">Private</a></div><div class="navbar__items navbar__items--right"><a href="https://github.com/DanielePassabi" target="_blank" rel="noopener noreferrer" class="navbar__item navbar__link">GitHub<svg width="13.5" height="13.5" aria-hidden="true" viewBox="0 0 24 24" class="iconExternalLink_nPIU"><path fill="currentColor" d="M21 13v10h-21v-19h12v2h-10v15h17v-8h2zm3-12h-10.988l4.035 4-6.977 7.07 2.828 2.828 6.977-7.07 4.125 4.172v-11z"></path></svg></a><div class="toggle_vylO colorModeToggle_DEke"><button class="clean-btn toggleButton_gllP toggleButtonDisabled_aARS" type="button" disabled="" title="Switch between dark and light mode (currently light mode)" aria-label="Switch between dark and light mode (currently light mode)" aria-live="polite"><svg viewBox="0 0 24 24" width="24" height="24" class="lightToggleIcon_pyhR"><path fill="currentColor" d="M12,9c1.65,0,3,1.35,3,3s-1.35,3-3,3s-3-1.35-3-3S10.35,9,12,9 M12,7c-2.76,0-5,2.24-5,5s2.24,5,5,5s5-2.24,5-5 S14.76,7,12,7L12,7z M2,13l2,0c0.55,0,1-0.45,1-1s-0.45-1-1-1l-2,0c-0.55,0-1,0.45-1,1S1.45,13,2,13z M20,13l2,0c0.55,0,1-0.45,1-1 s-0.45-1-1-1l-2,0c-0.55,0-1,0.45-1,1S19.45,13,20,13z M11,2v2c0,0.55,0.45,1,1,1s1-0.45,1-1V2c0-0.55-0.45-1-1-1S11,1.45,11,2z M11,20v2c0,0.55,0.45,1,1,1s1-0.45,1-1v-2c0-0.55-0.45-1-1-1C11.45,19,11,19.45,11,20z M5.99,4.58c-0.39-0.39-1.03-0.39-1.41,0 c-0.39,0.39-0.39,1.03,0,1.41l1.06,1.06c0.39,0.39,1.03,0.39,1.41,0s0.39-1.03,0-1.41L5.99,4.58z M18.36,16.95 c-0.39-0.39-1.03-0.39-1.41,0c-0.39,0.39-0.39,1.03,0,1.41l1.06,1.06c0.39,0.39,1.03,0.39,1.41,0c0.39-0.39,0.39-1.03,0-1.41 L18.36,16.95z M19.42,5.99c0.39-0.39,0.39-1.03,0-1.41c-0.39-0.39-1.03-0.39-1.41,0l-1.06,1.06c-0.39,0.39-0.39,1.03,0,1.41 s1.03,0.39,1.41,0L19.42,5.99z M7.05,18.36c0.39-0.39,0.39-1.03,0-1.41c-0.39-0.39-1.03-0.39-1.41,0l-1.06,1.06 c-0.39,0.39-0.39,1.03,0,1.41s1.03,0.39,1.41,0L7.05,18.36z"></path></svg><svg viewBox="0 0 24 24" width="24" height="24" class="darkToggleIcon_wfgR"><path fill="currentColor" d="M9.37,5.51C9.19,6.15,9.1,6.82,9.1,7.5c0,4.08,3.32,7.4,7.4,7.4c0.68,0,1.35-0.09,1.99-0.27C17.45,17.19,14.93,19,12,19 c-3.86,0-7-3.14-7-7C5,9.07,6.81,6.55,9.37,5.51z M12,3c-4.97,0-9,4.03-9,9s4.03,9,9,9s9-4.03,9-9c0-0.46-0.04-0.92-0.1-1.36 c-0.98,1.37-2.58,2.26-4.4,2.26c-2.98,0-5.4-2.42-5.4-5.4c0-1.81,0.89-3.42,2.26-4.4C12.92,3.04,12.46,3,12,3L12,3z"></path></svg></button></div><div class="navbarSearchContainer_Bca1"></div></div></div><div role="presentation" class="navbar-sidebar__backdrop"></div></nav><div id="__docusaurus_skipToContent_fallback" class="main-wrapper mainWrapper_z2l0"><div class="docsWrapper_hBAB"><button aria-label="Scroll back to top" class="clean-btn theme-back-to-top-button backToTopButton_sjWU" type="button"></button><div class="docRoot_UBD9"><aside class="theme-doc-sidebar-container docSidebarContainer_YfHR"><div class="sidebarViewport_aRkj"><div class="sidebar_njMd"><nav aria-label="Docs sidebar" class="menu thin-scrollbar menu_SIkG"><ul class="theme-doc-sidebar-menu menu__list"><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-1 menu__list-item"><a class="menu__link" href="/MindMash/docs/notes/intro">Introduction to Notes</a></li><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-1 menu__list-item menu__list-item--collapsed"><div class="menu__list-item-collapsible"><a class="menu__link menu__link--sublist menu__link--sublist-caret" role="button" aria-expanded="false" href="/MindMash/docs/notes/Economics and Finance/economia-e-finanza-01">Economics and Finance</a></div></li><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-1 menu__list-item menu__list-item--collapsed"><div class="menu__list-item-collapsible"><a class="menu__link menu__link--sublist menu__link--sublist-caret" role="button" aria-expanded="false" href="/MindMash/docs/notes/Gym/Consigli Trainer/gym-trainer-insights-03">Gym</a></div></li><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-1 menu__list-item"><div class="menu__list-item-collapsible"><a class="menu__link menu__link--sublist menu__link--sublist-caret menu__link--active" role="button" aria-expanded="true" href="/MindMash/docs/notes/Information Technology/Artificial Intelligence/general-0">Information Technology</a></div><ul style="display:block;overflow:visible;height:auto" class="menu__list"><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-2 menu__list-item"><div class="menu__list-item-collapsible"><a class="menu__link menu__link--sublist menu__link--sublist-caret menu__link--active" role="button" aria-expanded="true" tabindex="0" href="/MindMash/docs/notes/Information Technology/Artificial Intelligence/general-0">Artificial Intelligence</a></div><ul style="display:block;overflow:visible;height:auto" class="menu__list"><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-3 menu__list-item"><a class="menu__link" tabindex="0" href="/MindMash/docs/notes/Information Technology/Artificial Intelligence/general-0">🔡 Glossary</a></li><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-3 menu__list-item menu__list-item--collapsed"><div class="menu__list-item-collapsible"><a class="menu__link menu__link--sublist menu__link--sublist-caret" role="button" aria-expanded="false" tabindex="0" href="/MindMash/docs/notes/Information Technology/Artificial Intelligence/LLMs/llms-1">LLMs</a></div></li><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-3 menu__list-item menu__list-item--collapsed"><div class="menu__list-item-collapsible"><a class="menu__link menu__link--sublist menu__link--sublist-caret" role="button" aria-expanded="false" tabindex="0" href="/MindMash/docs/notes/Information Technology/Artificial Intelligence/👨🏻‍🏫 Google - 01 - Intro to ML/google-unit-1">👨🏻‍🏫 Google - 01 - Intro to ML</a></div></li><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-3 menu__list-item"><div class="menu__list-item-collapsible"><a class="menu__link menu__link--sublist menu__link--sublist-caret menu__link--active" role="button" aria-expanded="true" tabindex="0" href="/MindMash/docs/notes/Information Technology/Artificial Intelligence/👨🏻‍🏫 Google - 02 - ML/google-2-unit-1">👨🏻‍🏫 Google - 02 - ML</a></div><ul style="display:block;overflow:visible;height:auto" class="menu__list"><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-4 menu__list-item"><a class="menu__link" tabindex="0" href="/MindMash/docs/notes/Information Technology/Artificial Intelligence/👨🏻‍🏫 Google - 02 - ML/google-2-unit-1">📖 Linear Regression</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-4 menu__list-item"><a class="menu__link" tabindex="0" href="/MindMash/docs/notes/Information Technology/Artificial Intelligence/👨🏻‍🏫 Google - 02 - ML/google-2-unit-addtional-1">📖 Gradient Descent</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-4 menu__list-item"><a class="menu__link" tabindex="0" href="/MindMash/docs/notes/Information Technology/Artificial Intelligence/👨🏻‍🏫 Google - 02 - ML/google-2-unit-2">📖 Logistic Regression</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-4 menu__list-item"><a class="menu__link menu__link--active" aria-current="page" tabindex="0" href="/MindMash/docs/notes/Information Technology/Artificial Intelligence/👨🏻‍🏫 Google - 02 - ML/google-2-unit-3">📖 Classification</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-4 menu__list-item"><a class="menu__link" tabindex="0" href="/MindMash/docs/notes/Information Technology/Artificial Intelligence/👨🏻‍🏫 Google - 02 - ML/google-2-unit-4">📖 Numerical Data</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-4 menu__list-item"><a class="menu__link" tabindex="0" href="/MindMash/docs/notes/Information Technology/Artificial Intelligence/👨🏻‍🏫 Google - 02 - ML/google-2-unit-5">📖 Categorical Data</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-4 menu__list-item"><a class="menu__link" tabindex="0" href="/MindMash/docs/notes/Information Technology/Artificial Intelligence/👨🏻‍🏫 Google - 02 - ML/google-2-unit-6">📖 Datasets, Generalization, and Overfitting</a></li></ul></li><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-3 menu__list-item menu__list-item--collapsed"><div class="menu__list-item-collapsible"><a class="menu__link menu__link--sublist menu__link--sublist-caret" role="button" aria-expanded="false" tabindex="0" href="/MindMash/docs/notes/Information Technology/Artificial Intelligence/👨🏻‍🏫 HuggingFace - Agents/hf-unit-1">👨🏻‍🏫 HuggingFace - Agents</a></div></li><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-3 menu__list-item menu__list-item--collapsed"><div class="menu__list-item-collapsible"><a class="menu__link menu__link--sublist menu__link--sublist-caret" role="button" aria-expanded="false" tabindex="0" href="/MindMash/docs/notes/Information Technology/Artificial Intelligence/🗃️ Unsorted Notes/ai-01">🗃️ Unsorted Notes</a></div></li></ul></li><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-2 menu__list-item menu__list-item--collapsed"><div class="menu__list-item-collapsible"><a class="menu__link menu__link--sublist menu__link--sublist-caret" role="button" aria-expanded="false" tabindex="0" href="/MindMash/docs/notes/Information Technology/Python/python-01">Python</a></div></li><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-2 menu__list-item menu__list-item--collapsed"><div class="menu__list-item-collapsible"><a class="menu__link menu__link--sublist menu__link--sublist-caret" role="button" aria-expanded="false" tabindex="0" href="/MindMash/docs/notes/Information Technology/Web Development/wd-intro">Web Development</a></div></li></ul></li><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-1 menu__list-item menu__list-item--collapsed"><div class="menu__list-item-collapsible"><a class="menu__link menu__link--sublist menu__link--sublist-caret" role="button" aria-expanded="false" href="/MindMash/docs/notes/Italian Literature/il-intro">Italian Literature</a></div></li></ul></nav></div></div></aside><main class="docMainContainer_TBSr"><div class="container padding-top--md padding-bottom--lg"><div class="row"><div class="col docItemCol_VOVn"><div class="docItemContainer_Djhp"><article><nav class="theme-doc-breadcrumbs breadcrumbsContainer_Z_bl" aria-label="Breadcrumbs"><ul class="breadcrumbs" itemscope="" itemtype="https://schema.org/BreadcrumbList"><li class="breadcrumbs__item"><a aria-label="Home page" class="breadcrumbs__link" href="/MindMash/"><svg viewBox="0 0 24 24" class="breadcrumbHomeIcon_YNFT"><path d="M10 19v-5h4v5c0 .55.45 1 1 1h3c.55 0 1-.45 1-1v-7h1.7c.46 0 .68-.57.33-.87L12.67 3.6c-.38-.34-.96-.34-1.34 0l-8.36 7.53c-.34.3-.13.87.33.87H5v7c0 .55.45 1 1 1h3c.55 0 1-.45 1-1z" fill="currentColor"></path></svg></a></li><li class="breadcrumbs__item"><span class="breadcrumbs__link">Information Technology</span><meta itemprop="position" content="1"></li><li class="breadcrumbs__item"><span class="breadcrumbs__link">Artificial Intelligence</span><meta itemprop="position" content="2"></li><li class="breadcrumbs__item"><span class="breadcrumbs__link">👨🏻‍🏫 Google - 02 - ML</span><meta itemprop="position" content="3"></li><li itemscope="" itemprop="itemListElement" itemtype="https://schema.org/ListItem" class="breadcrumbs__item breadcrumbs__item--active"><span class="breadcrumbs__link" itemprop="name">📖 Classification</span><meta itemprop="position" content="4"></li></ul></nav><div class="tocCollapsible_ETCw theme-doc-toc-mobile tocMobile_ITEo"><button type="button" class="clean-btn tocCollapsibleButton_TO0P">On this page</button></div><div class="theme-doc-markdown markdown"><header><h1>📖 Classification</h1></header><h2 class="anchor anchorWithStickyNavbar_LWe7" id="️-useful-materials">➡️ <strong>Useful Materials</strong><a href="#️-useful-materials" class="hash-link" aria-label="Direct link to ️-useful-materials" title="Direct link to ️-useful-materials">​</a></h2>
<h3 class="anchor anchorWithStickyNavbar_LWe7" id="original-source">Original Source<a href="#original-source" class="hash-link" aria-label="Direct link to Original Source" title="Direct link to Original Source">​</a></h3>
<p>You can find here the original course: <a href="https://developers.google.com/machine-learning/crash-course/classification" target="_blank" rel="noopener noreferrer"><strong>Classification</strong></a></p>
<h2 class="anchor anchorWithStickyNavbar_LWe7" id="1️⃣-introduction">1️⃣ <strong>Introduction</strong><a href="#1️⃣-introduction" class="hash-link" aria-label="Direct link to 1️⃣-introduction" title="Direct link to 1️⃣-introduction">​</a></h2>
<div class="theme-admonition theme-admonition-info admonition_xJq3 alert alert--info"><div class="admonitionHeading_Gvgb"><span class="admonitionIcon_Rf37"><svg viewBox="0 0 14 16"><path fill-rule="evenodd" d="M7 2.3c3.14 0 5.7 2.56 5.7 5.7s-2.56 5.7-5.7 5.7A5.71 5.71 0 0 1 1.3 8c0-3.14 2.56-5.7 5.7-5.7zM7 1C3.14 1 0 4.14 0 8s3.14 7 7 7 7-3.14 7-7-3.14-7-7-7zm1 3H6v5h2V4zm0 6H6v2h2v-2z"></path></svg></span>Definition</div><div class="admonitionContent_BuS1"><p>Classification is the task of predicting which of a set of classes (categories) an example belongs to.</p></div></div>
<h2 class="anchor anchorWithStickyNavbar_LWe7" id="2️⃣-thresholds-and-the-confusion-matrix">2️⃣ <strong>Thresholds and the Confusion Matrix</strong><a href="#2️⃣-thresholds-and-the-confusion-matrix" class="hash-link" aria-label="Direct link to 2️⃣-thresholds-and-the-confusion-matrix" title="Direct link to 2️⃣-thresholds-and-the-confusion-matrix">​</a></h2>
<p>In logistic regression models (e.g., spam detection), predictions are probabilities between <span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mn>0</mn></mrow><annotation encoding="application/x-tex">0</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.6444em"></span><span class="mord">0</span></span></span></span> and <span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mn>1</mn></mrow><annotation encoding="application/x-tex">1</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.6444em"></span><span class="mord">1</span></span></span></span>. To convert these probabilities into discrete classes (e.g., &quot;spam&quot; or &quot;not spam&quot;), a <strong>classification threshold</strong> is applied:</p>
<ul>
<li>
<p><strong>Above the threshold</strong><br>
<!-- -->Assigned to the <em>positive class</em> (e.g., spam)</p>
</li>
<li>
<p><strong>Below or equal to the threshold</strong><br>
<!-- -->Assigned to the <em>negative class</em> (e.g., not spam)</p>
</li>
</ul>
<div class="theme-admonition theme-admonition-tip admonition_xJq3 alert alert--success"><div class="admonitionHeading_Gvgb"><span class="admonitionIcon_Rf37"><svg viewBox="0 0 12 16"><path fill-rule="evenodd" d="M6.5 0C3.48 0 1 2.19 1 5c0 .92.55 2.25 1 3 1.34 2.25 1.78 2.78 2 4v1h5v-1c.22-1.22.66-1.75 2-4 .45-.75 1-2.08 1-3 0-2.81-2.48-5-5.5-5zm3.64 7.48c-.25.44-.47.8-.67 1.11-.86 1.41-1.25 2.06-1.45 3.23-.02.05-.02.11-.02.17H5c0-.06 0-.13-.02-.17-.2-1.17-.59-1.83-1.45-3.23-.2-.31-.42-.67-.67-1.11C2.44 6.78 2 5.65 2 5c0-2.2 2.02-4 4.5-4 1.22 0 2.36.42 3.22 1.19C10.55 2.94 11 3.94 11 5c0 .66-.44 1.78-.86 2.48zM4 14h5c-.23 1.14-1.3 2-2.5 2s-2.27-.86-2.5-2z"></path></svg></span>Examples</div><div class="admonitionContent_BuS1"><ul>
<li>Prediction = <span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mn>0.99</mn></mrow><annotation encoding="application/x-tex">0.99</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.6444em"></span><span class="mord">0.99</span></span></span></span> → Classified as <em>spam</em> (threshold = <span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mn>0.5</mn></mrow><annotation encoding="application/x-tex">0.5</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.6444em"></span><span class="mord">0.5</span></span></span></span>)</li>
<li>Prediction = <span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mn>0.51</mn></mrow><annotation encoding="application/x-tex">0.51</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.6444em"></span><span class="mord">0.51</span></span></span></span> → Classified as <em>spam</em> (threshold = <span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mn>0.5</mn></mrow><annotation encoding="application/x-tex">0.5</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.6444em"></span><span class="mord">0.5</span></span></span></span>)</li>
<li>Prediction = <span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mn>0.51</mn></mrow><annotation encoding="application/x-tex">0.51</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.6444em"></span><span class="mord">0.51</span></span></span></span> → Classified as <em>not spam</em> (threshold = <span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mn>0.95</mn></mrow><annotation encoding="application/x-tex">0.95</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.6444em"></span><span class="mord">0.95</span></span></span></span>)</li>
</ul></div></div>
<h3 class="anchor anchorWithStickyNavbar_LWe7" id="confusion-matrix">Confusion Matrix<a href="#confusion-matrix" class="hash-link" aria-label="Direct link to Confusion Matrix" title="Direct link to Confusion Matrix">​</a></h3>
<p>A confusion matrix evaluates a classifier’s performance by comparing its predictions to the <strong>ground truth</strong>. For a binary problem like spam detection, the matrix organizes outcomes into four categories:</p>
<ol>
<li><strong>True Positives (TP)</strong>: Emails correctly classified as spam.</li>
<li><strong>False Positives (FP)</strong>: Legitimate emails incorrectly marked as spam.</li>
<li><strong>True Negatives (TN)</strong>: Legitimate emails correctly left in the inbox.</li>
<li><strong>False Negatives (FN)</strong>: Spam emails mistakenly allowed into the inbox.</li>
</ol>
<p><img decoding="async" loading="lazy" alt="My Image" src="/MindMash/assets/images/cf-00e3a6cc9aa1681343e5931f7eafaea0.png" width="1743" height="324" class="img_ev3q"></p>
<p>The matrix’s rows represent predictions (spam vs. not spam), and its columns reflect reality. For example:</p>
<ul>
<li><strong>Row totals</strong> show how many emails the model labeled as spam (<span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>T</mi><mi>P</mi><mo>+</mo><mi>F</mi><mi>P</mi></mrow><annotation encoding="application/x-tex">TP + FP</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.7667em;vertical-align:-0.0833em"></span><span class="mord mathnormal" style="margin-right:0.13889em">TP</span><span class="mspace" style="margin-right:0.2222em"></span><span class="mbin">+</span><span class="mspace" style="margin-right:0.2222em"></span></span><span class="base"><span class="strut" style="height:0.6833em"></span><span class="mord mathnormal" style="margin-right:0.13889em">FP</span></span></span></span>) or not spam (<span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>F</mi><mi>N</mi><mo>+</mo><mi>T</mi><mi>N</mi></mrow><annotation encoding="application/x-tex">FN + TN</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.7667em;vertical-align:-0.0833em"></span><span class="mord mathnormal" style="margin-right:0.10903em">FN</span><span class="mspace" style="margin-right:0.2222em"></span><span class="mbin">+</span><span class="mspace" style="margin-right:0.2222em"></span></span><span class="base"><span class="strut" style="height:0.6833em"></span><span class="mord mathnormal" style="margin-right:0.10903em">TN</span></span></span></span>).</li>
<li><strong>Column totals</strong> reveal the actual number of spam (<span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>T</mi><mi>P</mi><mo>+</mo><mi>F</mi><mi>N</mi></mrow><annotation encoding="application/x-tex">TP + FN</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.7667em;vertical-align:-0.0833em"></span><span class="mord mathnormal" style="margin-right:0.13889em">TP</span><span class="mspace" style="margin-right:0.2222em"></span><span class="mbin">+</span><span class="mspace" style="margin-right:0.2222em"></span></span><span class="base"><span class="strut" style="height:0.6833em"></span><span class="mord mathnormal" style="margin-right:0.10903em">FN</span></span></span></span>) and non-spam (<span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>F</mi><mi>P</mi><mo>+</mo><mi>T</mi><mi>N</mi></mrow><annotation encoding="application/x-tex">FP + TN</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.7667em;vertical-align:-0.0833em"></span><span class="mord mathnormal" style="margin-right:0.13889em">FP</span><span class="mspace" style="margin-right:0.2222em"></span><span class="mbin">+</span><span class="mspace" style="margin-right:0.2222em"></span></span><span class="base"><span class="strut" style="height:0.6833em"></span><span class="mord mathnormal" style="margin-right:0.10903em">TN</span></span></span></span>) emails.</li>
</ul>
<h4 class="anchor anchorWithStickyNavbar_LWe7" id="-imbalanced-datasets">➽ Imbalanced Datasets<a href="#-imbalanced-datasets" class="hash-link" aria-label="Direct link to ➽ Imbalanced Datasets" title="Direct link to ➽ Imbalanced Datasets">​</a></h4>
<p>When the actual positives (e.g., spam) are vastly outnumbered by negatives (e.g., legitimate emails), the dataset is <strong>imbalanced</strong>. Consider a dataset of cloud photos where the rare “volutus” cloud type appears only a few times. Here, even a high-accuracy model could fail to detect volutus clouds because it optimizes for the majority class. The confusion matrix highlights this imbalance: a model that always predicts “not volutus” would have high accuracy but zero true positives.</p>
<h4 class="anchor anchorWithStickyNavbar_LWe7" id="-why-this-matters">➽ Why This Matters<a href="#-why-this-matters" class="hash-link" aria-label="Direct link to ➽ Why This Matters" title="Direct link to ➽ Why This Matters">​</a></h4>
<p>The confusion matrix quantifies trade-offs inherent in threshold selection:</p>
<ul>
<li>A <strong>high threshold</strong> (e.g., <span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mn>0.95</mn></mrow><annotation encoding="application/x-tex">0.95</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.6444em"></span><span class="mord">0.95</span></span></span></span>) reduces false positives but risks missing true positives.</li>
<li>A <strong>low threshold</strong> (e.g., <span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mn>0.1</mn></mrow><annotation encoding="application/x-tex">0.1</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.6444em"></span><span class="mord">0.1</span></span></span></span>) catches more true positives but increases false alarms.</li>
</ul>
<p>By analyzing the matrix, practitioners can align thresholds with real-world priorities, whether minimizing false alarms in legal document review or ensuring rare diseases are not missed in medical testing.</p>
<iframe src="https://www.youtube.com/embed/QM0sYbEQSkM" title="Machine Learning Crash Course: Classification" frameborder="0" allow="accelerometer; autoplay; clipboard-write; encrypted-media; gyroscope; picture-in-picture" allowfullscreen="" class="video-holidays"></iframe>
<h2 class="anchor anchorWithStickyNavbar_LWe7" id="3️⃣-accuracy-recall-precision-and-related-metrics">3️⃣ <strong>Accuracy, recall, precision, and related metrics</strong><a href="#3️⃣-accuracy-recall-precision-and-related-metrics" class="hash-link" aria-label="Direct link to 3️⃣-accuracy-recall-precision-and-related-metrics" title="Direct link to 3️⃣-accuracy-recall-precision-and-related-metrics">​</a></h2>
<p>True and false positives and negatives are used to calculate several useful <strong>metrics</strong> for evaluating models. Which evaluation metrics are most meaningful depends on the specific model and the specific task, the cost of different misclassifications, and whether the dataset is balanced or imbalanced.</p>
<p>All of the metrics in this section are calculated at a single fixed threshold, and change when the threshold changes. Very often, the user tunes the threshold to optimize one of these metrics.</p>
<h3 class="anchor anchorWithStickyNavbar_LWe7" id="accuracy">Accuracy<a href="#accuracy" class="hash-link" aria-label="Direct link to Accuracy" title="Direct link to Accuracy">​</a></h3>
<div class="theme-admonition theme-admonition-info admonition_xJq3 alert alert--info"><div class="admonitionHeading_Gvgb"><span class="admonitionIcon_Rf37"><svg viewBox="0 0 14 16"><path fill-rule="evenodd" d="M7 2.3c3.14 0 5.7 2.56 5.7 5.7s-2.56 5.7-5.7 5.7A5.71 5.71 0 0 1 1.3 8c0-3.14 2.56-5.7 5.7-5.7zM7 1C3.14 1 0 4.14 0 8s3.14 7 7 7 7-3.14 7-7-3.14-7-7-7zm1 3H6v5h2V4zm0 6H6v2h2v-2z"></path></svg></span>Definition</div><div class="admonitionContent_BuS1"><p>Accuracy is the proportion of all classifications that were correct, whether positive or negative.</p></div></div>
<p>It is mathematically defined as:</p>
<span class="katex-display"><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML" display="block"><semantics><mrow><mtext>Accuracy</mtext><mo>=</mo><mfrac><mtext>correct classifications</mtext><mtext>total classifications</mtext></mfrac><mo>=</mo><mfrac><mrow><mi>T</mi><mi>P</mi><mo>+</mo><mi>T</mi><mi>N</mi></mrow><mrow><mi>T</mi><mi>P</mi><mo>+</mo><mi>T</mi><mi>N</mi><mo>+</mo><mi>F</mi><mi>P</mi><mo>+</mo><mi>F</mi><mi>N</mi></mrow></mfrac></mrow><annotation encoding="application/x-tex">\text{Accuracy} =
\frac{\text{correct classifications}}{\text{total classifications}}
= \frac{TP+TN}{TP+TN+FP+FN}</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.8778em;vertical-align:-0.1944em"></span><span class="mord text"><span class="mord">Accuracy</span></span><span class="mspace" style="margin-right:0.2778em"></span><span class="mrel">=</span><span class="mspace" style="margin-right:0.2778em"></span></span><span class="base"><span class="strut" style="height:2.0574em;vertical-align:-0.686em"></span><span class="mord"><span class="mopen nulldelimiter"></span><span class="mfrac"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:1.3714em"><span style="top:-2.314em"><span class="pstrut" style="height:3em"></span><span class="mord"><span class="mord text"><span class="mord">total classifications</span></span></span></span><span style="top:-3.23em"><span class="pstrut" style="height:3em"></span><span class="frac-line" style="border-bottom-width:0.04em"></span></span><span style="top:-3.677em"><span class="pstrut" style="height:3em"></span><span class="mord"><span class="mord text"><span class="mord">correct classifications</span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.686em"><span></span></span></span></span></span><span class="mclose nulldelimiter"></span></span><span class="mspace" style="margin-right:0.2778em"></span><span class="mrel">=</span><span class="mspace" style="margin-right:0.2778em"></span></span><span class="base"><span class="strut" style="height:2.1297em;vertical-align:-0.7693em"></span><span class="mord"><span class="mopen nulldelimiter"></span><span class="mfrac"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:1.3603em"><span style="top:-2.314em"><span class="pstrut" style="height:3em"></span><span class="mord"><span class="mord mathnormal" style="margin-right:0.13889em">TP</span><span class="mspace" style="margin-right:0.2222em"></span><span class="mbin">+</span><span class="mspace" style="margin-right:0.2222em"></span><span class="mord mathnormal" style="margin-right:0.10903em">TN</span><span class="mspace" style="margin-right:0.2222em"></span><span class="mbin">+</span><span class="mspace" style="margin-right:0.2222em"></span><span class="mord mathnormal" style="margin-right:0.13889em">FP</span><span class="mspace" style="margin-right:0.2222em"></span><span class="mbin">+</span><span class="mspace" style="margin-right:0.2222em"></span><span class="mord mathnormal" style="margin-right:0.10903em">FN</span></span></span><span style="top:-3.23em"><span class="pstrut" style="height:3em"></span><span class="frac-line" style="border-bottom-width:0.04em"></span></span><span style="top:-3.677em"><span class="pstrut" style="height:3em"></span><span class="mord"><span class="mord mathnormal" style="margin-right:0.13889em">TP</span><span class="mspace" style="margin-right:0.2222em"></span><span class="mbin">+</span><span class="mspace" style="margin-right:0.2222em"></span><span class="mord mathnormal" style="margin-right:0.10903em">TN</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.7693em"><span></span></span></span></span></span><span class="mclose nulldelimiter"></span></span></span></span></span></span>
<p>In the spam classification example, accuracy measures the fraction of all emails correctly classified.</p>
<h4 class="anchor anchorWithStickyNavbar_LWe7" id="-limitations">➽ Limitations<a href="#-limitations" class="hash-link" aria-label="Direct link to ➽ Limitations" title="Direct link to ➽ Limitations">​</a></h4>
<p>Accuracy can be misleading for imbalanced datasets.</p>
<p>For instance, a model predicting “not spam” 100% of the time would achieve <strong>99% accuracy</strong> if only 1% of emails are spam, despite failing to detect any spam.</p>
<h4 class="anchor anchorWithStickyNavbar_LWe7" id="-when-to-use">➽ When to use?<a href="#-when-to-use" class="hash-link" aria-label="Direct link to ➽ When to use?" title="Direct link to ➽ When to use?">​</a></h4>
<p>As a baseline metric for generic tasks with balanced classes.</p>
<h3 class="anchor anchorWithStickyNavbar_LWe7" id="recall-true-positive-rate">Recall (True Positive Rate)<a href="#recall-true-positive-rate" class="hash-link" aria-label="Direct link to Recall (True Positive Rate)" title="Direct link to Recall (True Positive Rate)">​</a></h3>
<p>The <strong>true positive rate (TPR)</strong>, or the proportion of all actual positives that were classified correctly as positives, is also known as <strong>recall</strong>.</p>
<p>Recall is mathematically defined as:</p>
<span class="katex-display"><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML" display="block"><semantics><mrow><mtext>Recall (or TPR)</mtext><mo>=</mo><mfrac><mtext>correctly classified actual positives</mtext><mtext>all actual positives</mtext></mfrac><mo>=</mo><mfrac><mrow><mi>T</mi><mi>P</mi></mrow><mrow><mi>T</mi><mi>P</mi><mo>+</mo><mi>F</mi><mi>N</mi></mrow></mfrac></mrow><annotation encoding="application/x-tex">\text{Recall (or TPR)} =
\frac{\text{correctly classified actual positives}}{\text{all actual positives}}
= \frac{TP}{TP+FN}</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:1em;vertical-align:-0.25em"></span><span class="mord text"><span class="mord">Recall (or TPR)</span></span><span class="mspace" style="margin-right:0.2778em"></span><span class="mrel">=</span><span class="mspace" style="margin-right:0.2778em"></span></span><span class="base"><span class="strut" style="height:2.2519em;vertical-align:-0.8804em"></span><span class="mord"><span class="mopen nulldelimiter"></span><span class="mfrac"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:1.3714em"><span style="top:-2.314em"><span class="pstrut" style="height:3em"></span><span class="mord"><span class="mord text"><span class="mord">all actual positives</span></span></span></span><span style="top:-3.23em"><span class="pstrut" style="height:3em"></span><span class="frac-line" style="border-bottom-width:0.04em"></span></span><span style="top:-3.677em"><span class="pstrut" style="height:3em"></span><span class="mord"><span class="mord text"><span class="mord">correctly classified actual positives</span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.8804em"><span></span></span></span></span></span><span class="mclose nulldelimiter"></span></span><span class="mspace" style="margin-right:0.2778em"></span><span class="mrel">=</span><span class="mspace" style="margin-right:0.2778em"></span></span><span class="base"><span class="strut" style="height:2.1297em;vertical-align:-0.7693em"></span><span class="mord"><span class="mopen nulldelimiter"></span><span class="mfrac"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:1.3603em"><span style="top:-2.314em"><span class="pstrut" style="height:3em"></span><span class="mord"><span class="mord mathnormal" style="margin-right:0.13889em">TP</span><span class="mspace" style="margin-right:0.2222em"></span><span class="mbin">+</span><span class="mspace" style="margin-right:0.2222em"></span><span class="mord mathnormal" style="margin-right:0.10903em">FN</span></span></span><span style="top:-3.23em"><span class="pstrut" style="height:3em"></span><span class="frac-line" style="border-bottom-width:0.04em"></span></span><span style="top:-3.677em"><span class="pstrut" style="height:3em"></span><span class="mord"><span class="mord mathnormal" style="margin-right:0.13889em">TP</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.7693em"><span></span></span></span></span></span><span class="mclose nulldelimiter"></span></span></span></span></span></span>
<p><strong>False negatives</strong> are <strong>actual positives</strong> that were <strong>misclassified</strong> as negatives, which is why they appear in the denominator.</p>
<p>In the spam classification example, recall measures the fraction of spam emails that were correctly classified as spam. This is why another name for recall is <strong>probability of detection</strong>: it answers the question <em>&quot;What fraction of spam emails are detected by this model?&quot;</em></p>
<p>A hypothetical perfect model would have zero false negatives and therefore a recall (TPR) of <span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mn>1.0</mn></mrow><annotation encoding="application/x-tex">1.0</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.6444em"></span><span class="mord">1.0</span></span></span></span>, which is to say, a 100% detection rate.</p>
<h4 class="anchor anchorWithStickyNavbar_LWe7" id="-limitations-1">➽ Limitations<a href="#-limitations-1" class="hash-link" aria-label="Direct link to ➽ Limitations" title="Direct link to ➽ Limitations">​</a></h4>
<p>Does not account for false positives. A model with high recall may overflag legitimate emails as spam.</p>
<h4 class="anchor anchorWithStickyNavbar_LWe7" id="-when-to-use-1">➽ When to use?<a href="#-when-to-use-1" class="hash-link" aria-label="Direct link to ➽ When to use?" title="Direct link to ➽ When to use?">​</a></h4>
<p>Imbalanced datasets where the <strong>positive class is rare but critical</strong> (e.g., fraud detection, medical diagnosis). For applications like these, correctly identifying the positive cases is crucial. A false negative typically has more serious consequences than a false positive.</p>
<h3 class="anchor anchorWithStickyNavbar_LWe7" id="false-positive-rate">False Positive Rate<a href="#false-positive-rate" class="hash-link" aria-label="Direct link to False Positive Rate" title="Direct link to False Positive Rate">​</a></h3>
<p>The <strong>false Positive Rate (FPR)</strong> is the proportion of all actual negatives that were classified incorrectly as positives, also known as the <strong>probability of false alarm</strong>. It is mathematically defined as:</p>
<span class="katex-display"><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML" display="block"><semantics><mrow><mtext>FPR</mtext><mo>=</mo><mfrac><mtext>incorrectly classified actual negatives</mtext><mtext>all actual negatives</mtext></mfrac><mo>=</mo><mfrac><mrow><mi>F</mi><mi>P</mi></mrow><mrow><mi>F</mi><mi>P</mi><mo>+</mo><mi>T</mi><mi>N</mi></mrow></mfrac></mrow><annotation encoding="application/x-tex">\text{FPR} =
\frac{\text{incorrectly classified actual negatives}}
{\text{all actual negatives}}
= \frac{FP}{FP+TN}</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.6833em"></span><span class="mord text"><span class="mord">FPR</span></span><span class="mspace" style="margin-right:0.2778em"></span><span class="mrel">=</span><span class="mspace" style="margin-right:0.2778em"></span></span><span class="base"><span class="strut" style="height:2.2519em;vertical-align:-0.8804em"></span><span class="mord"><span class="mopen nulldelimiter"></span><span class="mfrac"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:1.3714em"><span style="top:-2.314em"><span class="pstrut" style="height:3em"></span><span class="mord"><span class="mord text"><span class="mord">all actual negatives</span></span></span></span><span style="top:-3.23em"><span class="pstrut" style="height:3em"></span><span class="frac-line" style="border-bottom-width:0.04em"></span></span><span style="top:-3.677em"><span class="pstrut" style="height:3em"></span><span class="mord"><span class="mord text"><span class="mord">incorrectly classified actual negatives</span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.8804em"><span></span></span></span></span></span><span class="mclose nulldelimiter"></span></span><span class="mspace" style="margin-right:0.2778em"></span><span class="mrel">=</span><span class="mspace" style="margin-right:0.2778em"></span></span><span class="base"><span class="strut" style="height:2.1297em;vertical-align:-0.7693em"></span><span class="mord"><span class="mopen nulldelimiter"></span><span class="mfrac"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:1.3603em"><span style="top:-2.314em"><span class="pstrut" style="height:3em"></span><span class="mord"><span class="mord mathnormal" style="margin-right:0.13889em">FP</span><span class="mspace" style="margin-right:0.2222em"></span><span class="mbin">+</span><span class="mspace" style="margin-right:0.2222em"></span><span class="mord mathnormal" style="margin-right:0.10903em">TN</span></span></span><span style="top:-3.23em"><span class="pstrut" style="height:3em"></span><span class="frac-line" style="border-bottom-width:0.04em"></span></span><span style="top:-3.677em"><span class="pstrut" style="height:3em"></span><span class="mord"><span class="mord mathnormal" style="margin-right:0.13889em">FP</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.7693em"><span></span></span></span></span></span><span class="mclose nulldelimiter"></span></span></span></span></span></span>
<p><strong>False positives</strong> are <strong>actual negatives</strong> that were <strong>misclassified</strong>, which is why they appear in the denominator.</p>
<p>In the spam classification example, FPR measures the fraction of legitimate emails that were incorrectly classified as spam, or the model&#x27;s rate of false alarms.</p>
<p>A perfect model would have zero false positives and therefore a FPR of <span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mn>0.0</mn></mrow><annotation encoding="application/x-tex">0.0</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.6444em"></span><span class="mord">0.0</span></span></span></span>, which is to say, a 0% false alarm rate.</p>
<h4 class="anchor anchorWithStickyNavbar_LWe7" id="-limitations-2">➽ Limitations<a href="#-limitations-2" class="hash-link" aria-label="Direct link to ➽ Limitations" title="Direct link to ➽ Limitations">​</a></h4>
<p>Less meaningful when actual negatives are extremely rare (e.g., only 1–2 negatives in the dataset).</p>
<h4 class="anchor anchorWithStickyNavbar_LWe7" id="-when-to-use-2">➽ When to use?<a href="#-when-to-use-2" class="hash-link" aria-label="Direct link to ➽ When to use?" title="Direct link to ➽ When to use?">​</a></h4>
<p>Applications prioritizing minimal false alarms (e.g., security systems).</p>
<h3 class="anchor anchorWithStickyNavbar_LWe7" id="precision">Precision<a href="#precision" class="hash-link" aria-label="Direct link to Precision" title="Direct link to Precision">​</a></h3>
<p><strong>Precision</strong> is the proportion of all the model&#x27;s positive classifications that are actually positive. It is mathematically defined as:</p>
<span class="katex-display"><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML" display="block"><semantics><mrow><mtext>Precision</mtext><mo>=</mo><mfrac><mtext>correctly classified actual positives</mtext><mtext>everything classified as positive</mtext></mfrac><mo>=</mo><mfrac><mrow><mi>T</mi><mi>P</mi></mrow><mrow><mi>T</mi><mi>P</mi><mo>+</mo><mi>F</mi><mi>P</mi></mrow></mfrac></mrow><annotation encoding="application/x-tex">\text{Precision} =
\frac{\text{correctly classified actual positives}}
{\text{everything classified as positive}}
= \frac{TP}{TP+FP}</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.6833em"></span><span class="mord text"><span class="mord">Precision</span></span><span class="mspace" style="margin-right:0.2778em"></span><span class="mrel">=</span><span class="mspace" style="margin-right:0.2778em"></span></span><span class="base"><span class="strut" style="height:2.2519em;vertical-align:-0.8804em"></span><span class="mord"><span class="mopen nulldelimiter"></span><span class="mfrac"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:1.3714em"><span style="top:-2.314em"><span class="pstrut" style="height:3em"></span><span class="mord"><span class="mord text"><span class="mord">everything classified as positive</span></span></span></span><span style="top:-3.23em"><span class="pstrut" style="height:3em"></span><span class="frac-line" style="border-bottom-width:0.04em"></span></span><span style="top:-3.677em"><span class="pstrut" style="height:3em"></span><span class="mord"><span class="mord text"><span class="mord">correctly classified actual positives</span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.8804em"><span></span></span></span></span></span><span class="mclose nulldelimiter"></span></span><span class="mspace" style="margin-right:0.2778em"></span><span class="mrel">=</span><span class="mspace" style="margin-right:0.2778em"></span></span><span class="base"><span class="strut" style="height:2.1297em;vertical-align:-0.7693em"></span><span class="mord"><span class="mopen nulldelimiter"></span><span class="mfrac"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:1.3603em"><span style="top:-2.314em"><span class="pstrut" style="height:3em"></span><span class="mord"><span class="mord mathnormal" style="margin-right:0.13889em">TP</span><span class="mspace" style="margin-right:0.2222em"></span><span class="mbin">+</span><span class="mspace" style="margin-right:0.2222em"></span><span class="mord mathnormal" style="margin-right:0.13889em">FP</span></span></span><span style="top:-3.23em"><span class="pstrut" style="height:3em"></span><span class="frac-line" style="border-bottom-width:0.04em"></span></span><span style="top:-3.677em"><span class="pstrut" style="height:3em"></span><span class="mord"><span class="mord mathnormal" style="margin-right:0.13889em">TP</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.7693em"><span></span></span></span></span></span><span class="mclose nulldelimiter"></span></span></span></span></span></span>
<p>In the spam classification example, precision measures the fraction of emails classified as spam that were actually spam.</p>
<p>A hypothetical perfect model would have zero false positives and therefore a precision of <span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mn>1.0</mn></mrow><annotation encoding="application/x-tex">1.0</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.6444em"></span><span class="mord">1.0</span></span></span></span>.</p>
<h4 class="anchor anchorWithStickyNavbar_LWe7" id="-limitations-3">➽ Limitations<a href="#-limitations-3" class="hash-link" aria-label="Direct link to ➽ Limitations" title="Direct link to ➽ Limitations">​</a></h4>
<p>In an imbalanced dataset where the number of actual positives is very, very low, say 1-2 examples in total, precision is less meaningful and less useful as a metric.</p>
<p>Moreover, it does not penalize false negatives. A high-precision model might miss many true positives.</p>
<h4 class="anchor anchorWithStickyNavbar_LWe7" id="-when-to-use-3">➽ When to use?<a href="#-when-to-use-3" class="hash-link" aria-label="Direct link to ➽ When to use?" title="Direct link to ➽ When to use?">​</a></h4>
<p>Tasks requiring high confidence in positive predictions (e.g., product recommendations).</p>
<h3 class="anchor anchorWithStickyNavbar_LWe7" id="trade-offs-and-threshold-tuning">Trade-offs and Threshold Tuning<a href="#trade-offs-and-threshold-tuning" class="hash-link" aria-label="Direct link to Trade-offs and Threshold Tuning" title="Direct link to Trade-offs and Threshold Tuning">​</a></h3>
<h4 class="anchor anchorWithStickyNavbar_LWe7" id="-precision-recall-trade-off">➽ Precision-Recall Trade-off<a href="#-precision-recall-trade-off" class="hash-link" aria-label="Direct link to ➽ Precision-Recall Trade-off" title="Direct link to ➽ Precision-Recall Trade-off">​</a></h4>
<p>Precision improves as false positives decrease, while recall improves when false negatives decrease. But as seen in the previous section, increasing the classification threshold tends to decrease the number of false positives and increase the number of false negatives, while decreasing the threshold has the opposite effects. As a result, <strong>precision and recall often show an inverse relationship</strong>, where improving one of them worsens the other.</p>
<ul>
<li><strong>Increasing the threshold</strong> raises precision (fewer FP) but lowers recall (more FN).</li>
<li><strong>Decreasing the threshold</strong> raises recall (fewer FN) but lowers precision (more FP).</li>
</ul>
<h3 class="anchor anchorWithStickyNavbar_LWe7" id="f1-score-balancing-precision-and-recall">F1-Score: Balancing Precision and Recall<a href="#f1-score-balancing-precision-and-recall" class="hash-link" aria-label="Direct link to F1-Score: Balancing Precision and Recall" title="Direct link to F1-Score: Balancing Precision and Recall">​</a></h3>
<p>The F1-score harmonizes precision and recall into a single metric, calculated as the <strong>harmonic mean</strong> of the two:</p>
<span class="katex-display"><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML" display="block"><semantics><mrow><mtext>F1-Score</mtext><mo>=</mo><mfrac><mrow><mn>2</mn><mo>⋅</mo><mtext>Precision</mtext><mo>⋅</mo><mtext>Recall</mtext></mrow><mrow><mtext>Precision</mtext><mo>+</mo><mtext>Recall</mtext></mrow></mfrac></mrow><annotation encoding="application/x-tex">\text{F1-Score} = \frac{2 \cdot \text{Precision} \cdot \text{Recall}}{\text{Precision} + \text{Recall}}</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.6833em"></span><span class="mord text"><span class="mord">F1-Score</span></span><span class="mspace" style="margin-right:0.2778em"></span><span class="mrel">=</span><span class="mspace" style="margin-right:0.2778em"></span></span><span class="base"><span class="strut" style="height:2.1408em;vertical-align:-0.7693em"></span><span class="mord"><span class="mopen nulldelimiter"></span><span class="mfrac"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:1.3714em"><span style="top:-2.314em"><span class="pstrut" style="height:3em"></span><span class="mord"><span class="mord text"><span class="mord">Precision</span></span><span class="mspace" style="margin-right:0.2222em"></span><span class="mbin">+</span><span class="mspace" style="margin-right:0.2222em"></span><span class="mord text"><span class="mord">Recall</span></span></span></span><span style="top:-3.23em"><span class="pstrut" style="height:3em"></span><span class="frac-line" style="border-bottom-width:0.04em"></span></span><span style="top:-3.677em"><span class="pstrut" style="height:3em"></span><span class="mord"><span class="mord">2</span><span class="mspace" style="margin-right:0.2222em"></span><span class="mbin">⋅</span><span class="mspace" style="margin-right:0.2222em"></span><span class="mord text"><span class="mord">Precision</span></span><span class="mspace" style="margin-right:0.2222em"></span><span class="mbin">⋅</span><span class="mspace" style="margin-right:0.2222em"></span><span class="mord text"><span class="mord">Recall</span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.7693em"><span></span></span></span></span></span><span class="mclose nulldelimiter"></span></span></span></span></span></span>
<p>Unlike the arithmetic mean, the harmonic mean penalizes extreme imbalances between precision and recall. For example, a model with precision=<span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mn>1.0</mn></mrow><annotation encoding="application/x-tex">1.0</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.6444em"></span><span class="mord">1.0</span></span></span></span> and recall=<span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mn>0.5</mn></mrow><annotation encoding="application/x-tex">0.5</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.6444em"></span><span class="mord">0.5</span></span></span></span> would have an arithmetic mean of <span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mn>0.75</mn></mrow><annotation encoding="application/x-tex">0.75</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.6444em"></span><span class="mord">0.75</span></span></span></span> but an F1-score of <span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mn>0.67</mn></mrow><annotation encoding="application/x-tex">0.67</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.6444em"></span><span class="mord">0.67</span></span></span></span>. This makes the F1-score especially useful when both false positives and false negatives carry significant costs, such as in medical diagnosis or fraud detection.</p>
<h4 class="anchor anchorWithStickyNavbar_LWe7" id="-limitations-4">➽ Limitations<a href="#-limitations-4" class="hash-link" aria-label="Direct link to ➽ Limitations" title="Direct link to ➽ Limitations">​</a></h4>
<ul>
<li>Assumes equal importance of precision and recall, which may not align with domain-specific priorities.</li>
<li>Less interpretable than precision or recall alone.</li>
</ul>
<h4 class="anchor anchorWithStickyNavbar_LWe7" id="-when-to-use-4">➽ When to use?<a href="#-when-to-use-4" class="hash-link" aria-label="Direct link to ➽ When to use?" title="Direct link to ➽ When to use?">​</a></h4>
<ul>
<li>Imbalanced datasets where neither precision nor recall should dominate.</li>
<li>Scenarios requiring a balanced view of model performance (e.g., quality control systems).</li>
</ul>
<h2 class="anchor anchorWithStickyNavbar_LWe7" id="4️⃣-roc-and-auc">4️⃣ <strong>ROC and AUC</strong><a href="#4️⃣-roc-and-auc" class="hash-link" aria-label="Direct link to 4️⃣-roc-and-auc" title="Direct link to 4️⃣-roc-and-auc">​</a></h2>
<h3 class="anchor anchorWithStickyNavbar_LWe7" id="receiver-operating-characteristic-curve-roc">Receiver-operating characteristic curve (ROC)<a href="#receiver-operating-characteristic-curve-roc" class="hash-link" aria-label="Direct link to Receiver-operating characteristic curve (ROC)" title="Direct link to Receiver-operating characteristic curve (ROC)">​</a></h3>
<p>The ROC curve is a visual representation of <strong>model performance across all thresholds</strong>.</p>
<p>It is drawn by calculating the true positive rate (TPR) and false positive rate (FPR) at every possible threshold (in practice, at selected intervals), then graphing TPR over FPR.</p>
<p>A perfect model, which at some threshold has a TPR of <span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mn>1.0</mn></mrow><annotation encoding="application/x-tex">1.0</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.6444em"></span><span class="mord">1.0</span></span></span></span> and a FPR of <span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mn>0.0</mn></mrow><annotation encoding="application/x-tex">0.0</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.6444em"></span><span class="mord">0.0</span></span></span></span>, can be represented by either a point at <span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mo stretchy="false">(</mo><mn>0</mn><mo separator="true">,</mo><mn>1</mn><mo stretchy="false">)</mo></mrow><annotation encoding="application/x-tex">(0, 1)</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:1em;vertical-align:-0.25em"></span><span class="mopen">(</span><span class="mord">0</span><span class="mpunct">,</span><span class="mspace" style="margin-right:0.1667em"></span><span class="mord">1</span><span class="mclose">)</span></span></span></span> if all other thresholds are ignored, or by the following:</p>
<p><img decoding="async" loading="lazy" alt="My Image" src="/MindMash/assets/images/auc_1-0-62a6acbef20c71a427744b7fec9fbed9.png" width="2013" height="627" class="img_ev3q"></p>
<h3 class="anchor anchorWithStickyNavbar_LWe7" id="area-under-the-curve-auc">Area under the curve (AUC)<a href="#area-under-the-curve-auc" class="hash-link" aria-label="Direct link to Area under the curve (AUC)" title="Direct link to Area under the curve (AUC)">​</a></h3>
<p>The area under the ROC curve (AUC) represents the <strong>probability</strong> that the model, if given a randomly chosen positive and negative example, <strong>will rank the positive higher than the negative</strong>.</p>
<p>The perfect model above, containing a square with sides of length 1, has an area under the curve (AUC) of <span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mn>1.0</mn></mrow><annotation encoding="application/x-tex">1.0</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.6444em"></span><span class="mord">1.0</span></span></span></span>.</p>
<p>For a binary classifier, a model that does exactly as well as random guesses or coin flips has a ROC that is a diagonal line from <span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mo stretchy="false">(</mo><mn>0</mn><mo separator="true">,</mo><mn>0</mn><mo stretchy="false">)</mo></mrow><annotation encoding="application/x-tex">(0,0)</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:1em;vertical-align:-0.25em"></span><span class="mopen">(</span><span class="mord">0</span><span class="mpunct">,</span><span class="mspace" style="margin-right:0.1667em"></span><span class="mord">0</span><span class="mclose">)</span></span></span></span> to <span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mo stretchy="false">(</mo><mn>1</mn><mo separator="true">,</mo><mn>1</mn><mo stretchy="false">)</mo></mrow><annotation encoding="application/x-tex">(1,1)</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:1em;vertical-align:-0.25em"></span><span class="mopen">(</span><span class="mord">1</span><span class="mpunct">,</span><span class="mspace" style="margin-right:0.1667em"></span><span class="mord">1</span><span class="mclose">)</span></span></span></span>. The AUC is <span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mn>0.5</mn></mrow><annotation encoding="application/x-tex">0.5</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.6444em"></span><span class="mord">0.5</span></span></span></span>, representing a 50% probability of correctly ranking a random positive and negative example.</p>
<p><img decoding="async" loading="lazy" alt="My Image" src="/MindMash/assets/images/auc_0-5-1db15077265c794ffdda66696a805fbe.png" width="2301" height="634" class="img_ev3q"></p>
<h4 class="anchor anchorWithStickyNavbar_LWe7" id="-when-to-use-5">➽ When to use?<a href="#-when-to-use-5" class="hash-link" aria-label="Direct link to ➽ When to use?" title="Direct link to ➽ When to use?">​</a></h4>
<p>AUC and ROC work well for comparing models when the dataset is roughly balanced between classes.</p>
<h4 class="anchor anchorWithStickyNavbar_LWe7" id="-limitations-5">➽ Limitations<a href="#-limitations-5" class="hash-link" aria-label="Direct link to ➽ Limitations" title="Direct link to ➽ Limitations">​</a></h4>
<p>When the dataset is imbalanced, precision-recall curves (PRCs) and the area under those curves may offer a better comparative visualization of model performance. Precision-recall curves are created by plotting precision on the y-axis and recall on the x-axis across all thresholds.</p>
<p><img decoding="async" loading="lazy" alt="My Image" src="/MindMash/assets/images/prauc-41775145ce3c1800ec4453e83234dd6b.png" width="2287" height="632" class="img_ev3q"></p>
<h3 class="anchor anchorWithStickyNavbar_LWe7" id="auc-and-roc-for-choosing-model-and-threshold">AUC and ROC for choosing model and threshold<a href="#auc-and-roc-for-choosing-model-and-threshold" class="hash-link" aria-label="Direct link to AUC and ROC for choosing model and threshold" title="Direct link to AUC and ROC for choosing model and threshold">​</a></h3>
<p>As we said, AUC is a useful measure for comparing the performance of two different models, as long as the dataset is roughly balanced.</p>
<p>The model with <strong>greater area under the curve</strong> is generally the <strong>better</strong> one.</p>
<p><img decoding="async" loading="lazy" alt="My Image" src="/MindMash/assets/images/auc_0-65-dcf9fc43817add4deb1f0199181ac2f8.png" width="942" height="337" class="img_ev3q"></p>
<p>The points on a ROC curve closest to <span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mo stretchy="false">(</mo><mn>0</mn><mo separator="true">,</mo><mn>1</mn><mo stretchy="false">)</mo></mrow><annotation encoding="application/x-tex">(0,1)</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:1em;vertical-align:-0.25em"></span><span class="mopen">(</span><span class="mord">0</span><span class="mpunct">,</span><span class="mspace" style="margin-right:0.1667em"></span><span class="mord">1</span><span class="mclose">)</span></span></span></span> represent a range of the best-performing thresholds for the given model. The threshold you choose depends on <strong>which metric is most important to the specific use case</strong>.</p>
<p>Consider the points <span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>A</mi></mrow><annotation encoding="application/x-tex">A</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.6833em"></span><span class="mord mathnormal">A</span></span></span></span>, <span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>B</mi></mrow><annotation encoding="application/x-tex">B</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.6833em"></span><span class="mord mathnormal" style="margin-right:0.05017em">B</span></span></span></span>, and <span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>C</mi></mrow><annotation encoding="application/x-tex">C</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.6833em"></span><span class="mord mathnormal" style="margin-right:0.07153em">C</span></span></span></span> in the following diagram, each representing a threshold:</p>
<p><img decoding="async" loading="lazy" alt="My Image" src="/MindMash/assets/images/auc_abc-b80339cdcae18d475c57d5f5b1caab6a.png" width="2320" height="663" class="img_ev3q"></p>
<ul>
<li>
<p>If <strong>false positives</strong> (false alarms) are <strong>highly costly</strong>, it may make sense to choose a threshold that gives a lower FPR, like the one at point <span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>A</mi></mrow><annotation encoding="application/x-tex">A</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.6833em"></span><span class="mord mathnormal">A</span></span></span></span>, even if TPR is reduced.</p>
</li>
<li>
<p>If <strong>false positives</strong> are <strong>cheap</strong> and <strong>false negatives</strong> (missed true positives) <strong>highly costly</strong>, the threshold for point <span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>C</mi></mrow><annotation encoding="application/x-tex">C</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.6833em"></span><span class="mord mathnormal" style="margin-right:0.07153em">C</span></span></span></span>, which maximizes TPR, may be preferable.</p>
</li>
<li>
<p>If the costs are roughly <strong>equivalent</strong>, point <span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>B</mi></mrow><annotation encoding="application/x-tex">B</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.6833em"></span><span class="mord mathnormal" style="margin-right:0.05017em">B</span></span></span></span> may offer the best balance between TPR and FPR.</p>
</li>
</ul>
<h4 class="anchor anchorWithStickyNavbar_LWe7" id="-example">➽ Example<a href="#-example" class="hash-link" aria-label="Direct link to ➽ Example" title="Direct link to ➽ Example">​</a></h4>
<p><img decoding="async" loading="lazy" alt="My Image" src="/MindMash/assets/images/auc_example-dcd1b7e6dc33803a8f44eff0aa0887fd.png" width="858" height="774" class="img_ev3q"></p>
<h2 class="anchor anchorWithStickyNavbar_LWe7" id="5️⃣-prediction-bias">5️⃣ <strong>Prediction bias</strong><a href="#5️⃣-prediction-bias" class="hash-link" aria-label="Direct link to 5️⃣-prediction-bias" title="Direct link to 5️⃣-prediction-bias">​</a></h2>
<h3 class="anchor anchorWithStickyNavbar_LWe7" id="introduction">Introduction<a href="#introduction" class="hash-link" aria-label="Direct link to Introduction" title="Direct link to Introduction">​</a></h3>
<p>Prediction bias is an important diagnostic metric for evaluating machine learning models. It represents the <strong>difference</strong> between the <strong>average of a model&#x27;s predictions</strong> and the <strong>average of the actual ground-truth labels</strong> in the dataset.</p>
<p>Prediction bias occurs when a model&#x27;s predictions systematically deviate from the actual values in the dataset. Mathematically, it is calculated as:</p>
<span class="katex-display"><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML" display="block"><semantics><mrow><mtext>Prediction Bias</mtext><mo>=</mo><mi>A</mi><mi>v</mi><mi>e</mi><mi>r</mi><mi>a</mi><mi>g</mi><mi>e</mi><mo stretchy="false">(</mo><mtext>Predictions</mtext><mo stretchy="false">)</mo><mo>−</mo><mi>A</mi><mi>v</mi><mi>e</mi><mi>r</mi><mi>a</mi><mi>g</mi><mi>e</mi><mo stretchy="false">(</mo><mtext>Ground Truth Labels</mtext><mo stretchy="false">)</mo></mrow><annotation encoding="application/x-tex">\text{Prediction Bias} = Average(\text{Predictions}) - Average(\text{Ground Truth Labels})</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.6944em"></span><span class="mord text"><span class="mord">Prediction Bias</span></span><span class="mspace" style="margin-right:0.2778em"></span><span class="mrel">=</span><span class="mspace" style="margin-right:0.2778em"></span></span><span class="base"><span class="strut" style="height:1em;vertical-align:-0.25em"></span><span class="mord mathnormal">A</span><span class="mord mathnormal" style="margin-right:0.03588em">v</span><span class="mord mathnormal" style="margin-right:0.02778em">er</span><span class="mord mathnormal">a</span><span class="mord mathnormal" style="margin-right:0.03588em">g</span><span class="mord mathnormal">e</span><span class="mopen">(</span><span class="mord text"><span class="mord">Predictions</span></span><span class="mclose">)</span><span class="mspace" style="margin-right:0.2222em"></span><span class="mbin">−</span><span class="mspace" style="margin-right:0.2222em"></span></span><span class="base"><span class="strut" style="height:1em;vertical-align:-0.25em"></span><span class="mord mathnormal">A</span><span class="mord mathnormal" style="margin-right:0.03588em">v</span><span class="mord mathnormal" style="margin-right:0.02778em">er</span><span class="mord mathnormal">a</span><span class="mord mathnormal" style="margin-right:0.03588em">g</span><span class="mord mathnormal">e</span><span class="mopen">(</span><span class="mord text"><span class="mord">Ground Truth Labels</span></span><span class="mclose">)</span></span></span></span></span>
<p>For example, if a dataset contains 5% spam emails, an unbiased model should predict, on average, that 5% of emails are spam. If the model instead predicts that 10% of emails are spam, it has a prediction bias of +5%.</p>
<h3 class="anchor anchorWithStickyNavbar_LWe7" id="significance-of-prediction-bias">Significance of Prediction Bias<a href="#significance-of-prediction-bias" class="hash-link" aria-label="Direct link to Significance of Prediction Bias" title="Direct link to Significance of Prediction Bias">​</a></h3>
<p>Prediction bias serves as an early warning system for model issues. A significant bias indicates that:</p>
<ul>
<li>The model is not accurately representing the underlying data distribution</li>
<li>There may be fundamental problems with the model architecture or training process</li>
<li>The model might perform poorly on new, unseen data</li>
</ul>
<p>It&#x27;s important to note that even a model with zero prediction bias can still have other problems, such as poor precision or recall for specific classes.</p>
<h3 class="anchor anchorWithStickyNavbar_LWe7" id="common-causes-of-prediction-bias">Common Causes of Prediction Bias<a href="#common-causes-of-prediction-bias" class="hash-link" aria-label="Direct link to Common Causes of Prediction Bias" title="Direct link to Common Causes of Prediction Bias">​</a></h3>
<h4 class="anchor anchorWithStickyNavbar_LWe7" id="-data-issues">➽ Data Issues<a href="#-data-issues" class="hash-link" aria-label="Direct link to ➽ Data Issues" title="Direct link to ➽ Data Issues">​</a></h4>
<ul>
<li><strong>Biased sampling</strong><br>
<!-- -->Training data that doesn&#x27;t represent the true distribution of the target population</li>
<li><strong>Data noise</strong><br>
<!-- -->Errors or inconsistencies in the ground truth labels</li>
<li><strong>Dataset shift</strong><br>
<!-- -->Differences between training and evaluation datasets</li>
</ul>
<h4 class="anchor anchorWithStickyNavbar_LWe7" id="-model-issues">➽ Model Issues<a href="#-model-issues" class="hash-link" aria-label="Direct link to ➽ Model Issues" title="Direct link to ➽ Model Issues">​</a></h4>
<ul>
<li><strong>Excessive regularization</strong><br>
<!-- -->Over-constraining the model, causing it to lose necessary complexity</li>
<li><strong>Insufficient model capacity</strong><br>
<!-- -->Model architecture that&#x27;s too simple for the problem</li>
<li><strong>Inappropriate loss function</strong><br>
<!-- -->Using a loss function that doesn&#x27;t properly penalize bias</li>
</ul>
<h4 class="anchor anchorWithStickyNavbar_LWe7" id="-feature-issues">➽ Feature Issues<a href="#-feature-issues" class="hash-link" aria-label="Direct link to ➽ Feature Issues" title="Direct link to ➽ Feature Issues">​</a></h4>
<ul>
<li><strong>Insufficient features</strong><br>
<!-- -->Missing important predictive variables</li>
<li><strong>Feature distribution issues</strong><br>
<!-- -->Features that behave differently in training versus inference</li>
</ul>
<h4 class="anchor anchorWithStickyNavbar_LWe7" id="-pipeline-issues">➽ Pipeline Issues<a href="#-pipeline-issues" class="hash-link" aria-label="Direct link to ➽ Pipeline Issues" title="Direct link to ➽ Pipeline Issues">​</a></h4>
<ul>
<li><strong>Bugs in preprocessing</strong><br>
<!-- -->Errors in how data is transformed before model training</li>
<li><strong>Incorrect evaluation</strong><br>
<!-- -->Problems with how model performance is assessed</li>
</ul>
<h2 class="anchor anchorWithStickyNavbar_LWe7" id="6️⃣-multi-class-classification">6️⃣ <strong>Multi-class classification</strong><a href="#6️⃣-multi-class-classification" class="hash-link" aria-label="Direct link to 6️⃣-multi-class-classification" title="Direct link to 6️⃣-multi-class-classification">​</a></h2>
<div class="theme-admonition theme-admonition-info admonition_xJq3 alert alert--info"><div class="admonitionHeading_Gvgb"><span class="admonitionIcon_Rf37"><svg viewBox="0 0 14 16"><path fill-rule="evenodd" d="M7 2.3c3.14 0 5.7 2.56 5.7 5.7s-2.56 5.7-5.7 5.7A5.71 5.71 0 0 1 1.3 8c0-3.14 2.56-5.7 5.7-5.7zM7 1C3.14 1 0 4.14 0 8s3.14 7 7 7 7-3.14 7-7-3.14-7-7-7zm1 3H6v5h2V4zm0 6H6v2h2v-2z"></path></svg></span>Definition</div><div class="admonitionContent_BuS1"><p>Multi-class classification is a machine learning task where the goal is to categorize examples into one of three or more classes.</p></div></div>
<p>It can be treated as an <strong>extension</strong> of binary classification to more than two classes. If each example can only be assigned to one class, then the classification problem can be handled as a binary classification problem, where one class contains one of the multiple classes, and the other class contains all the other classes put together. The process can then be repeated for each of the original classes.</p>
<div class="theme-admonition theme-admonition-tip admonition_xJq3 alert alert--success"><div class="admonitionHeading_Gvgb"><span class="admonitionIcon_Rf37"><svg viewBox="0 0 12 16"><path fill-rule="evenodd" d="M6.5 0C3.48 0 1 2.19 1 5c0 .92.55 2.25 1 3 1.34 2.25 1.78 2.78 2 4v1h5v-1c.22-1.22.66-1.75 2-4 .45-.75 1-2.08 1-3 0-2.81-2.48-5-5.5-5zm3.64 7.48c-.25.44-.47.8-.67 1.11-.86 1.41-1.25 2.06-1.45 3.23-.02.05-.02.11-.02.17H5c0-.06 0-.13-.02-.17-.2-1.17-.59-1.83-1.45-3.23-.2-.31-.42-.67-.67-1.11C2.44 6.78 2 5.65 2 5c0-2.2 2.02-4 4.5-4 1.22 0 2.36.42 3.22 1.19C10.55 2.94 11 3.94 11 5c0 .66-.44 1.78-.86 2.48zM4 14h5c-.23 1.14-1.3 2-2.5 2s-2.27-.86-2.5-2z"></path></svg></span>Digit Recognition</div><div class="admonitionContent_BuS1"><p>A classic example of multi-class classification is handwritten digit recognition:</p><ul>
<li>Input: Image of a handwritten digit</li>
<li>Output: Classification into one of 10 classes (digits 0-9)</li>
<li>Each image belongs to exactly one class</li>
<li>Models must learn features that distinguish between all ten digits</li>
</ul></div></div>
<p><em>Note: we will explore this topic in more depth in future modules.</em></p>
<h2 class="anchor anchorWithStickyNavbar_LWe7" id="-coding-time">💻 <strong>Coding Time!</strong><a href="#-coding-time" class="hash-link" aria-label="Direct link to -coding-time" title="Direct link to -coding-time">​</a></h2>
<p>Here&#x27;s the link to the interactive <a href="https://colab.research.google.com/github/google/eng-edu/blob/main/ml/cc/exercises/binary_classification_rice.ipynb" target="_blank" rel="noopener noreferrer">Google Colab notebook</a>.</p>
<p>We just report here the most important insights.</p>
<h3 class="anchor anchorWithStickyNavbar_LWe7" id="logistic-regression-in-keras">Logistic Regression in Keras<a href="#logistic-regression-in-keras" class="hash-link" aria-label="Direct link to Logistic Regression in Keras" title="Direct link to Logistic Regression in Keras">​</a></h3>
<div class="language-python codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-python codeBlock_bY9V thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token keyword" style="color:#00009f">import</span><span class="token plain"> tensorflow </span><span class="token keyword" style="color:#00009f">as</span><span class="token plain"> tf</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token keyword" style="color:#00009f">from</span><span class="token plain"> tensorflow </span><span class="token keyword" style="color:#00009f">import</span><span class="token plain"> keras</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token keyword" style="color:#00009f">def</span><span class="token plain"> </span><span class="token function" style="color:#d73a49">create_logistic_regression_model</span><span class="token punctuation" style="color:#393A34">(</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    input_features</span><span class="token punctuation" style="color:#393A34">:</span><span class="token plain"> </span><span class="token builtin">list</span><span class="token punctuation" style="color:#393A34">[</span><span class="token builtin">str</span><span class="token punctuation" style="color:#393A34">]</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    learning_rate</span><span class="token punctuation" style="color:#393A34">:</span><span class="token plain"> </span><span class="token builtin">float</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    metrics</span><span class="token punctuation" style="color:#393A34">:</span><span class="token plain"> </span><span class="token builtin">list</span><span class="token punctuation" style="color:#393A34">[</span><span class="token plain">keras</span><span class="token punctuation" style="color:#393A34">.</span><span class="token plain">metrics</span><span class="token punctuation" style="color:#393A34">.</span><span class="token plain">Metric</span><span class="token punctuation" style="color:#393A34">]</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token punctuation" style="color:#393A34">)</span><span class="token plain"> </span><span class="token operator" style="color:#393A34">-</span><span class="token operator" style="color:#393A34">&gt;</span><span class="token plain"> keras</span><span class="token punctuation" style="color:#393A34">.</span><span class="token plain">Model</span><span class="token punctuation" style="color:#393A34">:</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    </span><span class="token triple-quoted-string string" style="color:#e3116c">&quot;&quot;&quot;</span><br></span><span class="token-line" style="color:#393A34"><span class="token triple-quoted-string string" style="color:#e3116c">    Creates and compiles a simple single-layer neural network for binary </span><br></span><span class="token-line" style="color:#393A34"><span class="token triple-quoted-string string" style="color:#e3116c">    classification, equivalent to logistic regression.</span><br></span><span class="token-line" style="color:#393A34"><span class="token triple-quoted-string string" style="display:inline-block;color:#e3116c"></span><br></span><span class="token-line" style="color:#393A34"><span class="token triple-quoted-string string" style="color:#e3116c">    Args:</span><br></span><span class="token-line" style="color:#393A34"><span class="token triple-quoted-string string" style="color:#e3116c">        input_features (list[str]): A list of feature names. Each feature</span><br></span><span class="token-line" style="color:#393A34"><span class="token triple-quoted-string string" style="color:#e3116c">            corresponds to one scalar input.</span><br></span><span class="token-line" style="color:#393A34"><span class="token triple-quoted-string string" style="color:#e3116c">        learning_rate (float): Learning rate for the optimizer.</span><br></span><span class="token-line" style="color:#393A34"><span class="token triple-quoted-string string" style="color:#e3116c">        metrics (list[keras.metrics.Metric]): List of metric instances to track.</span><br></span><span class="token-line" style="color:#393A34"><span class="token triple-quoted-string string" style="display:inline-block;color:#e3116c"></span><br></span><span class="token-line" style="color:#393A34"><span class="token triple-quoted-string string" style="color:#e3116c">    Returns:</span><br></span><span class="token-line" style="color:#393A34"><span class="token triple-quoted-string string" style="color:#e3116c">        keras.Model: A compiled Keras model representing logistic regression.</span><br></span><span class="token-line" style="color:#393A34"><span class="token triple-quoted-string string" style="color:#e3116c">    &quot;&quot;&quot;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    </span><span class="token comment" style="color:#999988;font-style:italic"># --------------------------------------------------------------------------</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    </span><span class="token comment" style="color:#999988;font-style:italic"># 1. Define the Inputs</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    </span><span class="token comment" style="color:#999988;font-style:italic"># Here, we create one Keras Input for each feature. Each input is a scalar </span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    </span><span class="token comment" style="color:#999988;font-style:italic"># (shape=(1,)) because logistic regression expects numeric features that </span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    </span><span class="token comment" style="color:#999988;font-style:italic"># can be fed into a linear combination.</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    </span><span class="token comment" style="color:#999988;font-style:italic"># --------------------------------------------------------------------------</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    model_inputs </span><span class="token operator" style="color:#393A34">=</span><span class="token plain"> </span><span class="token punctuation" style="color:#393A34">[</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        keras</span><span class="token punctuation" style="color:#393A34">.</span><span class="token plain">Input</span><span class="token punctuation" style="color:#393A34">(</span><span class="token plain">name</span><span class="token operator" style="color:#393A34">=</span><span class="token plain">feature</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"> shape</span><span class="token operator" style="color:#393A34">=</span><span class="token punctuation" style="color:#393A34">(</span><span class="token number" style="color:#36acaa">1</span><span class="token punctuation" style="color:#393A34">,</span><span class="token punctuation" style="color:#393A34">)</span><span class="token punctuation" style="color:#393A34">)</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        </span><span class="token keyword" style="color:#00009f">for</span><span class="token plain"> feature </span><span class="token keyword" style="color:#00009f">in</span><span class="token plain"> input_features</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    </span><span class="token punctuation" style="color:#393A34">]</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    </span><span class="token comment" style="color:#999988;font-style:italic"># --------------------------------------------------------------------------</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    </span><span class="token comment" style="color:#999988;font-style:italic"># 2. Concatenate the Inputs</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    </span><span class="token comment" style="color:#999988;font-style:italic"># We merge all separate input tensors into a single tensor using the </span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    </span><span class="token comment" style="color:#999988;font-style:italic"># Concatenate layer. This single tensor will be fed into our Dense layer </span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    </span><span class="token comment" style="color:#999988;font-style:italic"># (the logistic regression layer).</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    </span><span class="token comment" style="color:#999988;font-style:italic"># --------------------------------------------------------------------------</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    concatenated_inputs </span><span class="token operator" style="color:#393A34">=</span><span class="token plain"> keras</span><span class="token punctuation" style="color:#393A34">.</span><span class="token plain">layers</span><span class="token punctuation" style="color:#393A34">.</span><span class="token plain">Concatenate</span><span class="token punctuation" style="color:#393A34">(</span><span class="token punctuation" style="color:#393A34">)</span><span class="token punctuation" style="color:#393A34">(</span><span class="token plain">model_inputs</span><span class="token punctuation" style="color:#393A34">)</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    </span><span class="token comment" style="color:#999988;font-style:italic"># --------------------------------------------------------------------------</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    </span><span class="token comment" style="color:#999988;font-style:italic"># 3. Single Dense Layer with Sigmoid Activation</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    </span><span class="token comment" style="color:#999988;font-style:italic"># A logistic regression model can be viewed as:</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    </span><span class="token comment" style="color:#999988;font-style:italic">#   y = sigmoid(W^T x + b)</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    </span><span class="token comment" style="color:#999988;font-style:italic"># where x is the input (in this case, the concatenated features), and</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    </span><span class="token comment" style="color:#999988;font-style:italic"># W and b are learnable parameters.</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    </span><span class="token comment" style="color:#999988;font-style:italic"># </span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    </span><span class="token comment" style="color:#999988;font-style:italic"># In Keras:</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    </span><span class="token comment" style="color:#999988;font-style:italic">#   - units=1: we only need a single output value (the probability of </span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    </span><span class="token comment" style="color:#999988;font-style:italic">#     belonging to the positive class).</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    </span><span class="token comment" style="color:#999988;font-style:italic">#   - activation=&#x27;sigmoid&#x27;: applies the logistic function, transforming </span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    </span><span class="token comment" style="color:#999988;font-style:italic">#     the linear combination into a probability between 0 and 1.</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    </span><span class="token comment" style="color:#999988;font-style:italic"># --------------------------------------------------------------------------</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    model_output </span><span class="token operator" style="color:#393A34">=</span><span class="token plain"> keras</span><span class="token punctuation" style="color:#393A34">.</span><span class="token plain">layers</span><span class="token punctuation" style="color:#393A34">.</span><span class="token plain">Dense</span><span class="token punctuation" style="color:#393A34">(</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        units</span><span class="token operator" style="color:#393A34">=</span><span class="token number" style="color:#36acaa">1</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        activation</span><span class="token operator" style="color:#393A34">=</span><span class="token string" style="color:#e3116c">&#x27;sigmoid&#x27;</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain">  </span><span class="token comment" style="color:#999988;font-style:italic"># logistic activation</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        name</span><span class="token operator" style="color:#393A34">=</span><span class="token string" style="color:#e3116c">&#x27;logistic_regression_output&#x27;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    </span><span class="token punctuation" style="color:#393A34">)</span><span class="token punctuation" style="color:#393A34">(</span><span class="token plain">concatenated_inputs</span><span class="token punctuation" style="color:#393A34">)</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    </span><span class="token comment" style="color:#999988;font-style:italic"># --------------------------------------------------------------------------</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    </span><span class="token comment" style="color:#999988;font-style:italic"># 4. Create the Keras Model</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    </span><span class="token comment" style="color:#999988;font-style:italic"># We define a Keras Model by specifying the inputs and the output. </span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    </span><span class="token comment" style="color:#999988;font-style:italic"># --------------------------------------------------------------------------</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    model </span><span class="token operator" style="color:#393A34">=</span><span class="token plain"> keras</span><span class="token punctuation" style="color:#393A34">.</span><span class="token plain">Model</span><span class="token punctuation" style="color:#393A34">(</span><span class="token plain">inputs</span><span class="token operator" style="color:#393A34">=</span><span class="token plain">model_inputs</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"> outputs</span><span class="token operator" style="color:#393A34">=</span><span class="token plain">model_output</span><span class="token punctuation" style="color:#393A34">)</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    </span><span class="token comment" style="color:#999988;font-style:italic"># --------------------------------------------------------------------------</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    </span><span class="token comment" style="color:#999988;font-style:italic"># 5. Compile the Model</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    </span><span class="token comment" style="color:#999988;font-style:italic"># - We use BinaryCrossentropy as the loss function for binary classification.</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    </span><span class="token comment" style="color:#999988;font-style:italic"># - RMSprop is the chosen optimizer here, although many optimizers </span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    </span><span class="token comment" style="color:#999988;font-style:italic">#   (e.g. Adam, SGD) could also be used.</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    </span><span class="token comment" style="color:#999988;font-style:italic"># - We pass in any additional metrics we want to track.</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    </span><span class="token comment" style="color:#999988;font-style:italic"># --------------------------------------------------------------------------</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    model</span><span class="token punctuation" style="color:#393A34">.</span><span class="token builtin">compile</span><span class="token punctuation" style="color:#393A34">(</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        optimizer</span><span class="token operator" style="color:#393A34">=</span><span class="token plain">keras</span><span class="token punctuation" style="color:#393A34">.</span><span class="token plain">optimizers</span><span class="token punctuation" style="color:#393A34">.</span><span class="token plain">RMSprop</span><span class="token punctuation" style="color:#393A34">(</span><span class="token plain">learning_rate</span><span class="token punctuation" style="color:#393A34">)</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        loss</span><span class="token operator" style="color:#393A34">=</span><span class="token plain">keras</span><span class="token punctuation" style="color:#393A34">.</span><span class="token plain">losses</span><span class="token punctuation" style="color:#393A34">.</span><span class="token plain">BinaryCrossentropy</span><span class="token punctuation" style="color:#393A34">(</span><span class="token punctuation" style="color:#393A34">)</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        metrics</span><span class="token operator" style="color:#393A34">=</span><span class="token plain">metrics</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    </span><span class="token punctuation" style="color:#393A34">)</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    </span><span class="token keyword" style="color:#00009f">return</span><span class="token plain"> model</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="Copy code to clipboard" title="Copy" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_y97N"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_LjdS"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div></div></article><nav class="pagination-nav docusaurus-mt-lg" aria-label="Docs pages"><a class="pagination-nav__link pagination-nav__link--prev" href="/MindMash/docs/notes/Information Technology/Artificial Intelligence/👨🏻‍🏫 Google - 02 - ML/google-2-unit-2"><div class="pagination-nav__sublabel">Previous</div><div class="pagination-nav__label">📖 Logistic Regression</div></a><a class="pagination-nav__link pagination-nav__link--next" href="/MindMash/docs/notes/Information Technology/Artificial Intelligence/👨🏻‍🏫 Google - 02 - ML/google-2-unit-4"><div class="pagination-nav__sublabel">Next</div><div class="pagination-nav__label">📖 Numerical Data</div></a></nav></div></div><div class="col col--3"><div class="tableOfContents_bqdL thin-scrollbar theme-doc-toc-desktop"><ul class="table-of-contents table-of-contents__left-border"><li><a href="#️-useful-materials" class="table-of-contents__link toc-highlight">➡️ <strong>Useful Materials</strong></a><ul><li><a href="#original-source" class="table-of-contents__link toc-highlight">Original Source</a></li></ul></li><li><a href="#1️⃣-introduction" class="table-of-contents__link toc-highlight">1️⃣ <strong>Introduction</strong></a></li><li><a href="#2️⃣-thresholds-and-the-confusion-matrix" class="table-of-contents__link toc-highlight">2️⃣ <strong>Thresholds and the Confusion Matrix</strong></a><ul><li><a href="#confusion-matrix" class="table-of-contents__link toc-highlight">Confusion Matrix</a></li></ul></li><li><a href="#3️⃣-accuracy-recall-precision-and-related-metrics" class="table-of-contents__link toc-highlight">3️⃣ <strong>Accuracy, recall, precision, and related metrics</strong></a><ul><li><a href="#accuracy" class="table-of-contents__link toc-highlight">Accuracy</a></li><li><a href="#recall-true-positive-rate" class="table-of-contents__link toc-highlight">Recall (True Positive Rate)</a></li><li><a href="#false-positive-rate" class="table-of-contents__link toc-highlight">False Positive Rate</a></li><li><a href="#precision" class="table-of-contents__link toc-highlight">Precision</a></li><li><a href="#trade-offs-and-threshold-tuning" class="table-of-contents__link toc-highlight">Trade-offs and Threshold Tuning</a></li><li><a href="#f1-score-balancing-precision-and-recall" class="table-of-contents__link toc-highlight">F1-Score: Balancing Precision and Recall</a></li></ul></li><li><a href="#4️⃣-roc-and-auc" class="table-of-contents__link toc-highlight">4️⃣ <strong>ROC and AUC</strong></a><ul><li><a href="#receiver-operating-characteristic-curve-roc" class="table-of-contents__link toc-highlight">Receiver-operating characteristic curve (ROC)</a></li><li><a href="#area-under-the-curve-auc" class="table-of-contents__link toc-highlight">Area under the curve (AUC)</a></li><li><a href="#auc-and-roc-for-choosing-model-and-threshold" class="table-of-contents__link toc-highlight">AUC and ROC for choosing model and threshold</a></li></ul></li><li><a href="#5️⃣-prediction-bias" class="table-of-contents__link toc-highlight">5️⃣ <strong>Prediction bias</strong></a><ul><li><a href="#introduction" class="table-of-contents__link toc-highlight">Introduction</a></li><li><a href="#significance-of-prediction-bias" class="table-of-contents__link toc-highlight">Significance of Prediction Bias</a></li><li><a href="#common-causes-of-prediction-bias" class="table-of-contents__link toc-highlight">Common Causes of Prediction Bias</a></li></ul></li><li><a href="#6️⃣-multi-class-classification" class="table-of-contents__link toc-highlight">6️⃣ <strong>Multi-class classification</strong></a></li><li><a href="#-coding-time" class="table-of-contents__link toc-highlight">💻 <strong>Coding Time!</strong></a><ul><li><a href="#logistic-regression-in-keras" class="table-of-contents__link toc-highlight">Logistic Regression in Keras</a></li></ul></li></ul></div></div></div></div></main></div></div></div><footer class="footer footer--dark"><div class="container container-fluid"><div class="row footer__links"><div class="col footer__col"><div class="footer__title">My Links</div><ul class="footer__items clean-list"><li class="footer__item"><a href="https://danielepassabi.github.io/" target="_blank" rel="noopener noreferrer" class="footer__link-item">My Portfolio<svg width="13.5" height="13.5" aria-hidden="true" viewBox="0 0 24 24" class="iconExternalLink_nPIU"><path fill="currentColor" d="M21 13v10h-21v-19h12v2h-10v15h17v-8h2zm3-12h-10.988l4.035 4-6.977 7.07 2.828 2.828 6.977-7.07 4.125 4.172v-11z"></path></svg></a></li><li class="footer__item"><a href="https://www.linkedin.com/in/daniele-passabi/" target="_blank" rel="noopener noreferrer" class="footer__link-item">LinkedIn<svg width="13.5" height="13.5" aria-hidden="true" viewBox="0 0 24 24" class="iconExternalLink_nPIU"><path fill="currentColor" d="M21 13v10h-21v-19h12v2h-10v15h17v-8h2zm3-12h-10.988l4.035 4-6.977 7.07 2.828 2.828 6.977-7.07 4.125 4.172v-11z"></path></svg></a></li></ul></div></div><div class="footer__bottom text--center"><div class="footer__copyright">(I do not really need a) Copyright © 2025 MindMash, Inc. Built with Docusaurus.</div></div></div></footer></div>
</body>
</html>